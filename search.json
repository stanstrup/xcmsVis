[{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"project-overview","dir":"","previous_headings":"","what":"Project Overview","title":"CLAUDE.md","text":"R package project named xcmsVis, parallel package XCMS provides ggplot2 implementations XCMS plotting functions modern, interactive visualizations.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"project-task-management","dir":"","previous_headings":"","what":"Project Task Management","title":"CLAUDE.md","text":"IMPORTANT: project uses structured task management system minimize token usage: instructions.md: Contains current/active tasks. Keep file lightweight possible. completed_tasks.md: Archive completed tasks detailed documentation. future_tasks.md: Long-term development roadmap planned features. working tasks: 1. Check instructions.md current work 2. Move completed tasks completed_tasks.md details 3. Keep instructions.md minimal reduce token consumption 4. Reference files context rather duplicating information","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"package-setup-and-building","dir":"","previous_headings":"R Package Development Commands","what":"Package Setup and Building","title":"CLAUDE.md","text":"","code":"# Install development dependencies install.packages(c(\"devtools\", \"roxygen2\", \"testthat\", \"usethis\"))  # Build package documentation from roxygen comments devtools::document()  # Install the package locally devtools::install()  # Build package bundle devtools::build()  # Check package (runs R CMD check) devtools::check()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"testing","dir":"","previous_headings":"R Package Development Commands","what":"Testing","title":"CLAUDE.md","text":"IMPORTANT: working specific functions, ALWAYS use testthat::test_file() run relevant test file. Running tests devtools::test() takes much longer necessary.","code":"# Run all tests (can be slow) devtools::test()  # Run a specific test file (PREFERRED - faster for development) testthat::test_file(\"tests/testthat/test-filename.R\")  # Run tests with coverage covr::package_coverage()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"development-workflow","dir":"","previous_headings":"R Package Development Commands","what":"Development Workflow","title":"CLAUDE.md","text":"","code":"# Load package for interactive development devtools::load_all()  # Create new function/data documentation usethis::use_r(\"function_name\")  # Add test file usethis::use_test(\"function_name\")  # Add package dependency usethis::use_package(\"package_name\")"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"r-package-structure","dir":"","previous_headings":"","what":"R Package Structure","title":"CLAUDE.md","text":"creating R package files, follow structure: DESCRIPTION - Package metadata dependencies NAMESPACE - Package namespace (auto-generated roxygen2) R/ - R source code files man/ - Documentation files (auto-generated roxygen2) tests/testthat/ - Unit tests vignettes/ - Long-form documentation data/ - Package datasets inst/ - Additional files installed dev-docs/ - Research documentation implementation guides (part package, ignored R CMD build)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"code-style","dir":"","previous_headings":"","what":"Code Style","title":"CLAUDE.md","text":"project follows standard R package conventions: - Use 2 spaces indentation (configured .Rproj file) - Strip trailing whitespace (configured .Rproj file) - Auto-append newline files (configured .Rproj file) - Use UTF-8 encoding","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"testing-requirements","dir":"","previous_headings":"","what":"Testing Requirements","title":"CLAUDE.md","text":"IMPORTANT: functions MUST comprehensive tests: - Test compatibility XCMSnExp XcmsExperiment objects - Even examples/vignettes focus XcmsExperiment, tests must verify XCMSnExp works - Write tests tests/testthat/test-*.R files - Use testthat::test_file() run individual test files - Ensure major code paths covered","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"bioconductor-parallel-processing","dir":"","previous_headings":"","what":"Bioconductor Parallel Processing","title":"CLAUDE.md","text":"IMPORTANT: Always use SerialParam() example code tests: SerialParam? - Faster small datasets: Avoids parallel processing overhead - Eliminates warnings: Prevents ‚Äú‚Äòpackage:stats‚Äô may available‚Äù warnings - Cleaner output: parallel-related messages - Better reproducibility: Consistent behavior across systems use SerialParam: - test files (tests/testthat/) - vignettes examples - code small sample sizes (< 20 samples typically) functions support BPPARAM: - ‚úÖ readMsExperiment() - supports BPPARAM - ‚úÖ findChromPeaks() - supports BPPARAM - ‚ùå groupChromPeaks() - support BPPARAM - ‚ùå adjustRtime() - support BPPARAM Note: Users can still use parallel processing production omitting BPPARAM setting parallel backend.","code":"library(BiocParallel)  # Always include BPPARAM = SerialParam() for functions that support it: xdata <- readMsExperiment(spectraFiles = files, BPPARAM = SerialParam()) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Note: groupChromPeaks does NOT have BPPARAM parameter xdata <- groupChromPeaks(xdata, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"adding-new-functions","dir":"","previous_headings":"","what":"Adding New Functions","title":"CLAUDE.md","text":"implementing new XCMS plotting functions: Identify XCMS plotting function implement Locate source code XCMS GitHub: https://github.com/sneumann/xcms Study function‚Äôs purpose, parameters, output Implement ggplot2 version R/gplot*.R - FOLLOW XCMS CODE CLOSELY POSSIBLE Add roxygen2 documentation Update NAMESPACE needed Add tests tests/testthat/test-*.R (REQUIRED - test object types) Add examples vignette (focus XcmsExperiment) Update NEWS.md Run devtools::check() Move task instructions.md completed_tasks.md done","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"critical-faithful-implementation-of-xcms-functions","dir":"","previous_headings":"","what":"CRITICAL: Faithful Implementation of XCMS Functions","title":"CLAUDE.md","text":"IMPORTANT: implementing ggplot2 versions XCMS functions, follow original XCMS implementation closely possible avoid subtle bugs behavioral differences.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"why-this-matters","dir":"","previous_headings":"CRITICAL: Faithful Implementation of XCMS Functions","what":"Why This Matters","title":"CLAUDE.md","text":"XCMS codebase refined many years contains important edge case handling may obvious: - Proper handling NA values chromatographic data - Correct polygon rendering data gaps - Edge cases peak detection visualization - Proper coordinate transformations","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"implementation-guidelines","dir":"","previous_headings":"CRITICAL: Faithful Implementation of XCMS Functions","what":"Implementation Guidelines","title":"CLAUDE.md","text":"Study XCMS source code thoroughly implementing: Read entire function, just main logic Identify edge case handling Note data transformations performed Look helper functions handle special cases ALWAYS reuse XCMS internal functions possible: : Call XCMS internal functions directly using xcms:::functionName() : Reuse XCMS‚Äôs data processing, mathematical, algorithmic functions DON‚ÄôT: Reimplement functions already exist XCMS write functions XCMS code separated base R plotting functionality need replace ensures perfect compatibility avoids subtle implementation bugs xcms:::descendMin() - density local minima finding mathematical statistical functions Data transformation filtering functions Peak grouping detection algorithms Base R plotting calls (plot(), points(), rect()) ‚Üí replace ggplot2 Plot layout styling ‚Üí replace ggplot2/patchwork Visual elements specific base R graphics Mirror XCMS logic structure ggplot2 implementation: Use similar variable names possible Follow sequence operations Preserve data filtering validation logic Keep coordinate transformations Pay special attention : NA value handling (filtering, propagation) Data gaps breaks visualizations Polygon/geometry rendering edge cases Coordinate system transformations Default parameter values Example: stacked plotChromatogramsOverlay() PROPORTION (0-1), absolute value stacked = 1, y-axis split 50/50 stacking region intensity region XCMS documentation authoritative - don‚Äôt guess parameter behavior Example: Reusing XCMS internal functions Example: Polygon rendering NA breaks doubt: Check XCMS source code Look XCMS internal functions can reuse writing Test edge cases (NA values, empty data, single points) Compare output visually original XCMS function","code":"# BAD - Reimplementing a function that exists in XCMS: .descendMin <- function(y, istart = which.max(y)) {   # ... custom implementation that may have subtle bugs }  # GOOD - Using XCMS's internal function directly: feat_range <- xcms:::descendMin(dens_y_copy, max_y)  # This ensures perfect compatibility and avoids reimplementation bugs # XCMS approach (CORRECT): nona <- !is.na(ys)  # Filter NA values if (length(xs_all)) {     xs_all <- c(xs_all, NA)  # Insert NA to break polygon     ys_all <- c(ys_all, NA) } xs_all <- c(xs_all, xs[nona]) ys_all <- c(ys_all, ys[nona])  # Don't simplify without understanding why XCMS does it this way!"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"testing-requirements-1","dir":"","previous_headings":"CRITICAL: Faithful Implementation of XCMS Functions","what":"Testing Requirements","title":"CLAUDE.md","text":"Test data NA values Test data gaps Test single-point chromatograms Test empty/zero-length data Compare visual output XCMS possible","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"finding-xcms-source-code","dir":"","previous_headings":"","what":"Finding XCMS Source Code","title":"CLAUDE.md","text":"need find source code XCMS function implement: Use branch reference format (preferred): always gets latest code branch: Example: https://raw.githubusercontent.com/sneumann/xcms/refs/heads/devel/R/methods-group-features.R automatically uses latest code devel branch Alternative - Use specific commit hash (reproducibility): Example: https://raw.githubusercontent.com/sneumann/xcms/e2f76c8512bd0244f9524c075fe240138335f3e4/R/methods-group-features.R Use need specific version Common XCMS source files: methods-group-features.R - Feature grouping methods (plotFeatureGroups) functions-XCMSnExp.R - XCMSnExp-specific functions methods-XCMSnExp.R - XCMSnExp S4 methods functions-Chromatogram.R - Chromatogram plotting functions functions-xcmsSet.R - Legacy xcmsSet functions Use WebFetch Task tool: URL, use WebFetch retrieve source code","code":"https://raw.githubusercontent.com/sneumann/xcms/refs/heads/devel/R/FILENAME.R https://raw.githubusercontent.com/sneumann/xcms/COMMIT_HASH/R/FILENAME.R"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"key-resources","dir":"","previous_headings":"","what":"Key Resources","title":"CLAUDE.md","text":"XCMS Repository: https://github.com/sneumann/xcms XCMS Source Code: https://github.com/sneumann/xcms/tree/devel/R Metabonaut Tutorials: https://github.com/rformassspectrometry/Metabonaut Original Discussion: https://github.com/sneumann/xcms/issues/551 Package Structure Reference: /mnt/c/Users/tmh331/Desktop/gits/remoteUpdater Function Reference: /mnt/c/Users/tmh331/Desktop/gits/_Introduction Nutritional Metabolomics/inm-booklet/scripts/funs.R S4 Implementation Guide: dev-docs/ - Comprehensive guides implementing S4 methods like XCMS","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"important-conventions","dir":"","previous_headings":"","what":"Important Conventions","title":"CLAUDE.md","text":"Follow XCMS conventions object types methods Maintain compatibility XCMSnExp xcmsExperiment objects Use consistent naming: gplot* prefix plotting functions Include tooltip text plotly compatibility Write comprehensive roxygen2 documentation Add examples (even marked \\dontrun) tasks completed, move completed_tasks.md","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"s4-method-implementation-pattern","dir":"","previous_headings":"","what":"S4 Method Implementation Pattern","title":"CLAUDE.md","text":"IMPORTANT: implementing functions support XCMSnExp XcmsExperiment:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"do-use-shared-implementation-pattern","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"DO: Use Shared Implementation Pattern","title":"CLAUDE.md","text":"","code":"# Internal implementation function (single source of truth) .gplot_function_impl <- function(object, ...) {   .validate_xcms_object(object)    # Use helper functions that handle both object types   sample_data <- .get_sample_data(object)   spectra_data <- .get_spectra_data(object)    # All plotting logic here   # ... }  # Thin S4 method wrappers (just dispatch) setMethod(\"gplot_function\", \"XCMSnExp\",           function(object, ...) {             .gplot_function_impl(object, ...)           })  setMethod(\"gplot_function\", \"XcmsExperiment\",           function(object, ...) {             .gplot_function_impl(object, ...)           })"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"dont-duplicate-code-in-methods","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"DON‚ÄôT: Duplicate Code in Methods","title":"CLAUDE.md","text":"‚ùå BAD - Duplicating identical code methods:","code":"setMethod(\"gplot_function\", \"XCMSnExp\", function(...) {   # 100+ lines of code })  setMethod(\"gplot_function\", \"XcmsExperiment\", function(...) {   # Same 100+ lines of code (maintenance nightmare!) })"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"helper-functions","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"Helper Functions","title":"CLAUDE.md","text":"Use internal helpers already handle object type differences: - .validate_xcms_object(object) - Validates object type - .get_sample_data(object) - Extracts sample metadata - .get_spectra_data(object) - Extracts spectra/feature data helpers use S4 dispatch internally, implementation function doesn‚Äôt need know object types.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"git-workflow","dir":"","previous_headings":"","what":"Git Workflow","title":"CLAUDE.md","text":"Default branch: main feat: - New feature (triggers minor version bump) fix: - Bug fix (triggers patch version bump) docs: - Documentation changes style: - Code style changes (formatting, etc.) refactor: - Code refactoring test: - Adding updating tests chore: - Maintenance tasks Example: feat: add gplotEIC function extracted ion chromatograms Run R CMD check push/PR Deploy pkgdown site push main Create releases via semantic-release based commit messages Always commit co-authorship footer using Claude Code","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"pre-commit-checklist","dir":"","previous_headings":"","what":"Pre-Commit Checklist","title":"CLAUDE.md","text":"IMPORTANT: committing changes, ALWAYS run checks order:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_0-update-description-if-needed","dir":"","previous_headings":"Pre-Commit Checklist","what":"0. Update DESCRIPTION (if needed)","title":"CLAUDE.md","text":"modifying functions, check DESCRIPTION needs updates: - Add new package dependencies Imports: using new packages - Update Suggests: optional dependencies (testing, vignettes) - Ensure imported packages listed","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_1-regenerate-documentation","dir":"","previous_headings":"Pre-Commit Checklist","what":"1. Regenerate Documentation","title":"CLAUDE.md","text":"ensures function documentation imports date.","code":"# Update NAMESPACE and .Rd files from roxygen2 comments roxygen2::roxygenize()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_2-r-cmd-check","dir":"","previous_headings":"Pre-Commit Checklist","what":"2. R CMD Check","title":"CLAUDE.md","text":"Fix errors warnings committing. Address notes relevant.","code":"# Check package for errors, warnings, and notes devtools::check()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_3-build-pkgdown-site","dir":"","previous_headings":"Pre-Commit Checklist","what":"3. Build pkgdown Site","title":"CLAUDE.md","text":"Check : - errors site build - vignettes render correctly - function documentation displays properly - broken links missing references commit three checks pass successfully.","code":"# Load all package code devtools::load_all()  # Build pkgdown site locally pkgdown::build_site()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_4-reinstall-package","dir":"","previous_headings":"Pre-Commit Checklist","what":"4. Reinstall Package","title":"CLAUDE.md","text":"ensures package fully functional changes.","code":"# Reinstall the package to ensure all changes are properly loaded devtools::install()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_5-commit-changes","dir":"","previous_headings":"Pre-Commit Checklist","what":"5. Commit Changes","title":"CLAUDE.md","text":"checks pass, commit changes using semantic-release format: - Use conventional commit messages (feat:, fix:, docs:, etc.) - Always include co-authorship footer using Claude Code - Example:","code":"git add -A git commit -m \"feat: add new visualization function  ü§ñ Generated with [Claude Code](https://claude.com/claude-code)  Co-Authored-By: Claude <noreply@anthropic.com>\""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"pre-push-checklist","dir":"","previous_headings":"","what":"Pre-Push Checklist","title":"CLAUDE.md","text":"committing, verify everything working pushing GitHub: - Ensure devtools::check() passes errors/warnings - Ensure pkgdown::build_site() completes without errors - Review git status ensure unintended files included","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"task-management","dir":"","previous_headings":"","what":"Task Management","title":"CLAUDE.md","text":"IMPORTANT: start working new tasks instructions.md unless explicitly told user. Wait user give go-ahead proceeding tasks. CRITICAL: Make commits frequently completing task logical unit work: - Commit completed task instructions.md - Don‚Äôt batch multiple tasks one commit - Use semantic commit format commit (feat:, fix:, docs:, etc.) - provides better granularity makes easier track changes - Example workflow: 1. Complete task 1 ‚Üí commit 2. Complete task 2 ‚Üí commit 3. Complete task 3 ‚Üí commit etc.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":null,"dir":"","previous_headings":"","what":"xcmsVis Project Status","title":"xcmsVis Project Status","text":"Last Updated: 2025-11-08","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"quick-summary","dir":"","previous_headings":"","what":"Quick Summary","title":"xcmsVis Project Status","text":"xcmsVis provides ggplot2-based implementations XCMS plotting functions support legacy (XCMSnExp) modern (XcmsExperiment) objects.","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"not-implementing---legacy-objects","dir":"","previous_headings":"Not Yet Implemented (Candidates for Implementation)","what":"Not Implementing - Legacy Objects","title":"xcmsVis Project Status","text":"15 functions xcmsRaw/xcmsSet objects (plotQC, plotrt, plotTIC, plotRaw, plotEIC, plotChrom, plotScan, plotSpec, plotPeaks, plotSurf, image, levelplot, plot.xcmsEIC, plotTree, plotMsData) - focus modern XCMS workflow","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"file-structure","dir":"","previous_headings":"","what":"File Structure","title":"xcmsVis Project Status","text":"","code":"xcmsVis/ ‚îú‚îÄ‚îÄ R/ ‚îÇ   ‚îú‚îÄ‚îÄ AllGenerics.R                      # All generic declarations ‚îÇ   ‚îú‚îÄ‚îÄ gplotAdjustedRtime-methods.R      # 9 method files ‚îÇ   ‚îú‚îÄ‚îÄ gplotChromPeaks-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplotChromPeakImage-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplotChromPeakDensity-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplotChromatogramsOverlay-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplotFeatureGroups-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplot-methods.R ‚îÇ   ‚îú‚îÄ‚îÄ gplot-XcmsExperiment-methods.R ‚îÇ   ‚îî‚îÄ‚îÄ ghighlightChromPeaks-methods.R ‚îÇ ‚îú‚îÄ‚îÄ man/                                   # Auto-generated docs (9 files) ‚îú‚îÄ‚îÄ tests/testthat/ ‚îÇ   ‚îú‚îÄ‚îÄ setup-biocparallel.R              # Test infrastructure ‚îÇ   ‚îî‚îÄ‚îÄ test-*.R                          # 9 test files ‚îÇ ‚îú‚îÄ‚îÄ vignettes/                             # 5 vignettes ‚îú‚îÄ‚îÄ dev-docs/ ‚îÇ   ‚îú‚îÄ‚îÄ XCMS_REFERENCE.md                 # Consolidated XCMS reference ‚îÇ   ‚îú‚îÄ‚îÄ S4_GUIDE.md                       # Consolidated S4 guide ‚îÇ   ‚îî‚îÄ‚îÄ BIOCONDUCTOR_CHECKLIST.md         # Submission prep ‚îÇ ‚îî‚îÄ‚îÄ PROJECT_STATUS.md                      # This file"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"consistent-function-signatures","dir":"","previous_headings":"API Design","what":"Consistent Function Signatures","title":"xcmsVis Project Status","text":"","code":"gplotFunction(object,                    # XCMSnExp or XcmsExperiment               color_by = NULL,           # NSE column name               include_columns = NULL,    # Additional metadata               ...)                       # Function-specific args"},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"s4-method-dispatch","dir":"","previous_headings":"API Design","what":"S4 Method Dispatch","title":"xcmsVis Project Status","text":"functions use proper S4 generics methods object type:","code":"setGeneric(\"gplotFunction\", ...) setMethod(\"gplotFunction\", \"XCMSnExp\", ...) setMethod(\"gplotFunction\", \"XcmsExperiment\", ...)"},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"non-standard-evaluation","dir":"","previous_headings":"API Design","what":"Non-Standard Evaluation","title":"xcmsVis Project Status","text":"","code":"# Users can use unquoted column names gplotAdjustedRtime(xdata, color_by = sample_group)  # Or strings gplotAdjustedRtime(xdata, color_by = \"sample_group\")"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"r-cmd-check","dir":"","previous_headings":"Quality Assurance","what":"R CMD Check","title":"xcmsVis Project Status","text":"‚úÖ Status: PASS - 0 Errors - 0 Warnings - 0 Notes","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"github-actions","dir":"","previous_headings":"Quality Assurance","what":"GitHub Actions","title":"xcmsVis Project Status","text":"‚úÖ pkgdown deployment: Deploys gh-pages branch ‚úÖ R CMD check: Tests multiple R versions platforms","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"test-infrastructure","dir":"","previous_headings":"Quality Assurance","what":"Test Infrastructure","title":"xcmsVis Project Status","text":"setup-biocparallel.R: Configures serial processing eliminate warnings Comprehensive tests: functions tested object types Edge cases: Empty objects, peaks, invalid parameters","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"id_1-multi-sample-peak-highlighting","dir":"","previous_headings":"Known Implementation Details","what":"1. Multi-Sample Peak Highlighting","title":"xcmsVis Project Status","text":"ghighlightChromPeaks follows XCMS convention: Takes full XCMSnExp/XcmsExperiment object Searches peaks across samples Filters rt/mz parameters Recommended: Use filterFile() first single-sample visualization.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"id_2-polygon-peak-visualization","dir":"","previous_headings":"Known Implementation Details","what":"2. Polygon Peak Visualization","title":"xcmsVis Project Status","text":"Exact replication XCMS behavior: - Extracts chromatograms entire m/z range (per-peak) - Orders peaks intensity descending - Creates closed polygons following chromatogram intensities See: R/ghighlightChromPeaks-methods.R lines 95-150","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"adding-new-functions","dir":"","previous_headings":"Development Workflow","what":"Adding New Functions","title":"xcmsVis Project Status","text":"‚úÖ Create R/gplot*.R S4 methods ‚úÖ Add roxygen2 documentation R/AllGenerics.R ‚úÖ Run devtools::document() update man/ NAMESPACE ‚úÖ Create tests tests/testthat/test-*.R ‚úÖ Add examples vignettes ‚úÖ Run devtools::check() ‚úÖ Update NEWS.md ‚úÖ Commit descriptive message","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"testing-checklist","dir":"","previous_headings":"Development Workflow","what":"Testing Checklist","title":"xcmsVis Project Status","text":"Test XCMSnExp XcmsExperiment Test parameter combinations Test edge cases (empty, peaks, etc.) Test NSE color_by functionality Verify ggplot object returned Check documentation examples work Run full devtools::check()","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"commit-message-format","dir":"","previous_headings":"Development Workflow","what":"Commit Message Format","title":"xcmsVis Project Status","text":"Types: feat, fix, docs, test, refactor, chore","code":"type: brief description  Detailed explanation of changes.  ü§ñ Generated with [Claude Code](https://claude.com/claude-code)  Co-Authored-By: Claude <noreply@anthropic.com>"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"roxygen2-pattern","dir":"","previous_headings":"Documentation Structure","what":"Roxygen2 Pattern","title":"xcmsVis Project Status","text":"","code":"#' @title Function Title #' @description Brief description #' @param object An `XCMSnExp` or `XcmsExperiment` object #' @return A ggplot object #' @details Detailed explanation #' @examples #' \\donttest{ #' # Working examples using faahKO data #' } #' @seealso \\code{\\link[xcms]{originalFunction}} #' @export setGeneric(\"functionName\", ...)"},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"man-page-features","dir":"","previous_headings":"Documentation Structure","what":"Man Page Features","title":"xcmsVis Project Status","text":"‚úÖ Comprehensive parameter descriptions ‚úÖ Working examples faahKO data ‚úÖ Cross-references XCMS originals ‚úÖ Usage notes object types ‚úÖ Behavior explanations","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"key-achievements","dir":"","previous_headings":"","what":"Key Achievements","title":"xcmsVis Project Status","text":"‚úÖ 9 core functions implemented full dual-object support ‚úÖ Exact XCMS replication visualization behaviors ‚úÖ Comprehensive documentation side--side comparisons ‚úÖ Full test coverage including edge cases (9 test files, 153 tests passing) ‚úÖ Clean package structure following R best practices ‚úÖ GitHub Actions CI/CD pipeline ‚úÖ NSE support user-friendly API ‚úÖ Five comprehensive vignettes covering major use cases ‚úÖ XcmsExperiment BPI/MS map visualization patchwork integration ‚úÖ Chromatogram overlay peak density visualization ‚úÖ Feature group visualization connected features across RT-m/z space","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"quick-start","dir":"","previous_headings":"Usage Examples","what":"Quick Start","title":"xcmsVis Project Status","text":"","code":"library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment)  # Load data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3] xdata <- readMsExperiment(spectraFiles = cdf_files)  # Peak detection xdata <- findChromPeaks(xdata, param = CentWaveParam())  # Visualizations gplotChromPeaks(xdata) gplotChromPeakImage(xdata)  # RT alignment xdata <- adjustRtime(xdata, param = ObiwarpParam()) gplotAdjustedRtime(xdata, color_by = sample_name)  # Chromatogram plotting chr <- chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500)) gplot(chr[1, 1])  # XcmsExperiment BPI and MS map visualization gplot(xdata)  # Creates combined BPI + MS map with patchwork"},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"advanced-filtered-peak-highlighting","dir":"","previous_headings":"Usage Examples","what":"Advanced: Filtered Peak Highlighting","title":"xcmsVis Project Status","text":"","code":"# Extract chromatogram chr <- chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500))  # Highlight only peaks from first sample gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(     filterFile(xdata, 1),     rt = c(2500, 3500),     mz = c(200, 210),     type = \"polygon\",     border = \"blue\"   )"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"documentation","dir":"","previous_headings":"Resources","what":"Documentation","title":"xcmsVis Project Status","text":"Package Website: https://stanstrup.github.io/xcmsVis/ (via pkgdown) XCMS Package: https://github.com/sneumann/xcms Bioconductor XCMS: https://bioconductor.org/packages/xcms","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"development-guides","dir":"","previous_headings":"Resources","what":"Development Guides","title":"xcmsVis Project Status","text":"dev-docs/XCMS_REFERENCE.md - XCMS function pattern reference dev-docs/S4_GUIDE.md - S4 implementation guide dev-docs/BIOCONDUCTOR_CHECKLIST.md - Submission preparation CLAUDE.md - Development workflow conventions","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"contributors","dir":"","previous_headings":"","what":"Contributors","title":"xcmsVis Project Status","text":"Developed using Claude Code extensive reference XCMS source code documentation.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/PROJECT_STATUS.html","id":"license","dir":"","previous_headings":"","what":"License","title":"xcmsVis Project Status","text":"XCMS package (GPL-2 GPL-3) Questions Issues? - GitHub Issues: https://github.com/stanstrup/xcmsVis/issues - XCMS Google Group: https://groups.google.com/g/xcms","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Chromatograms and Peak Density","text":"vignette demonstrates ggplot2-based functions visualizing chromatograms evaluating peak density correspondence: gplot(): Plot individual chromatograms detected peaks gplotChromPeakDensity(): Visualize peak density optimizing correspondence parameters gplotChromatogramsOverlay(): Create overlay plots multiple extracted ion chromatograms (EICs) functions work XChromatograms MChromatograms objects XCMS package.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Chromatograms and Peak Density","text":"","code":"library(xcms) library(ggplot2) library(plotly) library(patchwork) library(xcmsVis)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Chromatograms and Peak Density","text":"‚Äôll use pre-processed test data XCMS faster execution:","code":"# Load pre-processed data with detected peaks xdata <- loadXcmsData(\"faahko_sub2\")  # Check data cat(\"Samples:\", length(fileNames(xdata)), \"\\n\") #> Samples: 3 cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 248"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplot-individual-chromatogram-visualization","dir":"Articles","previous_headings":"","what":"gplot: Individual Chromatogram Visualization","title":"Visualizing Chromatograms and Peak Density","text":"gplot() function creates chromatogram plots detected peaks automatically annotated.","code":"# Extract chromatogram for one sample chr <- chromatogram(xdata, mz = c(305.05, 305.15))  # ggplot2 version gplot(chr[1, 1]) p1 <- gplot(chr[1, 1], peakType = \"polygon\") + ggtitle(\"Polygon\") p2 <- gplot(chr[1, 1], peakType = \"point\") + ggtitle(\"Point\") p3 <- gplot(chr[1, 1], peakType = \"rectangle\") + ggtitle(\"Rectangle\") p4 <- gplot(chr[1, 1], peakType = \"none\") + ggtitle(\"None\")  (p1 | p2) / (p3 | p4) ggplotly(gplot(chr[1, 1]))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Extract chromatogram for one sample chr <- chromatogram(xdata, mz = c(305.05, 305.15))  # ggplot2 version gplot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"multiple-peak-types","dir":"Articles","previous_headings":"","what":"Multiple Peak Types","title":"Visualizing Chromatograms and Peak Density","text":"","code":"p1 <- gplot(chr[1, 1], peakType = \"polygon\") + ggtitle(\"Polygon\") p2 <- gplot(chr[1, 1], peakType = \"point\") + ggtitle(\"Point\") p3 <- gplot(chr[1, 1], peakType = \"rectangle\") + ggtitle(\"Rectangle\") p4 <- gplot(chr[1, 1], peakType = \"none\") + ggtitle(\"None\")  (p1 | p2) / (p3 | p4)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"interactive-with-plotly","dir":"Articles","previous_headings":"","what":"Interactive with plotly","title":"Visualizing Chromatograms and Peak Density","text":"","code":"ggplotly(gplot(chr[1, 1]))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplotchrompeakdensity-peak-density-visualization","dir":"Articles","previous_headings":"","what":"gplotChromPeakDensity: Peak Density Visualization","title":"Visualizing Chromatograms and Peak Density","text":"gplotChromPeakDensity() function helps optimize peak density correspondence parameters visualizing peaks grouped.  bandwidth (bw) parameter controls smoothing density estimate. Larger values group distant peaks together:  running correspondence analysis, can visualize actual feature grouping setting simulate = FALSE:  Feature Annotations simulate = FALSE, plot shows actual feature groupings determined correspondence algorithm. Vertical dashed lines indicate median retention time detected feature across samples.","code":"# ggplot2 version prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) gplotChromPeakDensity(chr, param = prm) prm_small <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 15) prm_medium <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) prm_large <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 60)  p1 <- gplotChromPeakDensity(chr, param = prm_small) +   ggtitle(\"Bandwidth = 15\") p2 <- gplotChromPeakDensity(chr, param = prm_medium) +   ggtitle(\"Bandwidth = 30\") p3 <- gplotChromPeakDensity(chr, param = prm_large) +   ggtitle(\"Bandwidth = 60\")  p1 | p2 | p3 # Perform correspondence xdata_grouped <- groupChromPeaks(xdata, param = PeakDensityParam(   sampleGroups = rep(1, 3),   minFraction = 0.4,   bw = 30 ))  # Extract chromatogram again (now with correspondence info) chr_grouped <- chromatogram(xdata_grouped, mz = c(305.05, 305.15))  # Plot with ggplot2 version gplotChromPeakDensity(chr_grouped, simulate = FALSE) +   ggtitle(\"Actual Correspondence Results\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"basic-usage-1","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) gplotChromPeakDensity(chr, param = prm)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"optimizing-bandwidth-parameter","dir":"Articles","previous_headings":"","what":"Optimizing Bandwidth Parameter","title":"Visualizing Chromatograms and Peak Density","text":"bandwidth (bw) parameter controls smoothing density estimate. Larger values group distant peaks together:","code":"prm_small <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 15) prm_medium <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) prm_large <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 60)  p1 <- gplotChromPeakDensity(chr, param = prm_small) +   ggtitle(\"Bandwidth = 15\") p2 <- gplotChromPeakDensity(chr, param = prm_medium) +   ggtitle(\"Bandwidth = 30\") p3 <- gplotChromPeakDensity(chr, param = prm_large) +   ggtitle(\"Bandwidth = 60\")  p1 | p2 | p3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"showing-actual-correspondence-results","dir":"Articles","previous_headings":"","what":"Showing Actual Correspondence Results","title":"Visualizing Chromatograms and Peak Density","text":"running correspondence analysis, can visualize actual feature grouping setting simulate = FALSE:  Feature Annotations simulate = FALSE, plot shows actual feature groupings determined correspondence algorithm. Vertical dashed lines indicate median retention time detected feature across samples.","code":"# Perform correspondence xdata_grouped <- groupChromPeaks(xdata, param = PeakDensityParam(   sampleGroups = rep(1, 3),   minFraction = 0.4,   bw = 30 ))  # Extract chromatogram again (now with correspondence info) chr_grouped <- chromatogram(xdata_grouped, mz = c(305.05, 305.15))  # Plot with ggplot2 version gplotChromPeakDensity(chr_grouped, simulate = FALSE) +   ggtitle(\"Actual Correspondence Results\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplotchromatogramsoverlay-overlay-visualization","dir":"Articles","previous_headings":"","what":"gplotChromatogramsOverlay: Overlay Visualization","title":"Visualizing Chromatograms and Peak Density","text":"gplotChromatogramsOverlay() function overlays different EICs (rows) sample (column) one plot. different gplot() overlays EIC across different samples. Key Concept gplot(): Overlays m/z range across DIFFERENT samples gplotChromatogramsOverlay(): Overlays DIFFERENT m/z ranges within sample  multiple samples, gplotChromatogramsOverlay() creates faceted plot one panel per sample:  ‚Äôs direct comparison showing key difference:  better visual separation, chromatograms can vertically offset:  Apply transformations better visualization low-intensity features:","code":"# Extract multiple EICs from ONE sample chr_multi <- chromatogram(xdata[1,], mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) ))  # ggplot2 version gplotChromatogramsOverlay(chr_multi, main = \"Sample 1\") # Extract multiple EICs from ALL samples chr_all <- chromatogram(xdata, mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) ))  # ggplot2 version - uses faceting gplotChromatogramsOverlay(chr_all,                           main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\")) # LEFT: gplot() - same EIC (m/z 305) across different samples chr_one_eic <- chromatogram(xdata, mz = c(305.05, 305.15)) p_left <- gplot(chr_one_eic) +   ggtitle(\"gplot(): Same EIC, Different Samples\")  # RIGHT: gplotChromatogramsOverlay() - different EICs within one sample chr_multi_eic <- chromatogram(xdata[1,], mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) )) p_right <- gplotChromatogramsOverlay(chr_multi_eic) +   ggtitle(\"gplotChromatogramsOverlay(): Different EICs, Same Sample\")  p_left | p_right # ggplot2 version gplotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\") gplotChromatogramsOverlay(chr_multi, transform = log1p, main = \"Sample 1\") +   ggtitle(\"Log-Transformed Intensities\") gplotChromatogramsOverlay(   chr_multi,   col = \"blue\",   peakCol = \"red\",   peakBg = \"#ff000020\",   peakType = \"rectangle\",   main = \"Sample 1\" ) + ggtitle(\"Custom Styling\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"understanding-the-difference","dir":"Articles","previous_headings":"","what":"Understanding the Difference","title":"Visualizing Chromatograms and Peak Density","text":"Key Concept gplot(): Overlays m/z range across DIFFERENT samples gplotChromatogramsOverlay(): Overlays DIFFERENT m/z ranges within sample","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"single-sample-multiple-eics-overlaid","dir":"Articles","previous_headings":"","what":"Single Sample: Multiple EICs Overlaid","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Extract multiple EICs from ONE sample chr_multi <- chromatogram(xdata[1,], mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) ))  # ggplot2 version gplotChromatogramsOverlay(chr_multi, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"multiple-samples-faceted-layout","dir":"Articles","previous_headings":"","what":"Multiple Samples: Faceted Layout","title":"Visualizing Chromatograms and Peak Density","text":"multiple samples, gplotChromatogramsOverlay() creates faceted plot one panel per sample:","code":"# Extract multiple EICs from ALL samples chr_all <- chromatogram(xdata, mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) ))  # ggplot2 version - uses faceting gplotChromatogramsOverlay(chr_all,                           main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"contrast-gplot-vs-gplotchromatogramsoverlay","dir":"Articles","previous_headings":"","what":"Contrast: gplot() vs gplotChromatogramsOverlay()","title":"Visualizing Chromatograms and Peak Density","text":"‚Äôs direct comparison showing key difference:","code":"# LEFT: gplot() - same EIC (m/z 305) across different samples chr_one_eic <- chromatogram(xdata, mz = c(305.05, 305.15)) p_left <- gplot(chr_one_eic) +   ggtitle(\"gplot(): Same EIC, Different Samples\")  # RIGHT: gplotChromatogramsOverlay() - different EICs within one sample chr_multi_eic <- chromatogram(xdata[1,], mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) )) p_right <- gplotChromatogramsOverlay(chr_multi_eic) +   ggtitle(\"gplotChromatogramsOverlay(): Different EICs, Same Sample\")  p_left | p_right"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"stacked-visualization","dir":"Articles","previous_headings":"","what":"Stacked Visualization","title":"Visualizing Chromatograms and Peak Density","text":"better visual separation, chromatograms can vertically offset:","code":"# ggplot2 version gplotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"intensity-transformation","dir":"Articles","previous_headings":"","what":"Intensity Transformation","title":"Visualizing Chromatograms and Peak Density","text":"Apply transformations better visualization low-intensity features:","code":"gplotChromatogramsOverlay(chr_multi, transform = log1p, main = \"Sample 1\") +   ggtitle(\"Log-Transformed Intensities\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"custom-colors-and-peak-styles","dir":"Articles","previous_headings":"","what":"Custom Colors and Peak Styles","title":"Visualizing Chromatograms and Peak Density","text":"","code":"gplotChromatogramsOverlay(   chr_multi,   col = \"blue\",   peakCol = \"red\",   peakBg = \"#ff000020\",   peakType = \"rectangle\",   main = \"Sample 1\" ) + ggtitle(\"Custom Styling\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"complete-workflow-example","dir":"Articles","previous_headings":"","what":"Complete Workflow Example","title":"Visualizing Chromatograms and Peak Density","text":"‚Äôs complete workflow demonstrating functions work together:","code":"# 1. Extract chromatogram for one m/z chr_workflow <- chromatogram(xdata, mz = c(344.0, 344.2))  # 2. Check peak density with different parameters prm1 <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 20) prm2 <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 40)  p1 <- gplotChromPeakDensity(chr_workflow, param = prm1) +   ggtitle(\"Peak Density (bw=20)\")  p2 <- gplotChromPeakDensity(chr_workflow, param = prm2) +   ggtitle(\"Peak Density (bw=40)\")  # 3. Overlay multiple EICs from one sample chr_overlay <- chromatogram(xdata[1,], mz = rbind(   c(305.05, 305.15),   c(344.0, 344.2) )) p3 <- gplotChromatogramsOverlay(chr_overlay, main = \"Sample 1\") +   ggtitle(\"Multiple EICs Overlaid\")  # 4. Individual chromatogram detail p4 <- gplot(chr_workflow[1, 1]) +   ggtitle(\"Sample 1 Detail (m/z 344)\")  # Combine all plots (p1 | p2) / p3 / p4"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"interactive-exploration","dir":"Articles","previous_headings":"","what":"Interactive Exploration","title":"Visualizing Chromatograms and Peak Density","text":"ggplot2 outputs can converted interactive plotly visualizations:","code":"# Create interactive peak density plot p <- gplotChromPeakDensity(chr, param = prm) ggplotly(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Visualizing Chromatograms and Peak Density","text":"chromatogram visualization functions xcmsVis provide: Consistent API: functions return ggplot objects can customized Interactive capability: Easy conversion plotly data exploration Composition: Use patchwork combine multiple plots Flexibility: Extensive customization options colors, styles, transformations Quality: Publication-ready graphics clean, modern aesthetics functions particularly useful : Parameter optimization: gplotChromPeakDensity() helps tune correspondence parameters Quality control: gplotChromatogramsOverlay() reveals co-eluting compounds within samples Sample comparison: gplot() shows retention time shifts intensity variations samples Presentation: functions produce publication-quality figures Exploration: Interactive plotly conversion enables detailed data inspection","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"key-differences-between-functions","dir":"Articles","previous_headings":"","what":"Key Differences Between Functions","title":"Visualizing Chromatograms and Peak Density","text":"functions particularly useful : Parameter optimization: gplotChromPeakDensity() helps tune correspondence parameters Quality control: gplotChromatogramsOverlay() reveals co-eluting compounds within samples Sample comparison: gplot() shows retention time shifts intensity variations samples Presentation: functions produce publication-quality figures Exploration: Interactive plotly conversion enables detailed data inspection","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"supplementary-comparison-with-original-xcms","dir":"Articles","previous_headings":"","what":"Supplementary: Comparison with Original XCMS","title":"Visualizing Chromatograms and Peak Density","text":"supplementary section provides side--side comparisons original XCMS plotting functions new xcmsVis ggplot2-based implementations. comparisons useful developers users migrating original XCMS plotting functions.","code":"# Extract chromatogram for one sample chr <- chromatogram(xdata, mz = c(305.05, 305.15))  # Base R graphics version plot(chr[1, 1]) # ggplot2 version gplot(chr[1, 1]) # Base R graphics version prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) plotChromPeakDensity(chr, param = prm) # ggplot2 version gplotChromPeakDensity(chr, param = prm) # Plot with XCMS original plotChromPeakDensity(chr_grouped, simulate = FALSE) # Plot with ggplot2 version gplotChromPeakDensity(chr_grouped, simulate = FALSE) +   ggtitle(\"Actual Correspondence Results\") # Base R graphics version plotChromatogramsOverlay(chr_multi, main = \"Sample 1\") # ggplot2 version gplotChromatogramsOverlay(chr_multi, main = \"Sample 1\") # Base R graphics version - creates multi-panel plot plotChromatogramsOverlay(chr_all,                          main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\")) # ggplot2 version - uses faceting gplotChromatogramsOverlay(chr_all,                           main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\")) # Base R version plotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\") # ggplot2 version gplotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplot-individual-chromatogram-visualization-1","dir":"Articles","previous_headings":"","what":"gplot: Individual Chromatogram Visualization","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Extract chromatogram for one sample chr <- chromatogram(xdata, mz = c(305.05, 305.15))  # Base R graphics version plot(chr[1, 1]) # ggplot2 version gplot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Extract chromatogram for one sample chr <- chromatogram(xdata, mz = c(305.05, 305.15))  # Base R graphics version plot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version gplot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplotchrompeakdensity-peak-density-visualization-1","dir":"Articles","previous_headings":"","what":"gplotChromPeakDensity: Peak Density Visualization","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) plotChromPeakDensity(chr, param = prm) # ggplot2 version gplotChromPeakDensity(chr, param = prm)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) plotChromPeakDensity(chr, param = prm)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"xcmsvis-ggplot2-version-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version gplotChromPeakDensity(chr, param = prm)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"actual-correspondence-results","dir":"Articles","previous_headings":"","what":"Actual Correspondence Results","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Plot with XCMS original plotChromPeakDensity(chr_grouped, simulate = FALSE) # Plot with ggplot2 version gplotChromPeakDensity(chr_grouped, simulate = FALSE) +   ggtitle(\"Actual Correspondence Results\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Plot with XCMS original plotChromPeakDensity(chr_grouped, simulate = FALSE)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"ggplot2-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Plot with ggplot2 version gplotChromPeakDensity(chr_grouped, simulate = FALSE) +   ggtitle(\"Actual Correspondence Results\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplotchromatogramsoverlay-single-sample","dir":"Articles","previous_headings":"","what":"gplotChromatogramsOverlay: Single Sample","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version plotChromatogramsOverlay(chr_multi, main = \"Sample 1\") # ggplot2 version gplotChromatogramsOverlay(chr_multi, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version-3","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version plotChromatogramsOverlay(chr_multi, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"xcmsvis-ggplot2-version-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version gplotChromatogramsOverlay(chr_multi, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"gplotchromatogramsoverlay-multiple-samples","dir":"Articles","previous_headings":"","what":"gplotChromatogramsOverlay: Multiple Samples","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version - creates multi-panel plot plotChromatogramsOverlay(chr_all,                          main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\")) # ggplot2 version - uses faceting gplotChromatogramsOverlay(chr_all,                           main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version-4","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R graphics version - creates multi-panel plot plotChromatogramsOverlay(chr_all,                          main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"xcmsvis-ggplot2-version-3","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version - uses faceting gplotChromatogramsOverlay(chr_all,                           main = c(\"Sample 1\", \"Sample 2\", \"Sample 3\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"stacked-visualization-1","dir":"Articles","previous_headings":"","what":"Stacked Visualization","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R version plotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\") # ggplot2 version gplotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"original-xcms-version-5","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# Base R version plotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"xcmsvis-ggplot2-version-4","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatograms and Peak Density","text":"","code":"# ggplot2 version gplotChromatogramsOverlay(chr_multi, stacked = 0.1, main = \"Sample 1\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/chromatogram-visualization.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Visualizing Chromatograms and Peak Density","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] xcmsVis_0.99.15     patchwork_1.3.2     plotly_4.11.0       #> [4] ggplot2_4.0.0       xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] ProtGenerics_1.42.0         pkgconfig_2.0.3             #>  [13] MetaboCoreUtils_1.18.0      crayon_1.5.3                #>  [15] fastmap_1.2.0               XVector_0.50.0              #>  [17] labeling_0.4.3              rmarkdown_2.30              #>  [19] preprocessCore_1.72.0       purrr_1.2.0                 #>  [21] xfun_0.54                   MultiAssayExperiment_1.36.0 #>  [23] jsonlite_2.0.0              progress_1.2.3              #>  [25] DelayedArray_0.36.0         parallel_4.5.2              #>  [27] prettyunits_1.2.0           cluster_2.1.8.1             #>  [29] R6_2.6.1                    stringi_1.8.7               #>  [31] RColorBrewer_1.1-3          limma_3.66.0                #>  [33] GenomicRanges_1.62.0        Rcpp_1.1.0                  #>  [35] Seqinfo_1.0.0               SummarizedExperiment_1.40.0 #>  [37] iterators_1.0.14            knitr_1.50                  #>  [39] IRanges_2.44.0              BiocBaseUtils_1.12.0        #>  [41] Matrix_1.7-4                igraph_2.2.1                #>  [43] tidyselect_1.2.1            abind_1.4-8                 #>  [45] yaml_2.3.10                 doParallel_1.0.17           #>  [47] codetools_0.2-20            affy_1.88.0                 #>  [49] lattice_0.22-7              tibble_3.3.0                #>  [51] plyr_1.8.9                  Biobase_2.70.0              #>  [53] withr_3.0.2                 S7_0.2.0                    #>  [55] evaluate_1.0.5              Spectra_1.20.0              #>  [57] pillar_1.11.1               affyio_1.80.0               #>  [59] BiocManager_1.30.26         MatrixGenerics_1.22.0       #>  [61] foreach_1.5.2               stats4_4.5.2                #>  [63] MSnbase_2.36.0              MALDIquant_1.22.3           #>  [65] ncdf4_1.24                  generics_0.1.4              #>  [67] S4Vectors_0.48.0            hms_1.1.4                   #>  [69] scales_1.4.0                MsExperiment_1.12.0         #>  [71] glue_1.8.0                  MsFeatures_1.18.0           #>  [73] lazyeval_0.2.2              tools_4.5.2                 #>  [75] mzID_1.48.0                 data.table_1.17.8           #>  [77] QFeatures_1.20.0            vsn_3.78.0                  #>  [79] mzR_2.44.0                  fs_1.6.6                    #>  [81] XML_3.99-0.19               grid_4.5.2                  #>  [83] impute_1.84.0               tidyr_1.3.1                 #>  [85] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [87] PSMatch_1.14.0              cli_3.6.5                   #>  [89] viridisLite_0.4.2           S4Arrays_1.10.0             #>  [91] dplyr_1.1.4                 AnnotationFilter_1.34.0     #>  [93] pcaMethods_2.2.0            gtable_0.3.6                #>  [95] digest_0.6.37               BiocGenerics_0.56.0         #>  [97] SparseArray_1.10.1          htmlwidgets_1.6.4           #>  [99] farver_2.1.2                htmltools_0.5.8.1           #> [101] lifecycle_1.0.4             httr_1.4.7                  #> [103] statmod_1.5.1               MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Feature Groups","text":"vignette demonstrates gplotFeatureGroups() function visualizing relationships features LC-MS data. feature detection correspondence, groupFeatures() identifies features likely represent compound (e.g., isotopes, adducts, fragments). gplotFeatureGroups() function visualizes relationships plotting features connected lines within group across retention time m/z dimensions. ggplot2 reimplementation XCMS‚Äôs plotFeatureGroups() function, enabling: Interactive plots plotly Customizable styling Publication-quality graphics Consistent API xcmsVis functions","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Feature Groups","text":"","code":"library(xcms) library(xcmsVis) library(MsExperiment) library(MsFeatures) library(ggplot2) library(BiocParallel)  # Configure for serial processing register(SerialParam())"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"load-and-process-data","dir":"Articles","previous_headings":"","what":"Load and Process Data","title":"Visualizing Feature Groups","text":"Feature grouping requires complete XCMS workflow: peak detection, correspondence, retention time alignment, re-correspondence, feature grouping.","code":"# Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment xdata <- readMsExperiment(spectraFiles = cdf_files)  # Add sample metadata sampleData(xdata)$sample_name <- basename(cdf_files) sampleData(xdata)$sample_group <- c(\"KO\", \"KO\", \"WT\")  cat(\"Loaded\", length(fileNames(xdata)), \"files\\n\") #> Loaded 3 files"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"complete-xcms-workflow","dir":"Articles","previous_headings":"","what":"Complete XCMS Workflow","title":"Visualizing Feature Groups","text":"","code":"# 1. Peak detection cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25, noise = 1000) xdata <- findChromPeaks(xdata, param = cwp) cat(\"Detected\", nrow(chromPeaks(xdata)), \"peaks\\n\") #> Detected 3385 peaks  # 2. Peak grouping (correspondence) pdp <- PeakDensityParam(sampleGroups = sampleData(xdata)$sample_group,                         minFraction = 0.5, bw = 30) xdata <- groupChromPeaks(xdata, param = pdp) cat(\"Grouped into\", nrow(featureDefinitions(xdata)), \"features\\n\") #> Grouped into 1934 features  # 3. Retention time alignment xdata <- adjustRtime(xdata, param = ObiwarpParam())  # 4. Re-group after alignment xdata <- groupChromPeaks(xdata, param = pdp) cat(\"After alignment:\", nrow(featureDefinitions(xdata)), \"features\\n\") #> After alignment: 1934 features  # 5. Group features (identify related features) xdata <- groupFeatures(xdata, param = SimilarRtimeParam(diffRt = 20)) cat(\"Identified\", length(unique(featureGroups(xdata))), \"feature groups\\n\") #> Identified 604 feature groups"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"basic-feature-group-visualization","dir":"Articles","previous_headings":"","what":"Basic Feature Group Visualization","title":"Visualizing Feature Groups","text":"default plot shows feature groups, features connected lines within group:  Points: Individual features (median RT m/z across samples) Lines: Connect features within group Groups: Represent features likely compound (isotopes, adducts, etc.)","code":"gplotFeatureGroups(xdata)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Visualizing Feature Groups","text":"Points: Individual features (median RT m/z across samples) Lines: Connect features within group Groups: Represent features likely compound (isotopes, adducts, etc.)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"filtering-to-specific-feature-groups","dir":"Articles","previous_headings":"","what":"Filtering to Specific Feature Groups","title":"Visualizing Feature Groups","text":"can visualize specific feature groups interest:","code":"# Get all feature group IDs all_groups <- unique(featureGroups(xdata)) cat(\"Feature groups:\", head(all_groups, 10), \"\\n\") #> Feature groups: FG.0001 FG.0002 FG.0003 FG.0004 FG.0005 FG.0006 FG.0007 FG.0008 FG.0009 FG.0010  # Plot first 5 groups   gplotFeatureGroups(xdata, featureGroups = all_groups[1:5]) +     ggtitle(\"First 5 Feature Groups\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"customization","dir":"Articles","previous_headings":"","what":"Customization","title":"Visualizing Feature Groups","text":"type parameter controls whether show lines, points, :  Use xlim ylim focus specific retention time m/z ranges:","code":"# Get first 5 feature groups for clearer visualization all_groups <- unique(featureGroups(xdata))  gplotFeatureGroups(xdata,                    featureGroups = all_groups[1:5],                    col = \"#E31A1C\",  # Red color                    pch = 16,          # Solid circles                    xlab = \"Retention Time (sec)\",                    ylab = \"Mass-to-Charge Ratio (m/z)\",                    main = \"Custom Styled Feature Groups\") library(patchwork)  # Use subset of feature groups for clearer visualization fg_subset <- all_groups[1:5]  # Plot with lines and points (default) p1 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"o\") +   ggtitle('type = \"o\" (overplot - lines + points)')  # Plot with lines only p2 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"l\") +   ggtitle('type = \"l\" (lines only)')  # Plot with points only p3 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"p\", pch = 16) +   ggtitle('type = \"p\" (points only)')  # Combine plots p1 / p2 / p3 # Focus on features between 3200-3300 seconds RT and specific feature groups gplotFeatureGroups(xdata,                    featureGroups = fg_subset,                    xlim = c(3200, 3300),                    ylim = c(200, 600)) +   ggtitle(\"Features in RT 3200-3300 sec, m/z 200-600\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"custom-styling","dir":"Articles","previous_headings":"","what":"Custom Styling","title":"Visualizing Feature Groups","text":"","code":"# Get first 5 feature groups for clearer visualization all_groups <- unique(featureGroups(xdata))  gplotFeatureGroups(xdata,                    featureGroups = all_groups[1:5],                    col = \"#E31A1C\",  # Red color                    pch = 16,          # Solid circles                    xlab = \"Retention Time (sec)\",                    ylab = \"Mass-to-Charge Ratio (m/z)\",                    main = \"Custom Styled Feature Groups\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"different-plot-types","dir":"Articles","previous_headings":"","what":"Different Plot Types","title":"Visualizing Feature Groups","text":"type parameter controls whether show lines, points, :","code":"library(patchwork)  # Use subset of feature groups for clearer visualization fg_subset <- all_groups[1:5]  # Plot with lines and points (default) p1 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"o\") +   ggtitle('type = \"o\" (overplot - lines + points)')  # Plot with lines only p2 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"l\") +   ggtitle('type = \"l\" (lines only)')  # Plot with points only p3 <- gplotFeatureGroups(xdata, featureGroups = fg_subset, type = \"p\", pch = 16) +   ggtitle('type = \"p\" (points only)')  # Combine plots p1 / p2 / p3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"zooming-to-specific-regions","dir":"Articles","previous_headings":"","what":"Zooming to Specific Regions","title":"Visualizing Feature Groups","text":"Use xlim ylim focus specific retention time m/z ranges:","code":"# Focus on features between 3200-3300 seconds RT and specific feature groups gplotFeatureGroups(xdata,                    featureGroups = fg_subset,                    xlim = c(3200, 3300),                    ylim = c(200, 600)) +   ggtitle(\"Features in RT 3200-3300 sec, m/z 200-600\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"interactive-visualization","dir":"Articles","previous_headings":"","what":"Interactive Visualization","title":"Visualizing Feature Groups","text":"Convert interactive plotly plot exploration:","code":"library(plotly)  # Use subset for better interactivity p <- gplotFeatureGroups(xdata, featureGroups = fg_subset) ggplotly(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"understanding-feature-groups","dir":"Articles","previous_headings":"","what":"Understanding Feature Groups","title":"Visualizing Feature Groups","text":"Feature groups represent features likely derived compound. Common grouping parameters:","code":"# Group features with similar retention times (likely isotopes/adducts) xdata_rt <- groupFeatures(xdata, param = SimilarRtimeParam(diffRt = 10)) cat(\"SimilarRtimeParam (diffRt=10):\",     length(unique(featureGroups(xdata_rt))), \"groups\\n\") #> SimilarRtimeParam (diffRt=10): 609 groups  # Show first 5 groups fg_rt <- unique(featureGroups(xdata_rt)) gplotFeatureGroups(xdata_rt, featureGroups = fg_rt[1:5]) +   ggtitle(\"Feature Groups: Similar Retention Time (diffRt = 10 sec)\") # Group features with correlated abundances across samples xdata_cor <- groupFeatures(xdata, param = AbundanceSimilarityParam(threshold = 0.7)) cat(\"AbundanceSimilarityParam (threshold=0.7):\",     length(unique(featureGroups(xdata_cor))), \"groups\\n\") #> AbundanceSimilarityParam (threshold=0.7): 1834 groups  # Show first 5 groups fg_cor <- unique(featureGroups(xdata_cor)) gplotFeatureGroups(xdata_cor, featureGroups = fg_cor[1:5]) +   ggtitle(\"Feature Groups: Abundance Correlation (threshold = 0.7)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"similar-retention-time","dir":"Articles","previous_headings":"","what":"Similar Retention Time","title":"Visualizing Feature Groups","text":"","code":"# Group features with similar retention times (likely isotopes/adducts) xdata_rt <- groupFeatures(xdata, param = SimilarRtimeParam(diffRt = 10)) cat(\"SimilarRtimeParam (diffRt=10):\",     length(unique(featureGroups(xdata_rt))), \"groups\\n\") #> SimilarRtimeParam (diffRt=10): 609 groups  # Show first 5 groups fg_rt <- unique(featureGroups(xdata_rt)) gplotFeatureGroups(xdata_rt, featureGroups = fg_rt[1:5]) +   ggtitle(\"Feature Groups: Similar Retention Time (diffRt = 10 sec)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"abundance-correlation","dir":"Articles","previous_headings":"","what":"Abundance Correlation","title":"Visualizing Feature Groups","text":"","code":"# Group features with correlated abundances across samples xdata_cor <- groupFeatures(xdata, param = AbundanceSimilarityParam(threshold = 0.7)) cat(\"AbundanceSimilarityParam (threshold=0.7):\",     length(unique(featureGroups(xdata_cor))), \"groups\\n\") #> AbundanceSimilarityParam (threshold=0.7): 1834 groups  # Show first 5 groups fg_cor <- unique(featureGroups(xdata_cor)) gplotFeatureGroups(xdata_cor, featureGroups = fg_cor[1:5]) +   ggtitle(\"Feature Groups: Abundance Correlation (threshold = 0.7)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"comparison-with-original-xcms","dir":"Articles","previous_headings":"","what":"Comparison with Original XCMS","title":"Visualizing Feature Groups","text":"","code":"# XCMS original (base R graphics) plotFeatureGroups(xdata, featureGroups = c(\"FG.0001\", \"FG.0002\", \"FG.0003\", \"FG.0004\", \"FG.0005\")) # xcmsVis version (ggplot2) gplotFeatureGroups(xdata, featureGroups = c(\"FG.0001\", \"FG.0002\", \"FG.0003\", \"FG.0004\", \"FG.0005\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"original-xcms-version","dir":"Articles","previous_headings":"","what":"Original XCMS Version","title":"Visualizing Feature Groups","text":"","code":"# XCMS original (base R graphics) plotFeatureGroups(xdata, featureGroups = c(\"FG.0001\", \"FG.0002\", \"FG.0003\", \"FG.0004\", \"FG.0005\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"","what":"xcmsVis ggplot2 Version","title":"Visualizing Feature Groups","text":"","code":"# xcmsVis version (ggplot2) gplotFeatureGroups(xdata, featureGroups = c(\"FG.0001\", \"FG.0002\", \"FG.0003\", \"FG.0004\", \"FG.0005\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/feature-groups-visualization.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Visualizing Feature Groups","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] plotly_4.11.0       patchwork_1.3.2     ggplot2_4.0.0       #> [4] MsFeatures_1.18.0   MsExperiment_1.12.0 ProtGenerics_1.42.0 #> [7] xcmsVis_0.99.15     xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0      #>  [13] crayon_1.5.3                fastmap_1.2.0               #>  [15] XVector_0.50.0              labeling_0.4.3              #>  [17] rmarkdown_2.30              preprocessCore_1.72.0       #>  [19] purrr_1.2.0                 xfun_0.54                   #>  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0              #>  [23] progress_1.2.3              DelayedArray_0.36.0         #>  [25] parallel_4.5.2              prettyunits_1.2.0           #>  [27] cluster_2.1.8.1             R6_2.6.1                    #>  [29] stringi_1.8.7               RColorBrewer_1.1-3          #>  [31] limma_3.66.0                GenomicRanges_1.62.0        #>  [33] Rcpp_1.1.0                  Seqinfo_1.0.0               #>  [35] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [37] knitr_1.50                  IRanges_2.44.0              #>  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4                #>  [41] igraph_2.2.1                tidyselect_1.2.1            #>  [43] abind_1.4-8                 yaml_2.3.10                 #>  [45] doParallel_1.0.17           codetools_0.2-20            #>  [47] affy_1.88.0                 lattice_0.22-7              #>  [49] tibble_3.3.0                plyr_1.8.9                  #>  [51] Biobase_2.70.0              withr_3.0.2                 #>  [53] S7_0.2.0                    evaluate_1.0.5              #>  [55] Spectra_1.20.0              pillar_1.11.1               #>  [57] affyio_1.80.0               BiocManager_1.30.26         #>  [59] MatrixGenerics_1.22.0       foreach_1.5.2               #>  [61] stats4_4.5.2                MSnbase_2.36.0              #>  [63] MALDIquant_1.22.3           ncdf4_1.24                  #>  [65] generics_0.1.4              S4Vectors_0.48.0            #>  [67] hms_1.1.4                   scales_1.4.0                #>  [69] glue_1.8.0                  lazyeval_0.2.2              #>  [71] tools_4.5.2                 mzID_1.48.0                 #>  [73] data.table_1.17.8           QFeatures_1.20.0            #>  [75] vsn_3.78.0                  mzR_2.44.0                  #>  [77] fs_1.6.6                    XML_3.99-0.19               #>  [79] grid_4.5.2                  impute_1.84.0               #>  [81] tidyr_1.3.1                 crosstalk_1.2.2             #>  [83] MsCoreUtils_1.21.0          PSMatch_1.14.0              #>  [85] cli_3.6.5                   viridisLite_0.4.2           #>  [87] S4Arrays_1.10.0             dplyr_1.1.4                 #>  [89] AnnotationFilter_1.34.0     pcaMethods_2.2.0            #>  [91] gtable_0.3.6                digest_0.6.37               #>  [93] BiocGenerics_0.56.0         SparseArray_1.10.1          #>  [95] htmlwidgets_1.6.4           farver_2.1.2                #>  [97] htmltools_0.5.8.1           lifecycle_1.0.4             #>  [99] httr_1.4.7                  statmod_1.5.1               #> [101] MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"vignette demonstrates gplotAdjustedRtime() function, provides ggplot2-based visualization retention time correction LC-MS metabolomics data. function designed work XcmsExperiment (XCMS v4+) XCMSnExp (XCMS v3) objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"library(xcms) library(xcmsVis) library(ggplot2) library(plotly) library(faahKO) library(MsExperiment) library(BiocParallel)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"‚Äôll use faahKO package, contains example LC-MS data analysis fatty acid amide hydrolase (FAAH) knockout mice. Data can also old style ‚ÄúXCMSnExp‚Äù (run) MSnbase.","code":"# Get example CDF files from faahKO package (load once, reuse throughout) cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                   recursive = TRUE, full.names = TRUE)  # Using 3 samples from each group (6 total) cdf_files <- cdf_files[c(1:3, 7:9)]  # Load data as XcmsExperiment # Use SerialParam for faster processing with small datasets xdata_raw <- readMsExperiment(   spectraFiles = cdf_files,   BPPARAM = SerialParam() )  # Add sample metadata sample_group <- rep(c(\"KO\", \"WT\"), each = 3) sampleData(xdata_raw)$sample_name <- basename(cdf_files) sampleData(xdata_raw)$sample_group <- sample_group xdata_raw <- as(as(xdata_raw, \"XcmsExperiment\"), \"XCMSnExp\") # Peak detection using CentWave algorithm (done once for efficiency) cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) # Use SerialParam for faster processing with small datasets xdata_peaks <- findChromPeaks(xdata_raw, param = cwp, BPPARAM = SerialParam())  # Initial correspondence (peak grouping) - done once for all examples sample_data <- xcmsVis:::.get_sample_data(xdata_peaks)  pdp <- PeakDensityParam(   sampleGroups = sample_data$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_grouped <- groupChromPeaks(xdata_peaks, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"peak-detection-performed-once","dir":"Articles","previous_headings":"","what":"Peak Detection (performed once)","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# Peak detection using CentWave algorithm (done once for efficiency) cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) # Use SerialParam for faster processing with small datasets xdata_peaks <- findChromPeaks(xdata_raw, param = cwp, BPPARAM = SerialParam())  # Initial correspondence (peak grouping) - done once for all examples sample_data <- xcmsVis:::.get_sample_data(xdata_peaks)  pdp <- PeakDensityParam(   sampleGroups = sample_data$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_grouped <- groupChromPeaks(xdata_peaks, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"proper XCMS workflow retention time adjustment using peak groups : Peak detection (already done ) Initial correspondence (grouping - already done ) Retention time adjustment (Re-correspondence alignment - needed visualization)  plot shows: Lines: One per sample, showing RT deviation across chromatographic run Grey circles: Individual peaks used alignment Grey dashed lines: Connect peaks feature across samples Since gplotAdjustedRtime() returns ggplot object, can easily customize :  Convert interactive plotly plot: Note can hover line see file path metadata.","code":"# Work with a copy of the grouped data xdata <- xdata_grouped  # Retention time alignment using peak groups pgp <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\" ) xdata <- adjustRtime(xdata, param = pgp)  # Note: Second groupChromPeaks after alignment is typically done for downstream # analysis (fillChromPeaks, feature tables), but not needed for RT visualization # ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p) p +   labs(     title = \"Retention Time Correction - faahKO Dataset\",     x = \"Adjusted Retention Time (s)\",     y = \"RT Adjustment (s)\",     color = \"Sample Group\"   ) +   theme_minimal() +   scale_color_brewer(palette = \"Set1\") +   theme(legend.position = \"top\") # Make it interactive p_interactive <- ggplotly(p, tooltip = \"text\") p_interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"complete-xcms-workflow","dir":"Articles","previous_headings":"","what":"Complete XCMS Workflow","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"proper XCMS workflow retention time adjustment using peak groups : Peak detection (already done ) Initial correspondence (grouping - already done ) Retention time adjustment (Re-correspondence alignment - needed visualization)","code":"# Work with a copy of the grouped data xdata <- xdata_grouped  # Retention time alignment using peak groups pgp <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\" ) xdata <- adjustRtime(xdata, param = pgp)  # Note: Second groupChromPeaks after alignment is typically done for downstream # analysis (fillChromPeaks, feature tables), but not needed for RT visualization"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"creating-the-plot","dir":"Articles","previous_headings":"","what":"Creating the Plot","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"plot shows: Lines: One per sample, showing RT deviation across chromatographic run Grey circles: Individual peaks used alignment Grey dashed lines: Connect peaks feature across samples","code":"# ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"customizing-the-plot","dir":"Articles","previous_headings":"","what":"Customizing the Plot","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Since gplotAdjustedRtime() returns ggplot object, can easily customize :","code":"p +   labs(     title = \"Retention Time Correction - faahKO Dataset\",     x = \"Adjusted Retention Time (s)\",     y = \"RT Adjustment (s)\",     color = \"Sample Group\"   ) +   theme_minimal() +   scale_color_brewer(palette = \"Set1\") +   theme(legend.position = \"top\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"interactive-visualization","dir":"Articles","previous_headings":"","what":"Interactive Visualization","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Convert interactive plotly plot: Note can hover line see file path metadata.","code":"# Make it interactive p_interactive <- ggplotly(p, tooltip = \"text\") p_interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"advanced-use-cases","dir":"Articles","previous_headings":"","what":"Advanced Use Cases","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Sometimes may want filter samples alignment:  can use specific samples alignment calculation keeping samples dataset:  comparison, ‚Äôs alignment using samples:","code":"# Work with a fresh copy from grouped data xdata_filtered <- xdata_grouped  # Filter to specific samples (files 2-5) xdata_filtered <- filterFile(xdata_filtered, c(2:5))  # Filtering removes correspondence - need to re-group with filtered samples sample_data_filtered <- xcmsVis:::.get_sample_data(xdata_filtered) pdp_filtered <- PeakDensityParam(   sampleGroups = sample_data_filtered$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_filtered <- groupChromPeaks(xdata_filtered, param = pdp_filtered)  # Align filtered data pgp_filter <- PeakGroupsParam(minFraction = 0.4) xdata_filtered <- adjustRtime(xdata_filtered, param = pgp_filter) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered) # Work with a fresh copy of grouped data xdata_subset <- xdata_grouped  # Use subset parameter to align using only specific samples pgp_subset <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\",   subset = c(1, 2, 3, 5)  # Exclude sample 4 from alignment calculation ) xdata_subset <- adjustRtime(xdata_subset, param = pgp_subset) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset) # Work with a fresh copy of grouped data xdata_no_subset <- xdata_grouped  # Align without subset parameter (use all samples) pgp_no_subset <- PeakGroupsParam(minFraction = 0.4) xdata_no_subset <- adjustRtime(xdata_no_subset, param = pgp_no_subset) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-filterfile","dir":"Articles","previous_headings":"","what":"With filterFile()","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Sometimes may want filter samples alignment:","code":"# Work with a fresh copy from grouped data xdata_filtered <- xdata_grouped  # Filter to specific samples (files 2-5) xdata_filtered <- filterFile(xdata_filtered, c(2:5))  # Filtering removes correspondence - need to re-group with filtered samples sample_data_filtered <- xcmsVis:::.get_sample_data(xdata_filtered) pdp_filtered <- PeakDensityParam(   sampleGroups = sample_data_filtered$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_filtered <- groupChromPeaks(xdata_filtered, param = pdp_filtered)  # Align filtered data pgp_filter <- PeakGroupsParam(minFraction = 0.4) xdata_filtered <- adjustRtime(xdata_filtered, param = pgp_filter) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-subset-parameter-in-peakgroupsparam","dir":"Articles","previous_headings":"","what":"With subset Parameter in PeakGroupsParam","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"can use specific samples alignment calculation keeping samples dataset:","code":"# Work with a fresh copy of grouped data xdata_subset <- xdata_grouped  # Use subset parameter to align using only specific samples pgp_subset <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\",   subset = c(1, 2, 3, 5)  # Exclude sample 4 from alignment calculation ) xdata_subset <- adjustRtime(xdata_subset, param = pgp_subset) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"without-subset-parameter-all-samples","dir":"Articles","previous_headings":"","what":"Without subset Parameter (All Samples)","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"comparison, ‚Äôs alignment using samples:","code":"# Work with a fresh copy of grouped data xdata_no_subset <- xdata_grouped  # Align without subset parameter (use all samples) pgp_no_subset <- PeakGroupsParam(minFraction = 0.4) xdata_no_subset <- adjustRtime(xdata_no_subset, param = pgp_no_subset) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] MsExperiment_1.12.0 ProtGenerics_1.42.0 faahKO_1.50.0       #> [4] plotly_4.11.0       ggplot2_4.0.0       xcmsVis_0.99.15     #> [7] xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0      #>  [13] crayon_1.5.3                fastmap_1.2.0               #>  [15] XVector_0.50.0              labeling_0.4.3              #>  [17] rmarkdown_2.30              preprocessCore_1.72.0       #>  [19] purrr_1.2.0                 xfun_0.54                   #>  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0              #>  [23] progress_1.2.3              DelayedArray_0.36.0         #>  [25] parallel_4.5.2              prettyunits_1.2.0           #>  [27] cluster_2.1.8.1             R6_2.6.1                    #>  [29] stringi_1.8.7               RColorBrewer_1.1-3          #>  [31] limma_3.66.0                GenomicRanges_1.62.0        #>  [33] Rcpp_1.1.0                  Seqinfo_1.0.0               #>  [35] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [37] knitr_1.50                  IRanges_2.44.0              #>  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4                #>  [41] igraph_2.2.1                tidyselect_1.2.1            #>  [43] abind_1.4-8                 yaml_2.3.10                 #>  [45] doParallel_1.0.17           codetools_0.2-20            #>  [47] affy_1.88.0                 lattice_0.22-7              #>  [49] tibble_3.3.0                plyr_1.8.9                  #>  [51] Biobase_2.70.0              withr_3.0.2                 #>  [53] S7_0.2.0                    evaluate_1.0.5              #>  [55] Spectra_1.20.0              pillar_1.11.1               #>  [57] affyio_1.80.0               BiocManager_1.30.26         #>  [59] MatrixGenerics_1.22.0       foreach_1.5.2               #>  [61] stats4_4.5.2                MSnbase_2.36.0              #>  [63] MALDIquant_1.22.3           ncdf4_1.24                  #>  [65] generics_0.1.4              S4Vectors_0.48.0            #>  [67] hms_1.1.4                   scales_1.4.0                #>  [69] glue_1.8.0                  MsFeatures_1.18.0           #>  [71] lazyeval_0.2.2              tools_4.5.2                 #>  [73] mzID_1.48.0                 data.table_1.17.8           #>  [75] QFeatures_1.20.0            vsn_3.78.0                  #>  [77] mzR_2.44.0                  fs_1.6.6                    #>  [79] XML_3.99-0.19               grid_4.5.2                  #>  [81] impute_1.84.0               tidyr_1.3.1                 #>  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [85] patchwork_1.3.2             PSMatch_1.14.0              #>  [87] cli_3.6.5                   viridisLite_0.4.2           #>  [89] S4Arrays_1.10.0             dplyr_1.1.4                 #>  [91] AnnotationFilter_1.34.0     pcaMethods_2.2.0            #>  [93] gtable_0.3.6                digest_0.6.37               #>  [95] BiocGenerics_0.56.0         SparseArray_1.10.1          #>  [97] htmlwidgets_1.6.4           farver_2.1.2                #>  [99] htmltools_0.5.8.1           lifecycle_1.0.4             #> [101] httr_1.4.7                  statmod_1.5.1               #> [103] MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"supplementary-comparison-with-original-xcms","dir":"Articles","previous_headings":"","what":"Supplementary: Comparison with Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"supplementary section provides side--side comparisons original XCMS plotAdjustedRtime() function new xcmsVis gplotAdjustedRtime() implementation. comparisons useful developers users migrating original XCMS plotting functions.","code":"# Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) # ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p) sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered) sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset) sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"basic-retention-time-adjustment-plot","dir":"Articles","previous_headings":"","what":"Basic Retention Time Adjustment Plot","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) # ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-filterfile-1","dir":"Articles","previous_headings":"","what":"With filterFile()","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-subset-parameter","dir":"Articles","previous_headings":"","what":"With subset Parameter","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"without-subset-parameter-all-samples-1","dir":"Articles","previous_headings":"","what":"Without subset Parameter (All Samples)","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"XCMS GitHub Repository: https://github.com/sneumann/xcms Original Feature Request: https://github.com/sneumann/xcms/issues/551 faahKO package: Bioconductor example dataset ggplot2 Documentation: https://ggplot2.tidyverse.org/ plotly R: https://plotly.com/r/","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Chromatographic Peaks","text":"vignette demonstrates three ggplot2-based functions visualizing chromatographic peaks LC-MS metabolomics data: gplotChromPeaks(): Visualize detected peaks rectangles RT vs m/z space gplotChromPeakImage(): Heatmap showing peak density across samples retention time ghighlightChromPeaks(): Add peak annotations existing chromatogram plots functions work XcmsExperiment (XCMS v4+) XCMSnExp (XCMS v3) objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Chromatographic Peaks","text":"","code":"library(xcms) library(ggplot2) library(plotly) library(faahKO) library(MsExperiment) library(BiocParallel) library(xcmsVis)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Chromatographic Peaks","text":"‚Äôll use faahKO package example data:","code":"# Get example CDF files cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                   recursive = TRUE, full.names = TRUE)[1:3]  # Load data as XcmsExperiment xdata <- readMsExperiment(   spectraFiles = cdf_files,   BPPARAM = SerialParam() )  # Add sample metadata sampleData(xdata)$sample_name <- basename(cdf_files) sampleData(xdata)$sample_group <- c(\"KO\", \"KO\", \"WT\") # Detect peaks using CentWave algorithm cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Check number of peaks detected cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 6535"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"peak-detection","dir":"Articles","previous_headings":"","what":"Peak Detection","title":"Visualizing Chromatographic Peaks","text":"","code":"# Detect peaks using CentWave algorithm cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Check number of peaks detected cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 6535"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeaks-peak-distribution-visualization","dir":"Articles","previous_headings":"","what":"gplotChromPeaks: Peak Distribution Visualization","title":"Visualizing Chromatographic Peaks","text":"gplotChromPeaks() function creates scatter plot showing detected peaks rectangles retention time vs m/z space.","code":"# ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1) # Customize colors and styling p1 +   labs(     title = \"Detected Peaks - Sample 1\",     x = \"Retention Time (s)\",     y = \"m/z\"   ) +   theme_minimal() # Focus on a specific RT and m/z region p2 <- gplotChromPeaks(   xdata,   file = 1,   xlim = c(3500,3800),    ylim = c(240,260),   border = \"darkblue\",   fill = \"lightblue\" ) print(p2) # Compare peak distributions across samples library(patchwork) p_s1 <- gplotChromPeaks(xdata, file = 1) + labs(title = \"Sample 1 (KO)\") p_s2 <- gplotChromPeaks(xdata, file = 2) + labs(title = \"Sample 2 (KO)\") p_s3 <- gplotChromPeaks(xdata, file = 3) + labs(title = \"Sample 3 (WT)\")  p_s1 + p_s2 + p_s3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"customizing-the-plot","dir":"Articles","previous_headings":"","what":"Customizing the Plot","title":"Visualizing Chromatographic Peaks","text":"","code":"# Customize colors and styling p1 +   labs(     title = \"Detected Peaks - Sample 1\",     x = \"Retention Time (s)\",     y = \"m/z\"   ) +   theme_minimal()"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"focusing-on-a-region","dir":"Articles","previous_headings":"","what":"Focusing on a Region","title":"Visualizing Chromatographic Peaks","text":"","code":"# Focus on a specific RT and m/z region p2 <- gplotChromPeaks(   xdata,   file = 1,   xlim = c(3500,3800),    ylim = c(240,260),   border = \"darkblue\",   fill = \"lightblue\" ) print(p2)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"comparing-multiple-samples","dir":"Articles","previous_headings":"","what":"Comparing Multiple Samples","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare peak distributions across samples library(patchwork) p_s1 <- gplotChromPeaks(xdata, file = 1) + labs(title = \"Sample 1 (KO)\") p_s2 <- gplotChromPeaks(xdata, file = 2) + labs(title = \"Sample 2 (KO)\") p_s3 <- gplotChromPeaks(xdata, file = 3) + labs(title = \"Sample 3 (WT)\")  p_s1 + p_s2 + p_s3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeakimage-peak-density-heatmap","dir":"Articles","previous_headings":"","what":"gplotChromPeakImage: Peak Density Heatmap","title":"Visualizing Chromatographic Peaks","text":"gplotChromPeakImage() function creates heatmap showing number detected peaks per sample across retention time bins.    default, gplotChromPeakImage() uses viridis color scale (reversed higher values darker, matching original XCMS behavior). Viridis perceptually uniform colorblind-friendly. can customize color palette suit needs:  can also use ggplot2 color scales:","code":"# ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3) # Compare different bin sizes p_b15 <- gplotChromPeakImage(xdata, binSize = 15) +   labs(title = \"Bin Size: 15s\") p_b30 <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Bin Size: 30s\") p_b60 <- gplotChromPeakImage(xdata, binSize = 60) +   labs(title = \"Bin Size: 60s\")  p_b15 + p_b30 + p_b60 # Compare linear vs log scale p_linear <- gplotChromPeakImage(xdata, log_transform = FALSE) +   labs(title = \"Linear Scale\") p_log <- gplotChromPeakImage(xdata, log_transform = TRUE) +   labs(title = \"Log2 Scale\")  p_linear + p_log # Different viridis palettes p_magma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"magma\", direction = -1, name = \"count\") +   labs(title = \"Magma palette\")  p_plasma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"plasma\", direction = -1, name = \"count\") +   labs(title = \"Plasma palette\")  p_inferno <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"inferno\", direction = -1, name = \"count\") +   labs(title = \"Inferno palette\")  p_magma / p_plasma / p_inferno # Custom gradient p_gradient <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_gradient(low = \"white\", high = \"darkblue\", name = \"count\") +   labs(title = \"Custom gradient\")  # Color Brewer palette p_brewer <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_distiller(palette = \"RdYlBu\", name = \"count\") +   labs(title = \"RdYlBu palette\")  p_gradient + p_brewer # Make it interactive ggplotly(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"basic-usage-1","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"with-different-bin-sizes","dir":"Articles","previous_headings":"","what":"With Different Bin Sizes","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare different bin sizes p_b15 <- gplotChromPeakImage(xdata, binSize = 15) +   labs(title = \"Bin Size: 15s\") p_b30 <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Bin Size: 30s\") p_b60 <- gplotChromPeakImage(xdata, binSize = 60) +   labs(title = \"Bin Size: 60s\")  p_b15 + p_b30 + p_b60"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"log-transformed-view","dir":"Articles","previous_headings":"","what":"Log-Transformed View","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare linear vs log scale p_linear <- gplotChromPeakImage(xdata, log_transform = FALSE) +   labs(title = \"Linear Scale\") p_log <- gplotChromPeakImage(xdata, log_transform = TRUE) +   labs(title = \"Log2 Scale\")  p_linear + p_log"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"custom-color-scales","dir":"Articles","previous_headings":"","what":"Custom Color Scales","title":"Visualizing Chromatographic Peaks","text":"default, gplotChromPeakImage() uses viridis color scale (reversed higher values darker, matching original XCMS behavior). Viridis perceptually uniform colorblind-friendly. can customize color palette suit needs:  can also use ggplot2 color scales:","code":"# Different viridis palettes p_magma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"magma\", direction = -1, name = \"count\") +   labs(title = \"Magma palette\")  p_plasma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"plasma\", direction = -1, name = \"count\") +   labs(title = \"Plasma palette\")  p_inferno <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"inferno\", direction = -1, name = \"count\") +   labs(title = \"Inferno palette\")  p_magma / p_plasma / p_inferno # Custom gradient p_gradient <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_gradient(low = \"white\", high = \"darkblue\", name = \"count\") +   labs(title = \"Custom gradient\")  # Color Brewer palette p_brewer <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_distiller(palette = \"RdYlBu\", name = \"count\") +   labs(title = \"RdYlBu palette\")  p_gradient + p_brewer"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"interactive-version","dir":"Articles","previous_headings":"","what":"Interactive Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Make it interactive ggplotly(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"chromatogram-plotting-gplot-and-ghighlightchrompeaks","dir":"Articles","previous_headings":"","what":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","title":"Visualizing Chromatographic Peaks","text":"xcmsVis provides two approaches plotting chromatograms: gplot(XChromatogram) - Complete chromatogram plot detected peaks automatically marked (equivalent plot()) ghighlightChromPeaks() - Composable layers adding peak annotations existing plots First, let‚Äôs extract chromatogram specific m/z range:  control, ghighlightChromPeaks() returns ggplot2 layers can added chromatogram plot:  ghighlightChromPeaks() function, like original XCMS highlightChromPeaks(), takes full XcmsExperiment XCMSnExp object searches peaks across samples. can sometimes lead unexpected behavior peaks multiple samples appear single chromatogram plot. extract chromatogram visualization chromatogram(xdata, mz = ...), ‚Äôre typically looking data specific sample. However, ghighlightChromPeaks(xdata, ...) highlight peaks samples dataset match specified rt/mz ranges - just peaks sample shown chromatogram. cleaner visualization shows peaks chromatogram‚Äôs sample, filter XcmsExperiment object first using filterFile():  filtered approach ensures peaks detected specific sample highlighted, typically produces cleaner interpretable visualizations.  polygon visualization type follows actual peak shape chromatogram data:","code":"# Extract chromatogram for m/z 200-210 mz_range <- c(200, 210) rt_range <- c(2500, 3500)  # Get chromatogram data chr <- chromatogram(xdata, mz = mz_range, rt = rt_range) # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\") # Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles # Note: Like the original highlightChromPeaks(), this function takes the full # XcmsExperiment object and searches ALL peaks across ALL samples that match # the rt/mz range. This means peaks from other samples may also appear! peak_layers <- ghighlightChromPeaks(                                     xdata,                                     rt = rt_range,                                     mz = mz_range,                                     type = \"rect\",                                     border = \"red\",                                     fill = alpha(\"red\", 0.2)                                     )  # Combine base plot with peak annotations p_chrom + peak_layers # Without filtering: shows peaks from ALL samples p_all <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"red\",                        fill = alpha(\"red\", 0.2)) +   labs(title = \"All Samples (may show extra peaks)\",        x = \"RT (s)\", y = \"Intensity\")  # With filtering: shows only peaks from sample 1 xdata_filtered <- filterFile(xdata, 1) p_filtered <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.2)) +   labs(title = \"Single Sample (sample 1 only)\",        x = \"RT (s)\", y = \"Intensity\")  # Show side by side library(patchwork) p_all + p_filtered # Use filtered data for cleaner visualization xdata_filtered <- filterFile(xdata, 1)  # Type: Rectangle (default) p_rect <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Rectangles\", x = \"RT (s)\", y = \"Intensity\") peak_rects <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"rect\",   border = \"red\",   fill = alpha(\"red\", 0.2) )  # Type: Point (marks peak apex) p_point <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Points\", x = \"RT (s)\", y = \"Intensity\") peak_points <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"point\",   border = \"red\" )  # Type: Polygon (follows peak shape) p_poly <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Polygons\", x = \"RT (s)\", y = \"Intensity\")   peak_polygons <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"polygon\",   border = \"blue\",   fill = alpha(\"blue\", 0.3) )  # Display all three types (p_rect + peak_rects) / (p_point + peak_points) / (p_poly + peak_polygons) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\") # whichPeaks: \"any\" - peaks that overlap the range p_any <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'any'\", x = \"RT (s)\", y = \"Intensity\")  peaks_any <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"any\", border = \"red\", fill = alpha(\"red\", 0.2) )  # whichPeaks: \"within\" - peaks fully within the range p_within <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_within <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"within\", border = \"blue\", fill = alpha(\"blue\", 0.2) )  # whichPeaks: \"apex_within\" - peaks with apex in range p_apex <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'apex_within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_apex <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"apex_within\", border = \"green\", fill = alpha(\"green\", 0.2) )  # Display comparison (p_any + peaks_any) / (p_within + peaks_within) / (p_apex + peaks_apex)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplot-automatic-chromatogram-plotting","dir":"Articles","previous_headings":"","what":"gplot(): Automatic Chromatogram Plotting","title":"Visualizing Chromatographic Peaks","text":"First, let‚Äôs extract chromatogram specific m/z range:","code":"# Extract chromatogram for m/z 200-210 mz_range <- c(200, 210) rt_range <- c(2500, 3500)  # Get chromatogram data chr <- chromatogram(xdata, mz = mz_range, rt = rt_range) # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"ghighlightchrompeaks-composable-layers","dir":"Articles","previous_headings":"","what":"ghighlightChromPeaks(): Composable Layers","title":"Visualizing Chromatographic Peaks","text":"control, ghighlightChromPeaks() returns ggplot2 layers can added chromatogram plot:","code":"# Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles # Note: Like the original highlightChromPeaks(), this function takes the full # XcmsExperiment object and searches ALL peaks across ALL samples that match # the rt/mz range. This means peaks from other samples may also appear! peak_layers <- ghighlightChromPeaks(                                     xdata,                                     rt = rt_range,                                     mz = mz_range,                                     type = \"rect\",                                     border = \"red\",                                     fill = alpha(\"red\", 0.2)                                     )  # Combine base plot with peak annotations p_chrom + peak_layers"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"understanding-peak-highlighting-behavior","dir":"Articles","previous_headings":"","what":"Understanding Peak Highlighting Behavior","title":"Visualizing Chromatographic Peaks","text":"ghighlightChromPeaks() function, like original XCMS highlightChromPeaks(), takes full XcmsExperiment XCMSnExp object searches peaks across samples. can sometimes lead unexpected behavior peaks multiple samples appear single chromatogram plot. extract chromatogram visualization chromatogram(xdata, mz = ...), ‚Äôre typically looking data specific sample. However, ghighlightChromPeaks(xdata, ...) highlight peaks samples dataset match specified rt/mz ranges - just peaks sample shown chromatogram. cleaner visualization shows peaks chromatogram‚Äôs sample, filter XcmsExperiment object first using filterFile():  filtered approach ensures peaks detected specific sample highlighted, typically produces cleaner interpretable visualizations.","code":"# Without filtering: shows peaks from ALL samples p_all <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"red\",                        fill = alpha(\"red\", 0.2)) +   labs(title = \"All Samples (may show extra peaks)\",        x = \"RT (s)\", y = \"Intensity\")  # With filtering: shows only peaks from sample 1 xdata_filtered <- filterFile(xdata, 1) p_filtered <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.2)) +   labs(title = \"Single Sample (sample 1 only)\",        x = \"RT (s)\", y = \"Intensity\")  # Show side by side library(patchwork) p_all + p_filtered"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"why-this-might-be-confusing","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"Why This Might Be Confusing","title":"Visualizing Chromatographic Peaks","text":"extract chromatogram visualization chromatogram(xdata, mz = ...), ‚Äôre typically looking data specific sample. However, ghighlightChromPeaks(xdata, ...) highlight peaks samples dataset match specified rt/mz ranges - just peaks sample shown chromatogram.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"solution-filter-to-a-single-sample","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"Solution: Filter to a Single Sample","title":"Visualizing Chromatographic Peaks","text":"cleaner visualization shows peaks chromatogram‚Äôs sample, filter XcmsExperiment object first using filterFile():  filtered approach ensures peaks detected specific sample highlighted, typically produces cleaner interpretable visualizations.","code":"# Without filtering: shows peaks from ALL samples p_all <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"red\",                        fill = alpha(\"red\", 0.2)) +   labs(title = \"All Samples (may show extra peaks)\",        x = \"RT (s)\", y = \"Intensity\")  # With filtering: shows only peaks from sample 1 xdata_filtered <- filterFile(xdata, 1) p_filtered <- gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"rect\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.2)) +   labs(title = \"Single Sample (sample 1 only)\",        x = \"RT (s)\", y = \"Intensity\")  # Show side by side library(patchwork) p_all + p_filtered"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"different-visualization-types","dir":"Articles","previous_headings":"","what":"Different Visualization Types","title":"Visualizing Chromatographic Peaks","text":"polygon visualization type follows actual peak shape chromatogram data:","code":"# Use filtered data for cleaner visualization xdata_filtered <- filterFile(xdata, 1)  # Type: Rectangle (default) p_rect <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Rectangles\", x = \"RT (s)\", y = \"Intensity\") peak_rects <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"rect\",   border = \"red\",   fill = alpha(\"red\", 0.2) )  # Type: Point (marks peak apex) p_point <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Points\", x = \"RT (s)\", y = \"Intensity\") peak_points <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"point\",   border = \"red\" )  # Type: Polygon (follows peak shape) p_poly <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Polygons\", x = \"RT (s)\", y = \"Intensity\")   peak_polygons <- ghighlightChromPeaks(   xdata_filtered,   rt = rt_range,   mz = mz_range,   type = \"polygon\",   border = \"blue\",   fill = alpha(\"blue\", 0.3) )  # Display all three types (p_rect + peak_rects) / (p_point + peak_points) / (p_poly + peak_polygons) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"polygon-peak-highlighting","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"Polygon Peak Highlighting","title":"Visualizing Chromatographic Peaks","text":"polygon visualization type follows actual peak shape chromatogram data:","code":"gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"peak-selection-criteria","dir":"Articles","previous_headings":"","what":"Peak Selection Criteria","title":"Visualizing Chromatographic Peaks","text":"","code":"# whichPeaks: \"any\" - peaks that overlap the range p_any <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'any'\", x = \"RT (s)\", y = \"Intensity\")  peaks_any <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"any\", border = \"red\", fill = alpha(\"red\", 0.2) )  # whichPeaks: \"within\" - peaks fully within the range p_within <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_within <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"within\", border = \"blue\", fill = alpha(\"blue\", 0.2) )  # whichPeaks: \"apex_within\" - peaks with apex in range p_apex <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'apex_within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_apex <- ghighlightChromPeaks(   xdata_filtered, rt = rt_range, mz = mz_range,   whichPeaks = \"apex_within\", border = \"green\", fill = alpha(\"green\", 0.2) )  # Display comparison (p_any + peaks_any) / (p_within + peaks_within) / (p_apex + peaks_apex)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"combining-multiple-visualizations","dir":"Articles","previous_headings":"","what":"Combining Multiple Visualizations","title":"Visualizing Chromatographic Peaks","text":"can combine functions create comprehensive peak detection summaries:","code":"# Peak distribution for one sample p_dist <- gplotChromPeaks(xdata, file = 1) +   labs(title = \"Peak Distribution - Sample 1\")  # Peak density across all samples p_density <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Peak Density Across Samples\")  # Combine p_dist / p_density"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualizing Chromatographic Peaks","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] patchwork_1.3.2     xcmsVis_0.99.15     MsExperiment_1.12.0 #> [4] ProtGenerics_1.42.0 faahKO_1.50.0       plotly_4.11.0       #> [7] ggplot2_4.0.0       xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0      #>  [13] crayon_1.5.3                fastmap_1.2.0               #>  [15] XVector_0.50.0              labeling_0.4.3              #>  [17] rmarkdown_2.30              preprocessCore_1.72.0       #>  [19] purrr_1.2.0                 xfun_0.54                   #>  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0              #>  [23] progress_1.2.3              DelayedArray_0.36.0         #>  [25] parallel_4.5.2              prettyunits_1.2.0           #>  [27] cluster_2.1.8.1             R6_2.6.1                    #>  [29] stringi_1.8.7               RColorBrewer_1.1-3          #>  [31] limma_3.66.0                GenomicRanges_1.62.0        #>  [33] Rcpp_1.1.0                  Seqinfo_1.0.0               #>  [35] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [37] knitr_1.50                  IRanges_2.44.0              #>  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4                #>  [41] igraph_2.2.1                tidyselect_1.2.1            #>  [43] abind_1.4-8                 yaml_2.3.10                 #>  [45] doParallel_1.0.17           codetools_0.2-20            #>  [47] affy_1.88.0                 lattice_0.22-7              #>  [49] tibble_3.3.0                plyr_1.8.9                  #>  [51] Biobase_2.70.0              withr_3.0.2                 #>  [53] S7_0.2.0                    evaluate_1.0.5              #>  [55] Spectra_1.20.0              pillar_1.11.1               #>  [57] affyio_1.80.0               BiocManager_1.30.26         #>  [59] MatrixGenerics_1.22.0       foreach_1.5.2               #>  [61] stats4_4.5.2                MSnbase_2.36.0              #>  [63] MALDIquant_1.22.3           ncdf4_1.24                  #>  [65] generics_0.1.4              S4Vectors_0.48.0            #>  [67] hms_1.1.4                   scales_1.4.0                #>  [69] glue_1.8.0                  MsFeatures_1.18.0           #>  [71] lazyeval_0.2.2              tools_4.5.2                 #>  [73] mzID_1.48.0                 data.table_1.17.8           #>  [75] QFeatures_1.20.0            vsn_3.78.0                  #>  [77] mzR_2.44.0                  fs_1.6.6                    #>  [79] XML_3.99-0.19               grid_4.5.2                  #>  [81] impute_1.84.0               tidyr_1.3.1                 #>  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [85] PSMatch_1.14.0              cli_3.6.5                   #>  [87] viridisLite_0.4.2           S4Arrays_1.10.0             #>  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0     #>  [91] pcaMethods_2.2.0            gtable_0.3.6                #>  [93] digest_0.6.37               BiocGenerics_0.56.0         #>  [95] SparseArray_1.10.1          htmlwidgets_1.6.4           #>  [97] farver_2.1.2                htmltools_0.5.8.1           #>  [99] lifecycle_1.0.4             httr_1.4.7                  #> [101] statmod_1.5.1               MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"supplementary-comparison-with-original-xcms","dir":"Articles","previous_headings":"","what":"Supplementary: Comparison with Original XCMS","title":"Visualizing Chromatographic Peaks","text":"supplementary section provides side--side comparisons original XCMS plotting functions new xcmsVis ggplot2-based implementations. comparisons useful developers users migrating original XCMS plotting functions.","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) # ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1) # Base R graphics version plotChromPeakImage(xdata, binSize = 30) # ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3) # Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\") # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\") # Base R graphics version - plot then add highlights # Note: Original highlightChromPeaks searches ALL peaks in xdata across all files # that match the rt/mz range, so it may show more peaks than just this one chromatogram plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     border = \"red\",                     col = adjustcolor(\"red\", alpha.f = 0.2)                    ) # Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(                                     xdata,                                     rt = rt_range,                                     mz = mz_range,                                     type = \"rect\",                                     border = \"red\",                                     fill = alpha(\"red\", 0.2)                                     )  # Combine base plot with peak annotations p_chrom + peak_layers plot(chr[1, 1], main = \"XCMS Polygon Highlighting\") highlightChromPeaks(as(xdata_filtered, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     type = \"polygon\",                     border = \"blue\",                     col = adjustcolor(\"blue\", alpha.f = 0.3)) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeaks-peak-distribution-visualization-1","dir":"Articles","previous_headings":"","what":"gplotChromPeaks: Peak Distribution Visualization","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) # ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeakimage-peak-density-heatmap-1","dir":"Articles","previous_headings":"","what":"gplotChromPeakImage: Peak Density Heatmap","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeakImage(xdata, binSize = 30) # ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeakImage(xdata, binSize = 30)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotxchromatogram-automatic-chromatogram-plotting","dir":"Articles","previous_headings":"","what":"gplot(XChromatogram): Automatic Chromatogram Plotting","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\") # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"ghighlightchrompeaks-composable-layers-1","dir":"Articles","previous_headings":"","what":"ghighlightChromPeaks(): Composable Layers","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot then add highlights # Note: Original highlightChromPeaks searches ALL peaks in xdata across all files # that match the rt/mz range, so it may show more peaks than just this one chromatogram plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     border = \"red\",                     col = adjustcolor(\"red\", alpha.f = 0.2)                    ) # Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(                                     xdata,                                     rt = rt_range,                                     mz = mz_range,                                     type = \"rect\",                                     border = \"red\",                                     fill = alpha(\"red\", 0.2)                                     )  # Combine base plot with peak annotations p_chrom + peak_layers"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-3","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot then add highlights # Note: Original highlightChromPeaks searches ALL peaks in xdata across all files # that match the rt/mz range, so it may show more peaks than just this one chromatogram plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     border = \"red\",                     col = adjustcolor(\"red\", alpha.f = 0.2)                    )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-3","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(                                     xdata,                                     rt = rt_range,                                     mz = mz_range,                                     type = \"rect\",                                     border = \"red\",                                     fill = alpha(\"red\", 0.2)                                     )  # Combine base plot with peak annotations p_chrom + peak_layers"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"polygon-peak-highlighting-comparison","dir":"Articles","previous_headings":"","what":"Polygon Peak Highlighting Comparison","title":"Visualizing Chromatographic Peaks","text":"","code":"plot(chr[1, 1], main = \"XCMS Polygon Highlighting\") highlightChromPeaks(as(xdata_filtered, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     type = \"polygon\",                     border = \"blue\",                     col = adjustcolor(\"blue\", alpha.f = 0.3)) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Original XCMS","title":"Visualizing Chromatographic Peaks","text":"","code":"plot(chr[1, 1], main = \"XCMS Polygon Highlighting\") highlightChromPeaks(as(xdata_filtered, \"XCMSnExp\"),                     rt = rt_range,                     mz = mz_range,                     type = \"polygon\",                     border = \"blue\",                     col = adjustcolor(\"blue\", alpha.f = 0.3))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-4","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered,                        rt = rt_range,                        mz = mz_range,                        type = \"polygon\",                        border = \"blue\",                        fill = alpha(\"blue\", 0.3)) +   labs(title = \"xcmsVis Polygon Highlighting\",        x = \"Retention Time (s)\",        y = \"Intensity\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Visualizing Chromatographic Peaks","text":"XCMS GitHub Repository: https://github.com/sneumann/xcms Original Feature Request: https://github.com/sneumann/xcms/issues/551 faahKO package: Bioconductor example dataset ggplot2 Documentation: https://ggplot2.tidyverse.org/ plotly R: https://plotly.com/r/","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing XcmsExperiment MS Data","text":"vignette demonstrates gplot() function visualizing XcmsExperiment XCMSnExp objects. gplot() method creates two-panel visualization showing: Upper panel: Base Peak Intensity (BPI) chromatogram vs retention time Lower panel: m/z vs retention time scatter plot panels use intensity-based coloring highlight signal strength, detected peaks automatically overlaid rectangles. ggplot2 reimplementation XCMS‚Äôs plot() method MsExperiment objects, enabling modern visualization capabilities including: Interactive plots plotly Customizable color schemes Easy composition patchwork Publication-quality graphics","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing XcmsExperiment MS Data","text":"","code":"library(xcms) library(xcmsVis) library(ggplot2) library(plotly) library(patchwork)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing XcmsExperiment MS Data","text":"‚Äôll use pre-processed test data XCMS demonstration: visualization purposes, ‚Äôll filter specific retention time m/z region:","code":"# Load pre-processed data with detected peaks xdata <- loadXcmsData(\"faahko_sub2\")  # Check data cat(\"Samples:\", length(xdata), \"\\n\") #> Samples: 3 cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 248 # Filter to focused region mse <- filterRt(xdata, rt = c(2500, 2800)) mse <- filterMzRange(mse, mz = c(218, 220.5))  cat(\"Filtered data:\\n\") #> Filtered data: cat(\"  RT range:\", paste(range(rtime(spectra(mse[1]))), collapse = \" - \"), \"\\n\") #>   RT range: 2501.378 - 2798.719 cat(\"  Number of spectra in sample 1:\", length(spectra(mse[1])), \"\\n\") #>   Number of spectra in sample 1: 191"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing XcmsExperiment MS Data","text":"basic usage plot single sample:  visualization consists two complementary views: Base Peak Intensity (BPI) shows maximum intensity retention time across m/z values filtered range. gives overview signals present chromatogram. point represents one retention time Y-axis shows maximum intensity observed time Color indicates intensity magnitude Useful identifying retention time regions strong signals m/z vs retention time scatter shows complete mass spectral data: X-axis: retention time Y-axis: m/z values point represents one data point raw spectra Color indicates intensity specific m/z retention time Shows full two-dimensional structure LC-MS data chromatographic peaks detected (via findChromPeaks()), automatically overlaid rectangles showing: Peak retention time boundaries (left/right edges) Peak m/z boundaries (top/bottom edges) Semi-transparent red color default","code":"gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"single-sample-visualization","dir":"Articles","previous_headings":"","what":"Single Sample Visualization","title":"Visualizing XcmsExperiment MS Data","text":"basic usage plot single sample:","code":"gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"understanding-the-two-panels","dir":"Articles","previous_headings":"","what":"Understanding the Two Panels","title":"Visualizing XcmsExperiment MS Data","text":"visualization consists two complementary views: Base Peak Intensity (BPI) shows maximum intensity retention time across m/z values filtered range. gives overview signals present chromatogram. point represents one retention time Y-axis shows maximum intensity observed time Color indicates intensity magnitude Useful identifying retention time regions strong signals m/z vs retention time scatter shows complete mass spectral data: X-axis: retention time Y-axis: m/z values point represents one data point raw spectra Color indicates intensity specific m/z retention time Shows full two-dimensional structure LC-MS data chromatographic peaks detected (via findChromPeaks()), automatically overlaid rectangles showing: Peak retention time boundaries (left/right edges) Peak m/z boundaries (top/bottom edges) Semi-transparent red color default","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"upper-panel-bpi-chromatogram","dir":"Articles","previous_headings":"Basic Usage","what":"Upper Panel: BPI Chromatogram","title":"Visualizing XcmsExperiment MS Data","text":"Base Peak Intensity (BPI) shows maximum intensity retention time across m/z values filtered range. gives overview signals present chromatogram. point represents one retention time Y-axis shows maximum intensity observed time Color indicates intensity magnitude Useful identifying retention time regions strong signals","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"lower-panel-mz-vs-rt-scatter","dir":"Articles","previous_headings":"Basic Usage","what":"Lower Panel: m/z vs RT Scatter","title":"Visualizing XcmsExperiment MS Data","text":"m/z vs retention time scatter shows complete mass spectral data: X-axis: retention time Y-axis: m/z values point represents one data point raw spectra Color indicates intensity specific m/z retention time Shows full two-dimensional structure LC-MS data","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"peak-overlays","dir":"Articles","previous_headings":"Basic Usage","what":"Peak Overlays","title":"Visualizing XcmsExperiment MS Data","text":"chromatographic peaks detected (via findChromPeaks()), automatically overlaid rectangles showing: Peak retention time boundaries (left/right edges) Peak m/z boundaries (top/bottom edges) Semi-transparent red color default","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"multiple-samples","dir":"Articles","previous_headings":"","what":"Multiple Samples","title":"Visualizing XcmsExperiment MS Data","text":"visualizing multiple samples, gplot() creates vertically stacked layout:  sample gets two-panel visualization, making easy compare across samples.","code":"# Plot all three samples gplot(mse)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"customization","dir":"Articles","previous_headings":"","what":"Customization","title":"Visualizing XcmsExperiment MS Data","text":"can customize line colors peak colors:  intensity coloring uses color ramp function. can use R color ramp:  Color Scale Direction MS data, ‚Äôs conventional low intensity = dark high intensity = bright. viridis scales reversed (rev(viridis(n))) follow convention, : Dark purple/black = low intensity (noise, baseline) Bright yellow = high intensity (strong signals) makes easier identify strong signals glance. viridisLite package provides several perceptually-uniform color scales:  Choosing palette: Viridis: Good general-purpose, colorblind-friendly Magma: High contrast, good presentations Plasma: Vibrant, good highlighting features Inferno: Warm colors, good print viridis palettes : - Perceptually uniform (equal steps appear equal) - Colorblind-friendly - Print-friendly (grayscale conversion works well) Provide custom titles sample:  Customize point shape using standard R pch values:","code":"gplot(mse[1],       col = \"blue\",           # Point border color       peakCol = \"red\")        # Peak rectangle color # Default: topo.colors p1 <- gplot(mse[1]) +   ggtitle(\"topo.colors (default)\")  # Viridis (reversed for low=dark, high=bright) library(viridisLite) viridis_rev <- function(n) rev(viridis(n)) p2 <- gplot(mse[1], colramp = viridis_rev) +   ggtitle(\"viridis (reversed)\")  # Magma (reversed) magma_rev <- function(n) rev(magma(n)) p3 <- gplot(mse[1], colramp = magma_rev) +   ggtitle(\"magma (reversed)\")  (p1 | p2 | p3) library(viridisLite)  # Create reversed versions for MS convention viridis_rev <- function(n) rev(viridis(n)) magma_rev <- function(n) rev(magma(n)) plasma_rev <- function(n) rev(plasma(n)) inferno_rev <- function(n) rev(inferno(n))  p1 <- gplot(mse[1], colramp = viridis_rev) + ggtitle(\"Viridis\") p2 <- gplot(mse[1], colramp = magma_rev) + ggtitle(\"Magma\") p3 <- gplot(mse[1], colramp = plasma_rev) + ggtitle(\"Plasma\") p4 <- gplot(mse[1], colramp = inferno_rev) + ggtitle(\"Inferno\")  (p1 | p2) / (p3 | p4) # Custom sample names gplot(mse, main = c(\"Knockout 1\", \"Knockout 2\", \"Wild Type\")) p1 <- gplot(mse[1], pch = 21) + ggtitle(\"Filled circles (pch = 21)\") p2 <- gplot(mse[1], pch = 22) + ggtitle(\"Filled squares (pch = 22)\")  p1 | p2"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"custom-colors","dir":"Articles","previous_headings":"","what":"Custom Colors","title":"Visualizing XcmsExperiment MS Data","text":"can customize line colors peak colors:","code":"gplot(mse[1],       col = \"blue\",           # Point border color       peakCol = \"red\")        # Peak rectangle color"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"custom-color-ramps","dir":"Articles","previous_headings":"","what":"Custom Color Ramps","title":"Visualizing XcmsExperiment MS Data","text":"intensity coloring uses color ramp function. can use R color ramp:  Color Scale Direction MS data, ‚Äôs conventional low intensity = dark high intensity = bright. viridis scales reversed (rev(viridis(n))) follow convention, : Dark purple/black = low intensity (noise, baseline) Bright yellow = high intensity (strong signals) makes easier identify strong signals glance. viridisLite package provides several perceptually-uniform color scales:  Choosing palette: Viridis: Good general-purpose, colorblind-friendly Magma: High contrast, good presentations Plasma: Vibrant, good highlighting features Inferno: Warm colors, good print viridis palettes : - Perceptually uniform (equal steps appear equal) - Colorblind-friendly - Print-friendly (grayscale conversion works well)","code":"# Default: topo.colors p1 <- gplot(mse[1]) +   ggtitle(\"topo.colors (default)\")  # Viridis (reversed for low=dark, high=bright) library(viridisLite) viridis_rev <- function(n) rev(viridis(n)) p2 <- gplot(mse[1], colramp = viridis_rev) +   ggtitle(\"viridis (reversed)\")  # Magma (reversed) magma_rev <- function(n) rev(magma(n)) p3 <- gplot(mse[1], colramp = magma_rev) +   ggtitle(\"magma (reversed)\")  (p1 | p2 | p3) library(viridisLite)  # Create reversed versions for MS convention viridis_rev <- function(n) rev(viridis(n)) magma_rev <- function(n) rev(magma(n)) plasma_rev <- function(n) rev(plasma(n)) inferno_rev <- function(n) rev(inferno(n))  p1 <- gplot(mse[1], colramp = viridis_rev) + ggtitle(\"Viridis\") p2 <- gplot(mse[1], colramp = magma_rev) + ggtitle(\"Magma\") p3 <- gplot(mse[1], colramp = plasma_rev) + ggtitle(\"Plasma\") p4 <- gplot(mse[1], colramp = inferno_rev) + ggtitle(\"Inferno\")  (p1 | p2) / (p3 | p4)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"more-viridis-palettes","dir":"Articles","previous_headings":"Customization","what":"More Viridis Palettes","title":"Visualizing XcmsExperiment MS Data","text":"viridisLite package provides several perceptually-uniform color scales:  Choosing palette: Viridis: Good general-purpose, colorblind-friendly Magma: High contrast, good presentations Plasma: Vibrant, good highlighting features Inferno: Warm colors, good print viridis palettes : - Perceptually uniform (equal steps appear equal) - Colorblind-friendly - Print-friendly (grayscale conversion works well)","code":"library(viridisLite)  # Create reversed versions for MS convention viridis_rev <- function(n) rev(viridis(n)) magma_rev <- function(n) rev(magma(n)) plasma_rev <- function(n) rev(plasma(n)) inferno_rev <- function(n) rev(inferno(n))  p1 <- gplot(mse[1], colramp = viridis_rev) + ggtitle(\"Viridis\") p2 <- gplot(mse[1], colramp = magma_rev) + ggtitle(\"Magma\") p3 <- gplot(mse[1], colramp = plasma_rev) + ggtitle(\"Plasma\") p4 <- gplot(mse[1], colramp = inferno_rev) + ggtitle(\"Inferno\")  (p1 | p2) / (p3 | p4)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"custom-titles","dir":"Articles","previous_headings":"","what":"Custom Titles","title":"Visualizing XcmsExperiment MS Data","text":"Provide custom titles sample:","code":"# Custom sample names gplot(mse, main = c(\"Knockout 1\", \"Knockout 2\", \"Wild Type\"))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"point-styles","dir":"Articles","previous_headings":"","what":"Point Styles","title":"Visualizing XcmsExperiment MS Data","text":"Customize point shape using standard R pch values:","code":"p1 <- gplot(mse[1], pch = 21) + ggtitle(\"Filled circles (pch = 21)\") p2 <- gplot(mse[1], pch = 22) + ggtitle(\"Filled squares (pch = 22)\")  p1 | p2"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"interactive-visualization","dir":"Articles","previous_headings":"","what":"Interactive Visualization","title":"Visualizing XcmsExperiment MS Data","text":"Convert interactive plotly data exploration: interactive version allows : Hover points see exact values Zoom regions interest Pan explore different areas Toggle legend items focus specific features gplot() returns patchwork object, ggplotly() converts last panel interactive. access individual panels interactive conversion, use list indexing: approach gives full interactive control panel separately, can useful want : Examine BPI chromatogram detail Zoom specific m/z regions scatter plot Export individual panels interactive HTML widgets Note: patchwork objects multiple samples, use p[[]] access sample‚Äôs plot, sample number. sample plot contains two panels can accessed p[[]][[j]] j 1 BPI 2 m/z scatter.","code":"# Create static ggplot p <- gplot(mse[1])  # Convert to interactive plotly ggplotly(p) # Create the plot p <- gplot(mse[1])  # Access and convert individual panels ggplotly(p[[1]])  # Upper panel (BPI chromatogram) - interactive ggplotly(p[[2]])  # Lower panel (m/z scatter) - interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"accessing-individual-panels","dir":"Articles","previous_headings":"","what":"Accessing Individual Panels","title":"Visualizing XcmsExperiment MS Data","text":"gplot() returns patchwork object, ggplotly() converts last panel interactive. access individual panels interactive conversion, use list indexing: approach gives full interactive control panel separately, can useful want : Examine BPI chromatogram detail Zoom specific m/z regions scatter plot Export individual panels interactive HTML widgets Note: patchwork objects multiple samples, use p[[]] access sample‚Äôs plot, sample number. sample plot contains two panels can accessed p[[]][[j]] j 1 BPI 2 m/z scatter.","code":"# Create the plot p <- gplot(mse[1])  # Access and convert individual panels ggplotly(p[[1]])  # Upper panel (BPI chromatogram) - interactive ggplotly(p[[2]])  # Lower panel (m/z scatter) - interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"advanced-workflows","dir":"Articles","previous_headings":"","what":"Advanced Workflows","title":"Visualizing XcmsExperiment MS Data","text":"example uses data MetaboLights (MTBLS8735) contains MS1 MS2 data: demonstrates gplot() can visualize different MS levels experiment, useful examining fragmentation patterns alongside precursor ions. Combine filtering visualization detailed inspection:  Create comprehensive comparison across samples:","code":"# Load MS2 data from MetaboLights library(MetaboLights) library(MsExperiment)  param <- MetaboLightsParam(mtblsId = \"MTBLS8735\",                            assayName = paste0(\"a_MTBLS8735_LC-MSMS_positive_\",                                             \"hilic_metabolite_profiling.txt\"),                            filePattern = \"MSMS_2_(E|A).*\\\\.mzML\")  lcms2 <- readMsObject(MsExperiment(),                      param,                      keepOntology = FALSE,                      keepProtocol = FALSE,                      simplify = TRUE)  # Filter to a sensible range lcms2_filtered <- filterRt(lcms2, rt = c(50, 150)) lcms2_filtered <- filterMzRange(lcms2_filtered, mz = c(200, 400))  # MS1 data (default) p_ms1 <- gplot(lcms2_filtered[1], msLevel = 1L) + ggtitle(\"MS1\")  # MS2 data p_ms2 <- gplot(lcms2_filtered[1], msLevel = 2L) + ggtitle(\"MS2\")  p_ms1 / p_ms2 # Focus on narrow RT window mse_focused <- filterRt(xdata, rt = c(2700, 2820)) mse_focused <- filterMzRange(mse_focused, mz = c(204, 208))  gplot(mse_focused[1]) +   ggtitle(\"Focused: RT 2700-2820, m/z 204-208\") # Filter to consistent region mse_compare <- filterRt(xdata, rt = c(2600, 2800)) mse_compare <- filterMzRange(mse_compare, mz = c(206, 209))  # Plot all samples with custom titles gplot(mse_compare,       main = c(\"Sample A (KO)\", \"Sample B (KO)\", \"Sample C (WT)\"),       peakCol = \"#ff000080\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"comparing-different-ms-levels","dir":"Articles","previous_headings":"","what":"Comparing Different MS Levels","title":"Visualizing XcmsExperiment MS Data","text":"example uses data MetaboLights (MTBLS8735) contains MS1 MS2 data: demonstrates gplot() can visualize different MS levels experiment, useful examining fragmentation patterns alongside precursor ions.","code":"# Load MS2 data from MetaboLights library(MetaboLights) library(MsExperiment)  param <- MetaboLightsParam(mtblsId = \"MTBLS8735\",                            assayName = paste0(\"a_MTBLS8735_LC-MSMS_positive_\",                                             \"hilic_metabolite_profiling.txt\"),                            filePattern = \"MSMS_2_(E|A).*\\\\.mzML\")  lcms2 <- readMsObject(MsExperiment(),                      param,                      keepOntology = FALSE,                      keepProtocol = FALSE,                      simplify = TRUE)  # Filter to a sensible range lcms2_filtered <- filterRt(lcms2, rt = c(50, 150)) lcms2_filtered <- filterMzRange(lcms2_filtered, mz = c(200, 400))  # MS1 data (default) p_ms1 <- gplot(lcms2_filtered[1], msLevel = 1L) + ggtitle(\"MS1\")  # MS2 data p_ms2 <- gplot(lcms2_filtered[1], msLevel = 2L) + ggtitle(\"MS2\")  p_ms1 / p_ms2"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"focused-region-analysis","dir":"Articles","previous_headings":"","what":"Focused Region Analysis","title":"Visualizing XcmsExperiment MS Data","text":"Combine filtering visualization detailed inspection:","code":"# Focus on narrow RT window mse_focused <- filterRt(xdata, rt = c(2700, 2820)) mse_focused <- filterMzRange(mse_focused, mz = c(204, 208))  gplot(mse_focused[1]) +   ggtitle(\"Focused: RT 2700-2820, m/z 204-208\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"comparing-samples","dir":"Articles","previous_headings":"","what":"Comparing Samples","title":"Visualizing XcmsExperiment MS Data","text":"Create comprehensive comparison across samples:","code":"# Filter to consistent region mse_compare <- filterRt(xdata, rt = c(2600, 2800)) mse_compare <- filterMzRange(mse_compare, mz = c(206, 209))  # Plot all samples with custom titles gplot(mse_compare,       main = c(\"Sample A (KO)\", \"Sample B (KO)\", \"Sample C (WT)\"),       peakCol = \"#ff000080\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"integration-with-other-packages","dir":"Articles","previous_headings":"","what":"Integration with Other Packages","title":"Visualizing XcmsExperiment MS Data","text":"Add additional ggplot2 layers modify themes. Use & operator apply themes panels patchwork object:  Patchwork Operators Since gplot() returns patchwork object (two panels combined), use: & operator apply themes/scales panels + operator add individual layers (may cause issues multi-panel plots) single-panel plots, work. multi-panel patchwork objects, & safer.","code":"gplot(mse[1]) &   theme_minimal() &   theme(     legend.position = \"bottom\",     plot.title = element_text(face = \"bold\", size = 14)   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"custom-ggplot2-modifications","dir":"Articles","previous_headings":"","what":"Custom ggplot2 Modifications","title":"Visualizing XcmsExperiment MS Data","text":"Add additional ggplot2 layers modify themes. Use & operator apply themes panels patchwork object:  Patchwork Operators Since gplot() returns patchwork object (two panels combined), use: & operator apply themes/scales panels + operator add individual layers (may cause issues multi-panel plots) single-panel plots, work. multi-panel patchwork objects, & safer.","code":"gplot(mse[1]) &   theme_minimal() &   theme(     legend.position = \"bottom\",     plot.title = element_text(face = \"bold\", size = 14)   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"use-cases","dir":"Articles","previous_headings":"","what":"Use Cases","title":"Visualizing XcmsExperiment MS Data","text":"Visualize raw MS data check : Signal intensity across retention time Presence expected m/z ranges Peak detection quality Sample--sample consistency  method development, use gplot() : Evaluate extraction efficiency across m/z ranges Optimize retention time windows Assess peak shapes detection Create publication-ready figures custom styling:","code":"# QC check: visualize all samples in a batch gplot(mse, main = paste(\"QC:\", c(\"Sample 1\", \"Sample 2\", \"Sample 3\"))) # Use reversed viridis for conventional MS coloring viridis_rev <- function(n) rev(viridis(n))  gplot(mse[1],       main = \"LC-MS Analysis: Sample KO15\",       col = \"black\",       peakCol = \"#d62728\",       colramp = viridis_rev) +   theme_bw() +   theme(     plot.title = element_text(hjust = 0.5, face = \"bold\"),     text = element_text(size = 12),     legend.position = \"right\"   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"quality-control","dir":"Articles","previous_headings":"","what":"Quality Control","title":"Visualizing XcmsExperiment MS Data","text":"Visualize raw MS data check : Signal intensity across retention time Presence expected m/z ranges Peak detection quality Sample--sample consistency","code":"# QC check: visualize all samples in a batch gplot(mse, main = paste(\"QC:\", c(\"Sample 1\", \"Sample 2\", \"Sample 3\")))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"method-development","dir":"Articles","previous_headings":"","what":"Method Development","title":"Visualizing XcmsExperiment MS Data","text":"method development, use gplot() : Evaluate extraction efficiency across m/z ranges Optimize retention time windows Assess peak shapes detection","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"publication-figures","dir":"Articles","previous_headings":"","what":"Publication Figures","title":"Visualizing XcmsExperiment MS Data","text":"Create publication-ready figures custom styling:","code":"# Use reversed viridis for conventional MS coloring viridis_rev <- function(n) rev(viridis(n))  gplot(mse[1],       main = \"LC-MS Analysis: Sample KO15\",       col = \"black\",       peakCol = \"#d62728\",       colramp = viridis_rev) +   theme_bw() +   theme(     plot.title = element_text(hjust = 0.5, face = \"bold\"),     text = element_text(size = 12),     legend.position = \"right\"   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"performance-considerations","dir":"Articles","previous_headings":"","what":"Performance Considerations","title":"Visualizing XcmsExperiment MS Data","text":"large datasets, consider: Filter first: Use filterRt() filterMzRange() reduce data size Subset samples: Plot one sample time interactive work Static plots: Use static ggplot2 final figures (faster plotly)","code":"# Good: Filter to focused region mse_small <- filterRt(large_data, rt = c(100, 200)) mse_small <- filterMzRange(mse_small, mz = c(200, 300)) gplot(mse_small[1])  # Avoid: Plotting huge unfiltered datasets # gplot(large_data)  # May be slow"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Visualizing XcmsExperiment MS Data","text":"gplot() function XcmsExperiment provides: Two-panel visualization: BPI chromatogram + m/z scatter Automatic peak overlay: Shows detected peaks rectangles Intensity coloring: Highlights signal strength across data Full customization: Colors, themes, point styles Interactivity: Easy conversion plotly Composition: Integrates patchwork ggplot2 ecosystem gplot(XcmsExperiment): Explore raw MS acquisitions, QC, method development gplot(XChromatogram): Analyze specific compounds, peak integration gplotChromPeaks(): Overview detected peaks, retention time distribution gplotChromPeakDensity(): Optimize peak grouping parameters","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"when-to-use-each","dir":"Articles","previous_headings":"","what":"When to Use Each","title":"Visualizing XcmsExperiment MS Data","text":"gplot(XcmsExperiment): Explore raw MS acquisitions, QC, method development gplot(XChromatogram): Analyze specific compounds, peak integration gplotChromPeaks(): Overview detected peaks, retention time distribution gplotChromPeakDensity(): Optimize peak grouping parameters","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"supplementary-comparison-with-original-xcms","dir":"Articles","previous_headings":"","what":"Supplementary: Comparison with Original XCMS","title":"Visualizing XcmsExperiment MS Data","text":"supplementary section provides side--side comparisons original XCMS base R plotting functions new xcmsVis ggplot2-based implementations. comparisons useful developers users migrating original XCMS plotting functions.  Characteristics: - Base R graphics - Fixed styling - Static output - Direct graphics device  Characteristics: - ggplot2 graphics - Fully customizable - Supports interactivity - Returns ggplot object    Shows raw MS data (m/z vs RT) Use : - Exploring raw MS data - Quality control acquisitions - Understanding full spectral information  Shows raw MS data (m/z vs RT) Additional capabilities: - Interactive plotly - Custom color ramps - Theme customization  Shows extracted ion chromatogram (EIC) Use : - Focusing specific m/z - Peak integration - Comparing specific compounds  Shows extracted ion chromatogram (EIC) Additional capabilities: - ggplot2 styling - Easy faceting multiple samples - Interactive tooltips  Fixed vertical stacking  Flexible layout patchwork operators ggplot2 foundation allows seamless conversion interactive plotly plots hover information, zoom, pan capabilities.  Patchwork integration makes trivial create custom layouts comparisons.  Use & operator apply themes consistently across panels patchwork object. users transitioning XCMS plot() xcmsVis gplot(): Use XCMS plot() : - need exact reproduction legacy figures - Working base R graphics pipelines - customization needed Use xcmsVis gplot() : - Creating publication figures custom styling - Building interactive visualizations - Composing complex multi-panel figures - Integrating modern R visualization workflows - Teaching presentations (plotly interactivity)","code":"# Base R graphics version plot(mse[1]) # ggplot2 version gplot(mse[1]) # Base R version with custom colors plot(mse[1], col = \"blue\", peakCol = \"red\") # ggplot2 version with custom colors and theme gplot(mse[1], col = \"blue\", peakCol = \"red\") &   theme_minimal() # Base R version plot(mse[1]) # ggplot2 version gplot(mse[1]) # Base R chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) plot(chr[1, 1]) # ggplot2 chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) gplot(chr[1, 1]) # Base R version - fixed layout plot(mse) # ggplot2 version - flexible with patchwork gplot(mse) # Convert to interactive plotly p <- gplot(mse[1]) ggplotly(p) # Easy side-by-side comparison with patchwork p1 <- gplot(mse[1]) + ggtitle(\"Sample 1\") p2 <- gplot(mse[2]) + ggtitle(\"Sample 2\") p1 | p2 # Apply consistent theme across all plots my_theme <- theme_minimal() +   theme(     plot.title = element_text(face = \"bold\", hjust = 0.5),     legend.position = \"bottom\"   )  gplot(mse[1]) & my_theme # Old XCMS plot(mse[1])  # New xcmsVis gplot(mse[1]) # Old XCMS plot(mse[1], col = \"blue\", peakCol = \"red\")  # New xcmsVis (same syntax) gplot(mse[1], col = \"blue\", peakCol = \"red\") # Old XCMS - must use graphics device pdf(\"plot.pdf\", width = 5, height = 6) plot(mse[1]) dev.off()  # New xcmsVis - save ggplot object p <- gplot(mse[1]) ggsave(\"plot.pdf\", p, width = 5, height = 6) # Old XCMS - limited customization plot(mse[1], col = \"blue\")  # New xcmsVis - full ggplot2 ecosystem gplot(mse[1], col = \"blue\") &   theme_minimal() &   theme(     legend.position = \"bottom\",     plot.title = element_text(face = \"bold\")   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"gplot-vs-plot","dir":"Articles","previous_headings":"","what":"gplot() vs plot()","title":"Visualizing XcmsExperiment MS Data","text":"Characteristics: - Base R graphics - Fixed styling - Static output - Direct graphics device  Characteristics: - ggplot2 graphics - Fully customizable - Supports interactivity - Returns ggplot object","code":"# Base R graphics version plot(mse[1]) # ggplot2 version gplot(mse[1]) # Base R version with custom colors plot(mse[1], col = \"blue\", peakCol = \"red\") # ggplot2 version with custom colors and theme gplot(mse[1], col = \"blue\", peakCol = \"red\") &   theme_minimal()"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"basic-single-sample-plot","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Basic Single Sample Plot","title":"Visualizing XcmsExperiment MS Data","text":"Characteristics: - Base R graphics - Fixed styling - Static output - Direct graphics device  Characteristics: - ggplot2 graphics - Fully customizable - Supports interactivity - Returns ggplot object","code":"# Base R graphics version plot(mse[1]) # ggplot2 version gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcms-plot","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XCMS plot()","title":"Visualizing XcmsExperiment MS Data","text":"Characteristics: - Base R graphics - Fixed styling - Static output - Direct graphics device","code":"# Base R graphics version plot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsvis-gplot","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis gplot()","title":"Visualizing XcmsExperiment MS Data","text":"Characteristics: - ggplot2 graphics - Fully customizable - Supports interactivity - Returns ggplot object","code":"# ggplot2 version gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"with-custom-styling","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"With Custom Styling","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Base R version with custom colors plot(mse[1], col = \"blue\", peakCol = \"red\") # ggplot2 version with custom colors and theme gplot(mse[1], col = \"blue\", peakCol = \"red\") &   theme_minimal()"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcms-plot-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XCMS plot()","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Base R version with custom colors plot(mse[1], col = \"blue\", peakCol = \"red\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsvis-gplot-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis gplot()","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# ggplot2 version with custom colors and theme gplot(mse[1], col = \"blue\", peakCol = \"red\") &   theme_minimal()"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"all-plot-types-comparison","dir":"Articles","previous_headings":"","what":"All Plot Types Comparison","title":"Visualizing XcmsExperiment MS Data","text":"Shows raw MS data (m/z vs RT) Use : - Exploring raw MS data - Quality control acquisitions - Understanding full spectral information  Shows raw MS data (m/z vs RT) Additional capabilities: - Interactive plotly - Custom color ramps - Theme customization  Shows extracted ion chromatogram (EIC) Use : - Focusing specific m/z - Peak integration - Comparing specific compounds  Shows extracted ion chromatogram (EIC) Additional capabilities: - ggplot2 styling - Easy faceting multiple samples - Interactive tooltips  Fixed vertical stacking  Flexible layout patchwork operators","code":"# Base R version plot(mse[1]) # ggplot2 version gplot(mse[1]) # Base R chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) plot(chr[1, 1]) # ggplot2 chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) gplot(chr[1, 1]) # Base R version - fixed layout plot(mse) # ggplot2 version - flexible with patchwork gplot(mse)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsexperiment-visualization-full-ms-data","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XcmsExperiment Visualization (Full MS Data)","title":"Visualizing XcmsExperiment MS Data","text":"Shows raw MS data (m/z vs RT) Use : - Exploring raw MS data - Quality control acquisitions - Understanding full spectral information  Shows raw MS data (m/z vs RT) Additional capabilities: - Interactive plotly - Custom color ramps - Theme customization","code":"# Base R version plot(mse[1]) # ggplot2 version gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcms-plotxcmsexperiment","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XCMS plot(XcmsExperiment)","title":"Visualizing XcmsExperiment MS Data","text":"Shows raw MS data (m/z vs RT) Use : - Exploring raw MS data - Quality control acquisitions - Understanding full spectral information","code":"# Base R version plot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsvis-gplotxcmsexperiment","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis gplot(XcmsExperiment)","title":"Visualizing XcmsExperiment MS Data","text":"Shows raw MS data (m/z vs RT) Additional capabilities: - Interactive plotly - Custom color ramps - Theme customization","code":"# ggplot2 version gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"chromatogram-visualization-eic","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Chromatogram Visualization (EIC)","title":"Visualizing XcmsExperiment MS Data","text":"Shows extracted ion chromatogram (EIC) Use : - Focusing specific m/z - Peak integration - Comparing specific compounds  Shows extracted ion chromatogram (EIC) Additional capabilities: - ggplot2 styling - Easy faceting multiple samples - Interactive tooltips","code":"# Base R chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) plot(chr[1, 1]) # ggplot2 chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) gplot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcms-plotxchromatogram","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XCMS plot(XChromatogram)","title":"Visualizing XcmsExperiment MS Data","text":"Shows extracted ion chromatogram (EIC) Use : - Focusing specific m/z - Peak integration - Comparing specific compounds","code":"# Base R chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) plot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsvis-gplotxchromatogram","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis gplot(XChromatogram)","title":"Visualizing XcmsExperiment MS Data","text":"Shows extracted ion chromatogram (EIC) Additional capabilities: - ggplot2 styling - Easy faceting multiple samples - Interactive tooltips","code":"# ggplot2 chromatogram chr <- chromatogram(xdata, mz = c(207, 208), rt = c(2600, 2800)) gplot(chr[1, 1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"multiple-samples-1","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Multiple Samples","title":"Visualizing XcmsExperiment MS Data","text":"Fixed vertical stacking  Flexible layout patchwork operators","code":"# Base R version - fixed layout plot(mse) # ggplot2 version - flexible with patchwork gplot(mse)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcms-plot-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"XCMS plot()","title":"Visualizing XcmsExperiment MS Data","text":"Fixed vertical stacking","code":"# Base R version - fixed layout plot(mse)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"xcmsvis-gplot-2","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"xcmsVis gplot()","title":"Visualizing XcmsExperiment MS Data","text":"Flexible layout patchwork operators","code":"# ggplot2 version - flexible with patchwork gplot(mse)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"key-advantages-of-xcmsvis","dir":"Articles","previous_headings":"","what":"Key Advantages of xcmsVis","title":"Visualizing XcmsExperiment MS Data","text":"ggplot2 foundation allows seamless conversion interactive plotly plots hover information, zoom, pan capabilities.  Patchwork integration makes trivial create custom layouts comparisons.  Use & operator apply themes consistently across panels patchwork object.","code":"# Convert to interactive plotly p <- gplot(mse[1]) ggplotly(p) # Easy side-by-side comparison with patchwork p1 <- gplot(mse[1]) + ggtitle(\"Sample 1\") p2 <- gplot(mse[2]) + ggtitle(\"Sample 2\") p1 | p2 # Apply consistent theme across all plots my_theme <- theme_minimal() +   theme(     plot.title = element_text(face = \"bold\", hjust = 0.5),     legend.position = \"bottom\"   )  gplot(mse[1]) & my_theme"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"interactivity","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"1. Interactivity","title":"Visualizing XcmsExperiment MS Data","text":"ggplot2 foundation allows seamless conversion interactive plotly plots hover information, zoom, pan capabilities.","code":"# Convert to interactive plotly p <- gplot(mse[1]) ggplotly(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"composition","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"2. Composition","title":"Visualizing XcmsExperiment MS Data","text":"Patchwork integration makes trivial create custom layouts comparisons.","code":"# Easy side-by-side comparison with patchwork p1 <- gplot(mse[1]) + ggtitle(\"Sample 1\") p2 <- gplot(mse[2]) + ggtitle(\"Sample 2\") p1 | p2"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"theme-consistency","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"3. Theme Consistency","title":"Visualizing XcmsExperiment MS Data","text":"Use & operator apply themes consistently across panels patchwork object.","code":"# Apply consistent theme across all plots my_theme <- theme_minimal() +   theme(     plot.title = element_text(face = \"bold\", hjust = 0.5),     legend.position = \"bottom\"   )  gplot(mse[1]) & my_theme"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"migration-guide","dir":"Articles","previous_headings":"","what":"Migration Guide","title":"Visualizing XcmsExperiment MS Data","text":"users transitioning XCMS plot() xcmsVis gplot():","code":"# Old XCMS plot(mse[1])  # New xcmsVis gplot(mse[1]) # Old XCMS plot(mse[1], col = \"blue\", peakCol = \"red\")  # New xcmsVis (same syntax) gplot(mse[1], col = \"blue\", peakCol = \"red\") # Old XCMS - must use graphics device pdf(\"plot.pdf\", width = 5, height = 6) plot(mse[1]) dev.off()  # New xcmsVis - save ggplot object p <- gplot(mse[1]) ggsave(\"plot.pdf\", p, width = 5, height = 6) # Old XCMS - limited customization plot(mse[1], col = \"blue\")  # New xcmsVis - full ggplot2 ecosystem gplot(mse[1], col = \"blue\") &   theme_minimal() &   theme(     legend.position = \"bottom\",     plot.title = element_text(face = \"bold\")   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"basic-replacement","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Basic Replacement","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Old XCMS plot(mse[1])  # New xcmsVis gplot(mse[1])"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"with-color-customization","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"With Color Customization","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Old XCMS plot(mse[1], col = \"blue\", peakCol = \"red\")  # New xcmsVis (same syntax) gplot(mse[1], col = \"blue\", peakCol = \"red\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"saving-plots","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Saving Plots","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Old XCMS - must use graphics device pdf(\"plot.pdf\", width = 5, height = 6) plot(mse[1]) dev.off()  # New xcmsVis - save ggplot object p <- gplot(mse[1]) ggsave(\"plot.pdf\", p, width = 5, height = 6)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"further-customization","dir":"Articles","previous_headings":"Supplementary: Comparison with Original XCMS","what":"Further Customization","title":"Visualizing XcmsExperiment MS Data","text":"","code":"# Old XCMS - limited customization plot(mse[1], col = \"blue\")  # New xcmsVis - full ggplot2 ecosystem gplot(mse[1], col = \"blue\") &   theme_minimal() &   theme(     legend.position = \"bottom\",     plot.title = element_text(face = \"bold\")   )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"when-to-use-each-1","dir":"Articles","previous_headings":"","what":"When to Use Each","title":"Visualizing XcmsExperiment MS Data","text":"Use XCMS plot() : - need exact reproduction legacy figures - Working base R graphics pipelines - customization needed Use xcmsVis gplot() : - Creating publication figures custom styling - Building interactive visualizations - Composing complex multi-panel figures - Integrating modern R visualization workflows - Teaching presentations (plotly interactivity)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/xcmsexperiment-visualization.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Visualizing XcmsExperiment MS Data","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] viridisLite_0.4.2   patchwork_1.3.2     plotly_4.11.0       #> [4] ggplot2_4.0.0       xcmsVis_0.99.15     xcms_4.8.0          #> [7] BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] ProtGenerics_1.42.0         pkgconfig_2.0.3             #>  [13] MetaboCoreUtils_1.18.0      crayon_1.5.3                #>  [15] fastmap_1.2.0               XVector_0.50.0              #>  [17] labeling_0.4.3              rmarkdown_2.30              #>  [19] preprocessCore_1.72.0       purrr_1.2.0                 #>  [21] xfun_0.54                   MultiAssayExperiment_1.36.0 #>  [23] jsonlite_2.0.0              progress_1.2.3              #>  [25] DelayedArray_0.36.0         parallel_4.5.2              #>  [27] prettyunits_1.2.0           cluster_2.1.8.1             #>  [29] R6_2.6.1                    stringi_1.8.7               #>  [31] RColorBrewer_1.1-3          limma_3.66.0                #>  [33] GenomicRanges_1.62.0        Rcpp_1.1.0                  #>  [35] Seqinfo_1.0.0               SummarizedExperiment_1.40.0 #>  [37] iterators_1.0.14            knitr_1.50                  #>  [39] IRanges_2.44.0              BiocBaseUtils_1.12.0        #>  [41] Matrix_1.7-4                igraph_2.2.1                #>  [43] tidyselect_1.2.1            abind_1.4-8                 #>  [45] yaml_2.3.10                 doParallel_1.0.17           #>  [47] codetools_0.2-20            affy_1.88.0                 #>  [49] lattice_0.22-7              tibble_3.3.0                #>  [51] plyr_1.8.9                  Biobase_2.70.0              #>  [53] withr_3.0.2                 S7_0.2.0                    #>  [55] evaluate_1.0.5              Spectra_1.20.0              #>  [57] pillar_1.11.1               affyio_1.80.0               #>  [59] BiocManager_1.30.26         MatrixGenerics_1.22.0       #>  [61] foreach_1.5.2               stats4_4.5.2                #>  [63] MSnbase_2.36.0              MALDIquant_1.22.3           #>  [65] ncdf4_1.24                  generics_0.1.4              #>  [67] S4Vectors_0.48.0            hms_1.1.4                   #>  [69] scales_1.4.0                MsExperiment_1.12.0         #>  [71] glue_1.8.0                  MsFeatures_1.18.0           #>  [73] lazyeval_0.2.2              tools_4.5.2                 #>  [75] mzID_1.48.0                 data.table_1.17.8           #>  [77] QFeatures_1.20.0            vsn_3.78.0                  #>  [79] mzR_2.44.0                  fs_1.6.6                    #>  [81] XML_3.99-0.19               grid_4.5.2                  #>  [83] impute_1.84.0               tidyr_1.3.1                 #>  [85] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [87] PSMatch_1.14.0              cli_3.6.5                   #>  [89] S4Arrays_1.10.0             dplyr_1.1.4                 #>  [91] AnnotationFilter_1.34.0     pcaMethods_2.2.0            #>  [93] gtable_0.3.6                digest_0.6.37               #>  [95] BiocGenerics_0.56.0         SparseArray_1.10.1          #>  [97] htmlwidgets_1.6.4           farver_2.1.2                #>  [99] htmltools_0.5.8.1           lifecycle_1.0.4             #> [101] httr_1.4.7                  statmod_1.5.1               #> [103] MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Stanstrup Jan. Author, maintainer. Anthropic. Contributor.           Code generated Claude AI Colin . Smith. Contributor.           XCMS original author Ralf Tautenhahn. Contributor.           XCMS original author Steffen Neumann. Contributor.            XCMS original author Paul Benton. Contributor.           XCMS contributor Christopher Conley. Contributor.           XCMS contributor Johannes Rainer. Contributor.            XCMS contributor Michael Witting. Contributor.           XCMS contributor William Kumler. Contributor.            XCMS contributor","code":""},{"path":"https://stanstrup.github.io/xcmsVis/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jan S (2025). xcmsVis: Modern Visualization XCMS Data. R package version 0.99.15, https://stanstrup.github.io/xcmsVis.","code":"@Manual{,   title = {xcmsVis: Modern Visualization for XCMS Data},   author = {Stanstrup Jan},   year = {2025},   note = {R package version 0.99.15},   url = {https://stanstrup.github.io/xcmsVis}, }"},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"xcmsvis","dir":"","previous_headings":"","what":"Modern Visualization for XCMS Data","title":"Modern Visualization for XCMS Data","text":"Modern, interactive visualizations XCMS metabolomics data using ggplot2.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Modern Visualization for XCMS Data","text":"xcmsVis provides ggplot2 implementations XCMS plotting functions, enabling: Modern, publication-ready visualizations Interactive plots plotly integration Consistent styling across plots Full compatibility XCMSnExp XcmsExperiment objects package complements XCMS package reimplementing base graphics plots using ggplot2.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Modern Visualization for XCMS Data","text":"","code":"# Install from GitHub (development version) # devtools::install_github(\"yourusername/xcmsVis\")"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"current-functions","dir":"","previous_headings":"Features","what":"Current Functions","title":"Modern Visualization for XCMS Data","text":"Works XCMSnExp XcmsExperiment objects Interactive tooltips plotly Modern ggplot2 aesthetics","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"planned-functions","dir":"","previous_headings":"Features","what":"Planned Functions","title":"Modern Visualization for XCMS Data","text":"Future releases include ggplot2 versions : - plotQC() - Quality control diagnostics - plotChromPeaks() - Chromatographic peak visualization - plotChromPeakImage() - Peak intensity heatmap - plotChromPeakDensity() - Peak density visualization - plotEIC() - Extracted ion chromatograms - !","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Modern Visualization for XCMS Data","text":"","code":"library(xcmsVis) library(xcms)  # Works with XcmsExperiment (XCMS v4+) xdata <- readMsExperiment(files = mzml_files) # ... perform peak detection, alignment, etc.  # Create retention time adjustment plot p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)  # Make it interactive library(plotly) ggplotly(p, tooltip = \"text\")  # Also works with XCMSnExp (XCMS v3) xdata_v3 <- readMSData(files = mzml_files, mode = \"onDisk\") # ... perform XCMS workflow p <- gplotAdjustedRtime(xdata_v3, color_by = sample_group)"},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"motivation","dir":"","previous_headings":"","what":"Motivation","title":"Modern Visualization for XCMS Data","text":"package addresses need discussed XCMS issue #551 ggplot2-based visualizations can easily made interactive using plotly.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Modern Visualization for XCMS Data","text":"Contributions welcome! Please feel free submit Pull Request.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Modern Visualization for XCMS Data","text":"MIT License - see LICENSE file details","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":null,"dir":"","previous_headings":"","what":"Current Tasks","title":"Current Tasks","text":"See CLAUDE.md development workflow, conventions, resources.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"fixed-issues-2025-11-08","dir":"","previous_headings":"","what":"Fixed Issues (2025-11-08)","title":"Current Tasks","text":"issues previous R CMD check resolved:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"id_1--fixed-rd-cross-reference-warning","dir":"","previous_headings":"Fixed Issues (2025-11-08)","what":"1. ‚úÖ Fixed Rd cross-reference warning","title":"Current Tasks","text":"Issue: Missing link(s) Rd file 'gplotFeatureGroups.Rd': '[xcms]{groupFeatures}' Solution: Updated seealso section use correct link format reference MsFeatures::groupFeatures() Files modified: R/AllGenerics.R","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"id_2--fixed-packagestats-warnings-during-adjustrtime","dir":"","previous_headings":"Fixed Issues (2025-11-08)","what":"2. ‚úÖ Fixed ‚Äòpackage:stats‚Äô warnings during adjustRtime()","title":"Current Tasks","text":"Issue: Warning serialize(data, node$con): 'package:stats' may available loading Solution: Added register(SerialParam()) adjustRtime() call disable parallel processing Files modified: R/AllGenerics.R","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"id_3--fixed-could-not-find-function-groupfeatures-error","dir":"","previous_headings":"Fixed Issues (2025-11-08)","what":"3. ‚úÖ Fixed ‚Äúcould not find function ‚ÄògroupFeatures‚Äô‚Äù error","title":"Current Tasks","text":"Issue: Error groupFeatures(xdata, param = SimilarRtimeParam()): find function \"groupFeatures\" Added library(MsFeatures) example code (groupFeatures MsFeatures, xcms) MsFeatures already Suggests section DESCRIPTION Files modified: R/AllGenerics.R","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"verification","dir":"","previous_headings":"Fixed Issues (2025-11-08)","what":"Verification","title":"Current Tasks","text":"Example code now runs successfully without errors warnings: - ‚úÖ ‚Äúfind function ‚ÄògroupFeatures‚Äô‚Äù error - ‚úÖ ‚Äòpackage:stats‚Äô warnings - ‚úÖ Plot created successfully - ‚úÖ Documentation regenerated roxygen2","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":"next-steps","dir":"","previous_headings":"","what":"Next Steps","title":"Current Tasks","text":"Run full R CMD check WSL file system issues resolved, test different system.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-compute_peak_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to compute density and find feature groups ‚Äî .compute_peak_density","title":"Helper function to compute density and find feature groups ‚Äî .compute_peak_density","text":"Helper function compute density find feature groups","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-compute_peak_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to compute density and find feature groups ‚Äî .compute_peak_density","text":"","code":".compute_peak_density(pks, param)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get sample data from XCMS object ‚Äî .get_sample_data","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"Internal helper handle XCMSnExp XcmsExperiment objects","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"","code":".get_sample_data(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"object XCMSnExp XcmsExperiment object","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"data.frame sample metadata","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get spectra data from XCMS object ‚Äî .get_spectra_data","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"Internal helper extract spectra/feature data XCMSnExp XcmsExperiment objects","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"","code":".get_spectra_data(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"object XCMSnExp XcmsExperiment object","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"data.frame spectra data including retention times","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-gplotChromPeakDensity_impl.html","id":null,"dir":"Reference","previous_headings":"","what":"Shared implementation function for gplotChromPeakDensity ‚Äî .gplotChromPeakDensity_impl","title":"Shared implementation function for gplotChromPeakDensity ‚Äî .gplotChromPeakDensity_impl","text":"Shared implementation function gplotChromPeakDensity","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-gplotChromPeakDensity_impl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shared implementation function for gplotChromPeakDensity ‚Äî .gplotChromPeakDensity_impl","text":"","code":".gplotChromPeakDensity_impl(   object,   param,   col = \"#00000060\",   xlab = \"retention time\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   simulate = TRUE,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-gplotChromatogramsOverlay_impl.html","id":null,"dir":"Reference","previous_headings":"","what":"Shared implementation function for gplotChromatogramsOverlay ‚Äî .gplotChromatogramsOverlay_impl","title":"Shared implementation function for gplotChromatogramsOverlay ‚Äî .gplotChromatogramsOverlay_impl","text":"Shared implementation function gplotChromatogramsOverlay","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-gplotChromatogramsOverlay_impl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shared implementation function for gplotChromatogramsOverlay ‚Äî .gplotChromatogramsOverlay_impl","text":"","code":".gplotChromatogramsOverlay_impl(   object,   col = \"#00000060\",   type = \"l\",   main = NULL,   xlab = \"retention time\",   ylab = \"intensity\",   xlim = numeric(),   ylim = numeric(),   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakBg = NULL,   peakCol = NULL,   peakPch = 1,   stacked = 0,   transform = identity,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-simulate_feature_groups.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to simulate feature grouping based on peak density ‚Äî .simulate_feature_groups","title":"Helper function to simulate feature grouping based on peak density ‚Äî .simulate_feature_groups","text":"Helper function simulate feature grouping based peak density","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-simulate_feature_groups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to simulate feature grouping based on peak density ‚Äî .simulate_feature_groups","text":"","code":".simulate_feature_groups(pks, dens_x, dens_y, param)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate XCMS object type ‚Äî .validate_xcms_object","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"Validate XCMS object type","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"","code":".validate_xcms_object(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"object Object validate","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"TRUE valid, stops error otherwise","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"Adds chromatographic peak annotations existing chromatogram plots. ggplot2 implementation works XCMSnExp XcmsExperiment objects, highlighting detected peaks rectangles, points, polygons.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"","code":"ghighlightChromPeaks(   object,   rt,   mz,   peakIds = character(),   border = \"#00000040\",   fill = NA,   type = c(\"rect\", \"point\", \"polygon\"),   whichPeaks = c(\"any\", \"within\", \"apex_within\") )  # S4 method for class 'XCMSnExp' ghighlightChromPeaks(   object,   rt,   mz,   peakIds = character(),   border = \"#00000040\",   fill = NA,   type = c(\"rect\", \"point\", \"polygon\"),   whichPeaks = c(\"any\", \"within\", \"apex_within\") )  # S4 method for class 'XcmsExperiment' ghighlightChromPeaks(   object,   rt,   mz,   peakIds = character(),   border = \"#00000040\",   fill = NA,   type = c(\"rect\", \"point\", \"polygon\"),   whichPeaks = c(\"any\", \"within\", \"apex_within\") )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"object XCMSnExp XcmsExperiment object detected peaks. rt Numeric vector length 2 specifying retention time range peak extraction (optional). mz Numeric vector length 2 specifying m/z range peak extraction (optional). peakIds Character vector peak identifiers (rownames chromPeaks) highlight. provided, rt mz ignored. border Color peak borders (default: semi-transparent grey). fill Color peak fills (default: NA). type Character specifying visualization type: \"rect\" (rectangle), \"point\" (apex point), \"polygon\" (peak shape). Default: \"rect\". whichPeaks Character specifying peak selection: \"\" (overlap), \"within\" (fully contained), \"apex_within\" (apex range). Default: \"\".","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"list ggplot2 layer objects can added existing ggplot chromatogram.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"function returns ggplot2 layers (geoms) can added existing chromatogram plot using + operator. Unlike base R version modifies existing plot, returns composable layers. Like original highlightChromPeaks, function takes full XCMSnExp/XcmsExperiment object searches peaks across samples, filters rt/mz. means can highlight peaks multiple samples. highlight peaks specific sample, filter object first using filterFile().","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) #> Loading required package: BiocParallel #>  #> This is xcms version 4.8.0  library(faahKO) library(MsExperiment) #> Loading required package: ProtGenerics #>  #> Attaching package: ‚ÄòProtGenerics‚Äô #> The following object is masked from ‚Äòpackage:stats‚Äô: #>  #>     smooth library(ggplot2)  # Load and process example data cdf_files <- system.file(\"cdf/KO/ko15.CDF\", package = \"faahKO\") xdata <- MsExperiment::readMsExperiment(spectraFiles = cdf_files) xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam())  # Extract chromatogram for plotting chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500)) #> Extracting chromatographic data #> Processing chromatographic peaks  # Highlight peaks from the full dataset (all samples in xdata) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata, rt = c(2500, 3500), mz = c(200, 210))   # Or filter to single sample first for cleaner visualization xdata_filtered <- xcms::filterFile(xdata, 1) gplot(chr[1, 1], peakType = \"none\") +   ghighlightChromPeaks(xdata_filtered, rt = c(2500, 3500), mz = c(200, 210))  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"Creates two-panel visualization MS data showing: Upper panel: Base Peak Intensity (BPI) chromatogram vs retention time Lower panel: m/z vs retention time scatter plot intensity-based coloring ggplot2 implementation XCMS's plot() method MsExperiment objects, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"","code":"# S4 method for class 'XcmsExperiment' gplot(   x,   msLevel = 1L,   peakCol = \"#ff000060\",   col = \"grey\",   colramp = grDevices::topo.colors,   pch = 21,   main = NULL,   xlab = \"Retention time\",   ... )  # S4 method for class 'XCMSnExp' gplot(   x,   msLevel = 1L,   peakCol = \"#ff000060\",   col = \"grey\",   colramp = grDevices::topo.colors,   pch = 21,   main = NULL,   xlab = \"Retention time\",   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"x XcmsExperiment XCMSnExp object msLevel integer(1) MS level visualize (default: 1) peakCol character(1) color peak rectangles (default: \"#ff000060\") col character(1) color point borders (default: \"grey\") colramp function color ramp intensity mapping (default: grDevices::topo.colors) pch integer(1) point shape (default: 21 = filled circle) main character vector titles (one per sample). NULL, uses sample names. xlab character(1) x-axis label (default: \"Retention time\") ... additional arguments (compatibility)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"ggplot patchwork object showing two-panel visualization. single samples, returns patchwork object two panels. multiple samples, returns patchwork object sample plots stacked.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"function: Extracts spectra data filtered MS level Applies adjusted retention times available Upper panel: plots BPI (max intensity per retention time) intensity-colored points Lower panel: plots m/z vs retention time scatter intensity-colored points Overlays detected peaks rectangles (available) Uses consistent color scale across panels based intensity","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot-XcmsExperiment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plot for XcmsExperiment and XCMSnExp ‚Äî gplot,XcmsExperiment-method","text":"","code":"if (FALSE) { # \\dontrun{ library(xcmsVis) library(xcms) library(MsExperiment)  # Load and filter data fticr_xdata <- readMSData2(...) mse <- filterRt(fticr_xdata, rt = c(175, 189)) %>%        filterMzRange(mz = c(106.02, 106.07))  # Plot MS data gplot(mse)  # With detected peaks mse_peaks <- findChromPeaks(mse, ...) gplot(mse_peaks, peakCol = \"red\")  # Multiple samples gplot(mse[1:3]) } # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"Creates ggplot2 version chromatogram detected peaks marked. equivalent base R plot() method XChromatogram objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"","code":"gplot(x, ...)  # S4 method for class 'XChromatogram' gplot(   x,   col = \"black\",   lty = 1,   type = \"l\",   xlab = \"retention time\",   ylab = \"intensity\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   ... )  # S4 method for class 'XChromatograms' gplot(   x,   col = \"#00000060\",   lty = 1,   type = \"l\",   xlab = \"retention time\",   ylab = \"intensity\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   ... )  # S4 method for class 'MChromatograms' gplot(   x,   col = \"#00000060\",   lty = 1,   type = \"l\",   xlab = \"retention time\",   ylab = \"intensity\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"x XChromatogram MChromatograms object. ... Additional arguments (compatibility plot). col Color chromatogram line (default: \"black\"). lty Line type chromatogram (default: 1). type Plot type (default: \"l\" line). xlab X-axis label (default: \"retention time\"). ylab Y-axis label (default: \"intensity\"). main Plot title (default: NULL). peakType Type peak annotation: \"polygon\", \"point\", \"rectangle\", \"none\" (default: \"polygon\"). peakCol Color peak markers (default: \"#00000060\"). peakBg Background color peak markers (default: \"#00000020\"). peakPch Point character peak markers peakType = \"point\" (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"ggplot object.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"function creates complete chromatogram plot detected peaks automatically marked, similar base R plot() method XChromatogram objects. chromatogram contains detected peaks, shown according peakType parameter.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(ggplot2)  # Load and process example data cdf_files <- system.file(\"cdf/KO/ko15.CDF\", package = \"faahKO\") xdata <- MsExperiment::readMsExperiment(spectraFiles = cdf_files) xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam())  # Extract chromatogram chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500)) #> Extracting chromatographic data #> Processing chromatographic peaks  # Plot with ggplot2 gplot(chr[1, 1])  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"Visualizes retention time correction plotting difference adjusted raw retention times across samples. ggplot2 implementation XCMS's plotAdjustedRtime() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"","code":"gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )  # S4 method for class 'XCMSnExp' gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )  # S4 method for class 'XcmsExperiment' gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"object XCMSnExp XcmsExperiment object retention time adjustment results. color_by Column name sample metadata use coloring lines. provided unquoted column name (e.g., sample_group). XCMSnExp objects, comes pData(object). XcmsExperiment objects, comes sampleData(object). include_columns Character vector column names sample metadata include tooltip text. NULL (default), columns included. adjustedRtime Logical, whether use adjusted retention times x-axis. Default TRUE.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"ggplot object showing retention time adjustment. line represents one sample, grey points/lines show peak groups used alignment (using PeakGroupsParam).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"function: Plots adjusted RT vs. difference (adjusted RT - raw RT) Shows one line per sample colored specified variable Overlays peak groups used alignment (grey circles dashed lines) Includes tooltip-ready text interactive plotting plotly grey circles represent individual peaks used alignment, grey dashed lines connect peaks feature across samples.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform basic workflow xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) MsExperiment::sampleData(xdata)$sample_group <- c(\"KO\", \"KO\", \"WT\")  # Peak detection cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Peak grouping pdp <- PeakDensityParam(sampleGroups = c(\"KO\", \"KO\", \"WT\"),                         minFraction = 0.4, bw = 30) xdata <- groupChromPeaks(xdata, param = pdp)  # Retention time adjustment pgp <- PeakGroupsParam(minFraction = 0.4) xdata <- adjustRtime(xdata, param = pgp) #> Performing retention time alignment using 882 anchor peaks.  # Create plot p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"Visualizes density chromatographic peaks along retention time axis help evaluate peak density correspondence analysis settings. ggplot2 implementation XCMS's plotChromPeakDensity() function.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"","code":"gplotChromPeakDensity(   object,   param,   col = \"#00000060\",   xlab = \"retention time\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   simulate = TRUE,   ... )  # S4 method for class 'XChromatograms' gplotChromPeakDensity(   object,   param,   col = \"#00000060\",   xlab = \"retention time\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   simulate = TRUE,   ... )  # S4 method for class 'MChromatograms' gplotChromPeakDensity(   object,   param,   col = \"#00000060\",   xlab = \"retention time\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   simulate = TRUE,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"object XChromatograms MChromatograms object detected chromatographic peaks. param PeakDensityParam object defining peak density correspondence parameters. missing, function try extract object's process history (correspondence performed). col Color chromatogram lines upper panel (default: \"#00000060\"). xlab X-axis label (default: \"retention time\"). main Plot title (default: NULL). peakType Type peak annotation upper panel: \"polygon\", \"point\", \"rectangle\", \"none\" (default: \"polygon\"). peakCol Color peak markers (default: \"#00000060\"). peakBg Background color peak markers (default: \"#00000020\"). peakPch Point character peak markers peakType = \"point\" (default: 1). simulate Logical, whether simulate correspondence analysis (TRUE) display existing results (FALSE). Default: TRUE. ... Additional arguments passed plot methods.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"ggplot object two panels: Upper panel: Chromatogram(s) identified peaks Lower panel: Peak density along retention time axis showing individual peaks points (y-axis = sample) density estimate overlaid line. Grey rectangles indicate peaks grouped features.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"function creates two-panel visualization: Upper panel shows chromatographic data detected peaks Lower panel shows peak retention time (x-axis) sample (y-axis) kernel density estimate shown line Grey rectangles indicate peaks (simulate=TRUE) (simulate=FALSE) grouped features based peak density method visualization particularly useful optimizing PeakDensityParam settings, especially bw (bandwidth) parameter controls smoothing density estimate. Note: Currently supports plotting single row (m/z slice) across multiple samples. object multiple rows, please subset one row first.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakDensity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromPeakDensity ‚Äî gplotChromPeakDensity","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Extract chromatogram for a specific m/z range chr <- chromatogram(xdata, mz = c(305.05, 305.15)) #> Extracting chromatographic data #> Processing chromatographic peaks  # Visualize peak density with default settings prm <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 30) gplotChromPeakDensity(chr, param = prm) #> Warning: Removed 240 rows containing missing values or values outside the scale range #> (`geom_line()`).   # Try different bandwidth to see effect on peak grouping prm2 <- PeakDensityParam(sampleGroups = rep(1, 3), bw = 60) gplotChromPeakDensity(chr, param = prm2) #> Warning: Removed 240 rows containing missing values or values outside the scale range #> (`geom_line()`).  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"Creates image/heatmap showing number detected chromatographic peaks per sample across retention time bins. ggplot2 implementation XCMS's plotChromPeakImage() function.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"","code":"gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )  # S4 method for class 'XCMSnExp' gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )  # S4 method for class 'XcmsExperiment' gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"object XCMSnExp XcmsExperiment object detected chromatographic peaks. binSize Numeric value specifying bin size seconds retention time axis (default: 30). xlim Numeric vector length 2 specifying retention time range. NULL (default), uses full retention time range. log_transform Logical, whether log2-transform peak counts (default: FALSE). msLevel Integer specifying MS level (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"ggplot object showing peak counts heatmap retention time x-axis, samples y-axis, color representing peak density.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"function: Bins peaks across retention time using specified bin size Counts peaks per sample per bin Creates heatmap color representing peak density Optionally applies log2 transformation counts","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Create plot p <- gplotChromPeakImage(xdata, binSize = 30) print(p)  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"Visualizes identified chromatographic peaks rectangles retention time vs. m/z plane. ggplot2 implementation XCMS's plotChromPeaks() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"","code":"gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )  # S4 method for class 'XCMSnExp' gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )  # S4 method for class 'XcmsExperiment' gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"object XCMSnExp XcmsExperiment object detected chromatographic peaks. file Integer specifying file/sample plot (default: 1). xlim Numeric vector length 2 specifying retention time range. NULL (default), uses full retention time range. ylim Numeric vector length 2 specifying m/z range. NULL (default), uses full m/z range. border Color peak rectangle borders (default: semi-transparent black). fill Color peak rectangle fills (default: NA fill). msLevel Integer specifying MS level (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"ggplot object showing chromatographic peaks rectangles retention time vs. m/z space.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"function: Plots peak rectangle spanning rt m/z ranges Uses geom_rect create peak rectangles Supports interactive plotting plotly conversion","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Create plot p <- gplotChromPeaks(xdata, file = 1) print(p)  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"Creates overlay plots multiple chromatograms, one plot per row XChromatograms MChromatograms object. plot overlays samples (columns) m/z slice (row). ggplot2 implementation XCMS's plotChromatogramsOverlay() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"","code":"gplotChromatogramsOverlay(   object,   col = \"#00000060\",   type = \"l\",   main = NULL,   xlab = \"retention time\",   ylab = \"intensity\",   xlim = numeric(),   ylim = numeric(),   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakBg = NULL,   peakCol = NULL,   peakPch = 1,   stacked = 0,   transform = identity,   ... )  # S4 method for class 'XChromatograms' gplotChromatogramsOverlay(   object,   col = \"#00000060\",   type = \"l\",   main = NULL,   xlab = \"retention time\",   ylab = \"intensity\",   xlim = numeric(),   ylim = numeric(),   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakBg = NULL,   peakCol = NULL,   peakPch = 1,   stacked = 0,   transform = identity,   ... )  # S4 method for class 'MChromatograms' gplotChromatogramsOverlay(   object,   col = \"#00000060\",   type = \"l\",   main = NULL,   xlab = \"retention time\",   ylab = \"intensity\",   xlim = numeric(),   ylim = numeric(),   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakBg = NULL,   peakCol = NULL,   peakPch = 1,   stacked = 0,   transform = identity,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"object XChromatograms MChromatograms object. col Color chromatogram lines (default: \"#00000060\"). type Plot type (default: \"l\" line). main Plot title vector titles (one per row). Default: NULL. xlab X-axis label (default: \"retention time\"). ylab Y-axis label (default: \"intensity\"). xlim Numeric vector length 2 specifying retention time range. Default: numeric() (auto-calculate). ylim Numeric vector length 2 specifying intensity range. Default: numeric() (auto-calculate). peakType Type peak annotation: \"polygon\", \"point\", \"rectangle\", \"none\" (default: \"polygon\"). peakBg Background color peak markers (default: NULL, uses peakCol transparency). peakCol Color peak markers (default: NULL, uses col). peakPch Point character peak markers peakType = \"point\" (default: 1). stacked Numeric value stacking offset. > 0, chromatograms offset vertically amount visual separation (default: 0). transform Function transform intensity values (default: identity). Useful log-transformations intensity scaling. ... Additional arguments (compatibility).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"object one row: single ggplot object. object multiple rows: patchwork object combining multiple ggplot objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"function creates overlay plots samples (columns) given m/z slice (row) overlaid single plot. object contains multiple rows, row gets panel stacked vertically using patchwork. function differs gplot XChromatograms : explicitly handles multiple rows (whereas gplot warns uses first) supports stacked parameter vertical offset supports transform parameter intensity transformations","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromatogramsOverlay.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromatogramsOverlay ‚Äî gplotChromatogramsOverlay","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Extract chromatograms for multiple m/z ranges chr <- chromatogram(xdata, mz = rbind(c(305.05, 305.15), c(344.0, 344.2))) #> Extracting chromatographic data #> Processing chromatographic peaks  # Create overlay plot for all rows gplotChromatogramsOverlay(chr) #> Warning: Removed 260 rows containing missing values or values outside the scale range #> (`geom_line()`).   # With stacked offset for visual separation gplotChromatogramsOverlay(chr, stacked = 1e6) #> Warning: Removed 260 rows containing missing values or values outside the scale range #> (`geom_line()`).   # With log transformation gplotChromatogramsOverlay(chr, transform = log1p) #> Warning: Removed 260 rows containing missing values or values outside the scale range #> (`geom_line()`).  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"Visualizes feature groups plotting features connected across retention time m/z dimensions. ggplot2 implementation XCMS's plotFeatureGroups() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"","code":"gplotFeatureGroups(   x,   xlim = numeric(),   ylim = numeric(),   xlab = \"retention time\",   ylab = \"m/z\",   pch = 4,   col = \"#00000060\",   type = \"o\",   main = \"Feature groups\",   featureGroups = character(),   ... )  # S4 method for class 'XCMSnExp' gplotFeatureGroups(   x,   xlim = numeric(),   ylim = numeric(),   xlab = \"retention time\",   ylab = \"m/z\",   pch = 4,   col = \"#00000060\",   type = \"o\",   main = \"Feature groups\",   featureGroups = character(),   ... )  # S4 method for class 'XcmsExperiment' gplotFeatureGroups(   x,   xlim = numeric(),   ylim = numeric(),   xlab = \"retention time\",   ylab = \"m/z\",   pch = 4,   col = \"#00000060\",   type = \"o\",   main = \"Feature groups\",   featureGroups = character(),   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"x XCMSnExp XcmsExperiment object feature grouping results. xlim Numeric vector length 2 specifying retention time range. Default: numeric() (auto-calculate data). ylim Numeric vector length 2 specifying m/z range. Default: numeric() (auto-calculate data). xlab X-axis label (default: \"retention time\"). ylab Y-axis label (default: \"m/z\"). pch Point character feature markers (default: 4). col Color feature points connecting lines (default: \"#00000060\"). type Plot type (default: \"o\" overplotted points lines). main Plot title (default: \"Feature groups\"). featureGroups Character vector feature group identifiers plot. empty (default), feature groups plotted. ... Additional arguments passed geom functions.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"ggplot object showing features connected lines within feature group across retention time m/z dimensions.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"function: Extracts feature definitions grouping information Plots feature point (rtmed, mzmed) Connects features within group lines Feature groups created groupFeatures() identifies features likely represent compound (isotopes, adducts, etc.) Feature groups must present object calling function. Run groupFeatures() first create feature groups based retention time, m/z relationships, criteria.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotFeatureGroups.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotFeatureGroups ‚Äî gplotFeatureGroups","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel) library(MsFeatures)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform complete workflow xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) xdata <- findChromPeaks(xdata, param = CentWaveParam(), BPPARAM = SerialParam()) xdata <- groupChromPeaks(xdata, param = PeakDensityParam(   sampleGroups = rep(1, 3), minFraction = 0.5))  # Disable parallel processing to avoid warnings register(SerialParam()) xdata <- adjustRtime(xdata, param = ObiwarpParam()) #> value 5 xdata <- groupChromPeaks(xdata, param = PeakDensityParam(   sampleGroups = rep(1, 3), minFraction = 0.5))  # Group features (identify related features like isotopes/adducts) xdata <- groupFeatures(xdata, param = SimilarRtimeParam())  # Visualize feature groups gplotFeatureGroups(xdata) #> Warning: Removed 590 rows containing missing values or values outside the scale range #> (`geom_path()`).   # Visualize specific feature groups only gplotFeatureGroups(xdata, featureGroups = c(\"FG.001\", \"FG.002\")) #> Error: None of the specified feature groups found # }"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-15","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.15","text":"properly separate line connections feature groups (876b706) resolve gplotFeatureGroups example errors warnings (dbf8106) sort features m/z limit vignette comparison plots (7105e7f) use geom_path instead geom_line preserve m/z ordering (f2d8f23)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-15","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.15","text":"Implement gplotFeatureGroups feature group visualization (75f7a9e)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-14","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.14","text":"add missing geom_vline import gplotChromPeakDensity (405865a) apply filterRt polygon fix XChromatogram method (92c19ac) completely rewrite gplotChromatogramsOverlay match XCMS behavior (2faec0a) correct layer ordering gplotChromPeakDensity lower panel (bec5673) correct rectangle positioning gplotChromPeakDensity (7479e45) correct stacking behavior gplotChromatogramsOverlay (9194f79) doc: formatting makes rstudio live view happy (a83ef91) handle infinite values gplot polygon rendering (c8da796) use Bootstrap grid instead CSS flexbox pkgdown compatibility (f79605d) use filterRt() polygon rendering match XCMS exactly (1a5cb2a) use patchwork & operator vignette custom_ggplot example (dce3edc)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-14","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.14","text":"add gplot() method XcmsExperiment XCMSnExp (8fd87fb) add side--side comparison correspondence results (b0113ad) implement gplotChromatogramsOverlay XChromatograms/MChromatograms (acfe633) implement gplotChromPeakDensity XChromatograms/MChromatograms (beff00d), closes hi#priority","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"breaking-changes-0-99-14","dir":"Changelog","previous_headings":"","what":"BREAKING CHANGES","title":"Changes in v0.99.14","text":"gplotChromatogramsOverlay now correctly overlays multiple EICs (rows) sample (column), multiple samples across EIC. matches original XCMS behavior. Changes: - Now loops columns (samples) instead rows (EICs) - Overlays multiple rows (different EICs) single plot per sample - Uses facet_wrap multiple samples instead patchwork - Main titles now correspond samples (columns) EICs (rows) - Updated tests reflect correct XCMS behavior key difference XCMS plot(): - plot() overlays EIC across different samples - plotChromatogramsOverlay() overlays different EICs within sample ü§ñ Generated Claude Code Co-Authored-: Claude noreply@anthropic.com","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-13","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.13","text":"correct pkgdown deployment documentation link (a8f45ea), closes #pages","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-12","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.12","text":"re-add .nojekyll file creation prevent Jekyll processing (05e9fc6)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-11","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.11","text":"use JamesIves/github-pages-deploy-action instead (65dc2bd)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-10","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.10","text":"add github-pages environment pkgdown workflow (f2c20ef)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-9","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.9","text":"configure BiocParallel serial processing tests (e8b3979) correct example code cross-references (bd86c11)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-8","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.8","text":"doc: also used filtering original function (a43eaa5) polygon type now matches original XCMS behavior exactly (418668e) update tests handle chromatograms without peaks correctly (670a477)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-7","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.7","text":"use GitHub Pages artifact deployment pkgdown (1ce3fc8)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-6","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.6","text":"add complete example ghighlightChromPeaks (0a27bf1)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-5","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.5","text":"ensure .nojekyll file created pkgdown site (29eb82c) resolve R CMD check warnings gplot (86345f2) update prepare-news.sh path release workflow (f04ed39)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-4","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.4","text":"highlightChromPeaks works XCMSnExp (ebb1851) refactor gplot ghighlightChromPeaks per code review (14fb0de) remove library(xcmsVis) vignettes R CMD check (0d1aad6) restore library(xcmsVis) vignette (070bae0) reverse viridis scale gplotChromPeakImage match XCMS (049d978)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-4","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.4","text":"add gplot() method XChromatogram objects (9dbbc33)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-3","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.3","text":"constrain version 0.99.x Bioconductor development (5de5bfd) correct NEWS.md use 0.99.x versioning (f0978fd)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-2","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.2","text":"add gplotChromPeaks, gplotChromPeakImage, ghighlightChromPeaks (0893bfa) add SystemRequirements Quarto vignettes (498afc6) add comprehensive vignette peak visualization functions","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-2","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.2","text":"constrain version 0.99.x Bioconductor development convert MsExperiment XcmsExperiment skip peak picking (707aadb) account OnDiskMSnExp get filenames pData. (b1af112) add BiocParallel Suggests fix fileNames import (69fb33e) add missing dplyr::n import utils.R (dd8b918) add Quarto setup GitHub Actions workflows address BiocCheck requirements (b1c4d5f) coerce instead new peakpicking (159c06a) consistency objects (5e52665) correct version ordering NEWS.md (026dbcf) corrected tests. (3b61b79) properly import () methods package (4086c92) remove BPPARAM groupChromPeaks calls (26eec03) remove links NEWS.md headings pkgdown compatibility (8262eec) remove unused methods Imports (358535b) resolve R CMD check warnings (d892e19) use SerialParam tests avoid parallel processing warnings (abbfb4f)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"performance-improvements-0-99-2","dir":"Changelog","previous_headings":"","what":"Performance Improvements","title":"Changes in v0.99.2","text":"use SerialParam vignette faster processing (382f301)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.0","text":"provide spectraOrigin_base matching column names omit files filtered away alignment. (8aceeae) actually working version gplotAdjustedRtime now works XcmsExperiment objects. imports missing. fix later (5f9898c) add groupChromPeaks filterFile tests (73b30f4) add MSnbase Imports fix missing global variables (772346e) correct test fixtures helper functions dual-class support (cf9b1bd) exclude quarto cache R package builds (764d68f) fixed .get_spectra_data ahve columns (75b2b2b) fixed imports gplotAdjustedRtime (39aa2b3) re-add groupChromPeaks filterFile vignette (fe46d99) replace Quarto columns HTML flexbox pkgdown compatibility (646b3ef)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.0","text":"add comprehensive alt-text vignette figures (89a33aa) add comprehensive testing documentation gplotAdjustedRtime (552315e) add helper function get spectra data object types (47038d7)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-2-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.2.0","text":"correct GitHub Actions workflow vignette workflow (6dd52fd)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-2-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.2.0","text":"add semantic versioning improve package infrastructure (86a0704)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-1-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.1.0","text":"Support XCMSnExp XcmsExperiment objects Add utility functions object type handling (.get_sample_data, .validate_xcms_object) Comprehensive test suite faahKO example data Working vignette executable code examples using faahKO data pkgdown documentation site","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-1-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.1.0","text":"Fix vignette use real data instead eval=FALSE examples Update sample metadata extraction handle object types correctly","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-0-1","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.0.1","text":"Initial release Implement gplotAdjustedRtime() function ggplot2 visualization retention time adjustment Interactive tooltip support plotly Complete package infrastructure (CI/CD, documentation, tests) Comparison vignette showing XCMS vs xcmsVis approaches","code":""}]
