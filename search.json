[{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"project-overview","dir":"","previous_headings":"","what":"Project Overview","title":"CLAUDE.md","text":"R package project named xcmsVis, parallel package XCMS provides ggplot2 implementations XCMS plotting functions modern, interactive visualizations.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"project-task-management","dir":"","previous_headings":"","what":"Project Task Management","title":"CLAUDE.md","text":"IMPORTANT: project uses structured task management system minimize token usage: instructions.md: Contains current/active tasks. Keep file lightweight possible. completed_tasks.md: Archive completed tasks detailed documentation. future_tasks.md: Long-term development roadmap planned features. working tasks: 1. Check instructions.md current work 2. Move completed tasks completed_tasks.md details 3. Keep instructions.md minimal reduce token consumption 4. Reference files context rather duplicating information","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"package-setup-and-building","dir":"","previous_headings":"R Package Development Commands","what":"Package Setup and Building","title":"CLAUDE.md","text":"","code":"# Install development dependencies install.packages(c(\"devtools\", \"roxygen2\", \"testthat\", \"usethis\"))  # Build package documentation from roxygen comments devtools::document()  # Install the package locally devtools::install()  # Build package bundle devtools::build()  # Check package (runs R CMD check) devtools::check()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"testing","dir":"","previous_headings":"R Package Development Commands","what":"Testing","title":"CLAUDE.md","text":"IMPORTANT: working specific functions, ALWAYS use testthat::test_file() run relevant test file. Running tests devtools::test() takes much longer necessary.","code":"# Run all tests (can be slow) devtools::test()  # Run a specific test file (PREFERRED - faster for development) testthat::test_file(\"tests/testthat/test-filename.R\")  # Run tests with coverage covr::package_coverage()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"development-workflow","dir":"","previous_headings":"R Package Development Commands","what":"Development Workflow","title":"CLAUDE.md","text":"","code":"# Load package for interactive development devtools::load_all()  # Create new function/data documentation usethis::use_r(\"function_name\")  # Add test file usethis::use_test(\"function_name\")  # Add package dependency usethis::use_package(\"package_name\")"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"r-package-structure","dir":"","previous_headings":"","what":"R Package Structure","title":"CLAUDE.md","text":"creating R package files, follow structure: DESCRIPTION - Package metadata dependencies NAMESPACE - Package namespace (auto-generated roxygen2) R/ - R source code files man/ - Documentation files (auto-generated roxygen2) tests/testthat/ - Unit tests vignettes/ - Long-form documentation data/ - Package datasets inst/ - Additional files installed dev-docs/ - Research documentation implementation guides (part package, ignored R CMD build)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"code-style","dir":"","previous_headings":"","what":"Code Style","title":"CLAUDE.md","text":"project follows standard R package conventions: - Use 2 spaces indentation (configured .Rproj file) - Strip trailing whitespace (configured .Rproj file) - Auto-append newline files (configured .Rproj file) - Use UTF-8 encoding","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"testing-requirements","dir":"","previous_headings":"","what":"Testing Requirements","title":"CLAUDE.md","text":"IMPORTANT: functions MUST comprehensive tests: - Test compatibility XCMSnExp XcmsExperiment objects - Even examples/vignettes focus XcmsExperiment, tests must verify XCMSnExp works - Write tests tests/testthat/test-*.R files - Use testthat::test_file() run individual test files - Ensure major code paths covered","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"bioconductor-parallel-processing","dir":"","previous_headings":"","what":"Bioconductor Parallel Processing","title":"CLAUDE.md","text":"IMPORTANT: Always use SerialParam() example code tests: SerialParam? - Faster small datasets: Avoids parallel processing overhead - Eliminates warnings: Prevents ‚Äú‚Äòpackage:stats‚Äô may available‚Äù warnings - Cleaner output: parallel-related messages - Better reproducibility: Consistent behavior across systems use SerialParam: - test files (tests/testthat/) - vignettes examples - code small sample sizes (< 20 samples typically) functions support BPPARAM: - ‚úÖ readMsExperiment() - supports BPPARAM - ‚úÖ findChromPeaks() - supports BPPARAM - ‚ùå groupChromPeaks() - support BPPARAM - ‚ùå adjustRtime() - support BPPARAM Note: Users can still use parallel processing production omitting BPPARAM setting parallel backend.","code":"library(BiocParallel)  # Always include BPPARAM = SerialParam() for functions that support it: xdata <- readMsExperiment(spectraFiles = files, BPPARAM = SerialParam()) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Note: groupChromPeaks does NOT have BPPARAM parameter xdata <- groupChromPeaks(xdata, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"adding-new-functions","dir":"","previous_headings":"","what":"Adding New Functions","title":"CLAUDE.md","text":"implementing new XCMS plotting functions: Identify XCMS plotting function implement Locate source code XCMS GitHub: https://github.com/sneumann/xcms Study function‚Äôs purpose, parameters, output Implement ggplot2 version R/gplot*.R Add roxygen2 documentation Update NAMESPACE needed Add tests tests/testthat/test-*.R (REQUIRED - test object types) Add examples vignette (focus XcmsExperiment) Update NEWS.md Run devtools::check() Move task instructions.md completed_tasks.md done","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"key-resources","dir":"","previous_headings":"","what":"Key Resources","title":"CLAUDE.md","text":"XCMS Repository: https://github.com/sneumann/xcms Metabonaut Tutorials: https://github.com/rformassspectrometry/Metabonaut Original Discussion: https://github.com/sneumann/xcms/issues/551 Package Structure Reference: /mnt/c/Users/tmh331/Desktop/gits/remoteUpdater Function Reference: /mnt/c/Users/tmh331/Desktop/gits/_Introduction Nutritional Metabolomics/inm-booklet/scripts/funs.R S4 Implementation Guide: dev-docs/ - Comprehensive guides implementing S4 methods like XCMS","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"important-conventions","dir":"","previous_headings":"","what":"Important Conventions","title":"CLAUDE.md","text":"Follow XCMS conventions object types methods Maintain compatibility XCMSnExp xcmsExperiment objects Use consistent naming: gplot* prefix plotting functions Include tooltip text plotly compatibility Write comprehensive roxygen2 documentation Add examples (even marked \\dontrun) tasks completed, move completed_tasks.md","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"s4-method-implementation-pattern","dir":"","previous_headings":"","what":"S4 Method Implementation Pattern","title":"CLAUDE.md","text":"IMPORTANT: implementing functions support XCMSnExp XcmsExperiment:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"do-use-shared-implementation-pattern","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"DO: Use Shared Implementation Pattern","title":"CLAUDE.md","text":"","code":"# Internal implementation function (single source of truth) .gplot_function_impl <- function(object, ...) {   .validate_xcms_object(object)    # Use helper functions that handle both object types   sample_data <- .get_sample_data(object)   spectra_data <- .get_spectra_data(object)    # All plotting logic here   # ... }  # Thin S4 method wrappers (just dispatch) setMethod(\"gplot_function\", \"XCMSnExp\",           function(object, ...) {             .gplot_function_impl(object, ...)           })  setMethod(\"gplot_function\", \"XcmsExperiment\",           function(object, ...) {             .gplot_function_impl(object, ...)           })"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"dont-duplicate-code-in-methods","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"DON‚ÄôT: Duplicate Code in Methods","title":"CLAUDE.md","text":"‚ùå BAD - Duplicating identical code methods:","code":"setMethod(\"gplot_function\", \"XCMSnExp\", function(...) {   # 100+ lines of code })  setMethod(\"gplot_function\", \"XcmsExperiment\", function(...) {   # Same 100+ lines of code (maintenance nightmare!) })"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"helper-functions","dir":"","previous_headings":"S4 Method Implementation Pattern","what":"Helper Functions","title":"CLAUDE.md","text":"Use internal helpers already handle object type differences: - .validate_xcms_object(object) - Validates object type - .get_sample_data(object) - Extracts sample metadata - .get_spectra_data(object) - Extracts spectra/feature data helpers use S4 dispatch internally, implementation function doesn‚Äôt need know object types.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"git-workflow","dir":"","previous_headings":"","what":"Git Workflow","title":"CLAUDE.md","text":"Default branch: main feat: - New feature (triggers minor version bump) fix: - Bug fix (triggers patch version bump) docs: - Documentation changes style: - Code style changes (formatting, etc.) refactor: - Code refactoring test: - Adding updating tests chore: - Maintenance tasks Example: feat: add gplotEIC function extracted ion chromatograms Run R CMD check push/PR Deploy pkgdown site push main Create releases via semantic-release based commit messages Always commit co-authorship footer using Claude Code","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"pre-commit-checklist","dir":"","previous_headings":"","what":"Pre-Commit Checklist","title":"CLAUDE.md","text":"IMPORTANT: committing changes, ALWAYS run checks order:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_0-update-description-if-needed","dir":"","previous_headings":"Pre-Commit Checklist","what":"0. Update DESCRIPTION (if needed)","title":"CLAUDE.md","text":"modifying functions, check DESCRIPTION needs updates: - Add new package dependencies Imports: using new packages - Update Suggests: optional dependencies (testing, vignettes) - Ensure imported packages listed","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_1-regenerate-documentation","dir":"","previous_headings":"Pre-Commit Checklist","what":"1. Regenerate Documentation","title":"CLAUDE.md","text":"ensures function documentation imports date.","code":"# Update NAMESPACE and .Rd files from roxygen2 comments roxygen2::roxygenize()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_2-r-cmd-check","dir":"","previous_headings":"Pre-Commit Checklist","what":"2. R CMD Check","title":"CLAUDE.md","text":"Fix errors warnings committing. Address notes relevant.","code":"# Check package for errors, warnings, and notes devtools::check()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_3-build-pkgdown-site","dir":"","previous_headings":"Pre-Commit Checklist","what":"3. Build pkgdown Site","title":"CLAUDE.md","text":"Check : - errors site build - vignettes render correctly - function documentation displays properly - broken links missing references commit three checks pass successfully.","code":"# Load all package code devtools::load_all()  # Build pkgdown site locally pkgdown::build_site()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_4-reinstall-package","dir":"","previous_headings":"Pre-Commit Checklist","what":"4. Reinstall Package","title":"CLAUDE.md","text":"ensures package fully functional changes.","code":"# Reinstall the package to ensure all changes are properly loaded devtools::install()"},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"id_5-commit-changes","dir":"","previous_headings":"Pre-Commit Checklist","what":"5. Commit Changes","title":"CLAUDE.md","text":"checks pass, commit changes using semantic-release format: - Use conventional commit messages (feat:, fix:, docs:, etc.) - Always include co-authorship footer using Claude Code - Example:","code":"git add -A git commit -m \"feat: add new visualization function  ü§ñ Generated with [Claude Code](https://claude.com/claude-code)  Co-Authored-By: Claude <noreply@anthropic.com>\""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"pre-push-checklist","dir":"","previous_headings":"","what":"Pre-Push Checklist","title":"CLAUDE.md","text":"committing, verify everything working pushing GitHub: - Ensure devtools::check() passes errors/warnings - Ensure pkgdown::build_site() completes without errors - Review git status ensure unintended files included","code":""},{"path":"https://stanstrup.github.io/xcmsVis/CLAUDE.html","id":"task-management","dir":"","previous_headings":"","what":"Task Management","title":"CLAUDE.md","text":"IMPORTANT: start working new tasks instructions.md unless explicitly told user. Wait user give go-ahead proceeding tasks. CRITICAL: Make commits frequently completing task logical unit work: - Commit completed task instructions.md - Don‚Äôt batch multiple tasks one commit - Use semantic commit format commit (feat:, fix:, docs:, etc.) - provides better granularity makes easier track changes - Example workflow: 1. Complete task 1 ‚Üí commit 2. Complete task 2 ‚Üí commit 3. Complete task 3 ‚Üí commit etc.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"vignette demonstrates gplotAdjustedRtime() function, provides ggplot2-based visualization retention time correction LC-MS metabolomics data. function designed work XcmsExperiment (XCMS v4+) XCMSnExp (XCMS v3) objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"library(xcms) library(xcmsVis) library(ggplot2) library(plotly) library(faahKO) library(MsExperiment) library(BiocParallel)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"‚Äôll use faahKO package, contains example LC-MS data analysis fatty acid amide hydrolase (FAAH) knockout mice. Data can also old style ‚ÄúXCMSnExp‚Äù (run) MSnbase.","code":"# Get example CDF files from faahKO package (load once, reuse throughout) cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                   recursive = TRUE, full.names = TRUE)  # Using 3 samples from each group (6 total) cdf_files <- cdf_files[c(1:3, 7:9)]  # Load data as XcmsExperiment # Use SerialParam for faster processing with small datasets xdata_raw <- readMsExperiment(   spectraFiles = cdf_files,   BPPARAM = SerialParam() )  # Add sample metadata sample_group <- rep(c(\"KO\", \"WT\"), each = 3) sampleData(xdata_raw)$sample_name <- basename(cdf_files) sampleData(xdata_raw)$sample_group <- sample_group xdata_raw <- as(as(xdata_raw, \"XcmsExperiment\"), \"XCMSnExp\") # Peak detection using CentWave algorithm (done once for efficiency) cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) # Use SerialParam for faster processing with small datasets xdata_peaks <- findChromPeaks(xdata_raw, param = cwp, BPPARAM = SerialParam())  # Initial correspondence (peak grouping) - done once for all examples sample_data <- xcmsVis:::.get_sample_data(xdata_peaks)  pdp <- PeakDensityParam(   sampleGroups = sample_data$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_grouped <- groupChromPeaks(xdata_peaks, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"peak-detection-performed-once","dir":"Articles","previous_headings":"","what":"Peak Detection (performed once)","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# Peak detection using CentWave algorithm (done once for efficiency) cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) # Use SerialParam for faster processing with small datasets xdata_peaks <- findChromPeaks(xdata_raw, param = cwp, BPPARAM = SerialParam())  # Initial correspondence (peak grouping) - done once for all examples sample_data <- xcmsVis:::.get_sample_data(xdata_peaks)  pdp <- PeakDensityParam(   sampleGroups = sample_data$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_grouped <- groupChromPeaks(xdata_peaks, param = pdp)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"proper XCMS workflow retention time adjustment using peak groups : Peak detection (already done ) Initial correspondence (grouping - already done ) Retention time adjustment (Re-correspondence alignment - needed visualization)   plot shows: Lines: One per sample, showing RT deviation across chromatographic run Grey circles: Individual peaks used alignment Grey dashed lines: Connect peaks feature across samples Since gplotAdjustedRtime() returns ggplot object, can easily customize :  Convert interactive plotly plot: Note can hover line see file path metadata.","code":"# Work with a copy of the grouped data xdata <- xdata_grouped  # Retention time alignment using peak groups pgp <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\" ) xdata <- adjustRtime(xdata, param = pgp)  # Note: Second groupChromPeaks after alignment is typically done for downstream # analysis (fillChromPeaks, feature tables), but not needed for RT visualization # Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) # ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p) p +   labs(     title = \"Retention Time Correction - faahKO Dataset\",     x = \"Adjusted Retention Time (s)\",     y = \"RT Adjustment (s)\",     color = \"Sample Group\"   ) +   theme_minimal() +   scale_color_brewer(palette = \"Set1\") +   theme(legend.position = \"top\") # Make it interactive p_interactive <- ggplotly(p, tooltip = \"text\") p_interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"complete-xcms-workflow","dir":"Articles","previous_headings":"","what":"Complete XCMS Workflow","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"proper XCMS workflow retention time adjustment using peak groups : Peak detection (already done ) Initial correspondence (grouping - already done ) Retention time adjustment (Re-correspondence alignment - needed visualization)","code":"# Work with a copy of the grouped data xdata <- xdata_grouped  # Retention time alignment using peak groups pgp <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\" ) xdata <- adjustRtime(xdata, param = pgp)  # Note: Second groupChromPeaks after alignment is typically done for downstream # analysis (fillChromPeaks, feature tables), but not needed for RT visualization"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"creating-the-plot","dir":"Articles","previous_headings":"","what":"Creating the Plot","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"plot shows: Lines: One per sample, showing RT deviation across chromatographic run Grey circles: Individual peaks used alignment Grey dashed lines: Connect peaks feature across samples","code":"# Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) # ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-version","dir":"Articles","previous_headings":"Basic Usage","what":"Original XCMS Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# Base R graphics version sample_data <- xcmsVis:::.get_sample_data(xdata)  plotAdjustedRtime(   xdata,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"Basic Usage","what":"xcmsVis ggplot2 Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"# ggplot2 version p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"customizing-the-plot","dir":"Articles","previous_headings":"","what":"Customizing the Plot","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Since gplotAdjustedRtime() returns ggplot object, can easily customize :","code":"p +   labs(     title = \"Retention Time Correction - faahKO Dataset\",     x = \"Adjusted Retention Time (s)\",     y = \"RT Adjustment (s)\",     color = \"Sample Group\"   ) +   theme_minimal() +   scale_color_brewer(palette = \"Set1\") +   theme(legend.position = \"top\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"interactive-visualization","dir":"Articles","previous_headings":"","what":"Interactive Visualization","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Convert interactive plotly plot: Note can hover line see file path metadata.","code":"# Make it interactive p_interactive <- ggplotly(p, tooltip = \"text\") p_interactive"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"advanced-use-cases","dir":"Articles","previous_headings":"","what":"Advanced Use Cases","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Sometimes may want filter samples alignment:   can use specific samples alignment calculation keeping samples dataset:   comparison, ‚Äôs alignment using samples:","code":"# Work with a fresh copy from grouped data xdata_filtered <- xdata_grouped  # Filter to specific samples (files 2-5) xdata_filtered <- filterFile(xdata_filtered, c(2:5))  # Filtering removes correspondence - need to re-group with filtered samples sample_data_filtered <- xcmsVis:::.get_sample_data(xdata_filtered) pdp_filtered <- PeakDensityParam(   sampleGroups = sample_data_filtered$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_filtered <- groupChromPeaks(xdata_filtered, param = pdp_filtered)  # Align filtered data pgp_filter <- PeakGroupsParam(minFraction = 0.4) xdata_filtered <- adjustRtime(xdata_filtered, param = pgp_filter) sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered) # Work with a fresh copy of grouped data xdata_subset <- xdata_grouped  # Use subset parameter to align using only specific samples pgp_subset <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\",   subset = c(1, 2, 3, 5)  # Exclude sample 4 from alignment calculation ) xdata_subset <- adjustRtime(xdata_subset, param = pgp_subset) sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset) # Work with a fresh copy of grouped data xdata_no_subset <- xdata_grouped  # Align without subset parameter (use all samples) pgp_no_subset <- PeakGroupsParam(minFraction = 0.4) xdata_no_subset <- adjustRtime(xdata_no_subset, param = pgp_no_subset) sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-filterfile","dir":"Articles","previous_headings":"","what":"With filterFile()","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"Sometimes may want filter samples alignment:","code":"# Work with a fresh copy from grouped data xdata_filtered <- xdata_grouped  # Filter to specific samples (files 2-5) xdata_filtered <- filterFile(xdata_filtered, c(2:5))  # Filtering removes correspondence - need to re-group with filtered samples sample_data_filtered <- xcmsVis:::.get_sample_data(xdata_filtered) pdp_filtered <- PeakDensityParam(   sampleGroups = sample_data_filtered$sample_group,   minFraction = 0.4,   bw = 30 ) xdata_filtered <- groupChromPeaks(xdata_filtered, param = pdp_filtered)  # Align filtered data pgp_filter <- PeakGroupsParam(minFraction = 0.4) xdata_filtered <- adjustRtime(xdata_filtered, param = pgp_filter) sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms","dir":"Articles","previous_headings":"Advanced Use Cases","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_filtered)  plotAdjustedRtime(   xdata_filtered,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version","dir":"Articles","previous_headings":"Advanced Use Cases","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_filtered <- gplotAdjustedRtime(xdata_filtered, color_by = sample_group) print(p_filtered)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"with-subset-parameter-in-peakgroupsparam","dir":"Articles","previous_headings":"","what":"With subset Parameter in PeakGroupsParam","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"can use specific samples alignment calculation keeping samples dataset:","code":"# Work with a fresh copy of grouped data xdata_subset <- xdata_grouped  # Use subset parameter to align using only specific samples pgp_subset <- PeakGroupsParam(   minFraction = 0.4,   smooth = \"loess\",   span = 0.2,   family = \"gaussian\",   subset = c(1, 2, 3, 5)  # Exclude sample 4 from alignment calculation ) xdata_subset <- adjustRtime(xdata_subset, param = pgp_subset) sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-1","dir":"Articles","previous_headings":"Advanced Use Cases","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_subset)  plotAdjustedRtime(   xdata_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version-1","dir":"Articles","previous_headings":"Advanced Use Cases","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_subset <- gplotAdjustedRtime(xdata_subset, color_by = sample_group) print(p_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"without-subset-parameter-all-samples","dir":"Articles","previous_headings":"","what":"Without subset Parameter (All Samples)","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"comparison, ‚Äôs alignment using samples:","code":"# Work with a fresh copy of grouped data xdata_no_subset <- xdata_grouped  # Align without subset parameter (use all samples) pgp_no_subset <- PeakGroupsParam(minFraction = 0.4) xdata_no_subset <- adjustRtime(xdata_no_subset, param = pgp_no_subset) sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" ) p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"original-xcms-2","dir":"Articles","previous_headings":"Advanced Use Cases","what":"Original XCMS","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sample_data <- xcmsVis:::.get_sample_data(xdata_no_subset)  plotAdjustedRtime(   xdata_no_subset,   col = as.factor(sample_data$sample_group),   peakGroupsCol = \"grey\" )"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"xcmsvis-version-2","dir":"Articles","previous_headings":"Advanced Use Cases","what":"xcmsVis Version","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"p_no_subset <- gplotAdjustedRtime(xdata_no_subset, color_by = sample_group) print(p_no_subset)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] MsExperiment_1.12.0 ProtGenerics_1.42.0 faahKO_1.50.0       #> [4] plotly_4.11.0       ggplot2_4.0.0       xcmsVis_0.99.5      #> [7] xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0      #>  [13] crayon_1.5.3                fastmap_1.2.0               #>  [15] XVector_0.50.0              labeling_0.4.3              #>  [17] rmarkdown_2.30              preprocessCore_1.72.0       #>  [19] purrr_1.2.0                 xfun_0.54                   #>  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0              #>  [23] progress_1.2.3              DelayedArray_0.36.0         #>  [25] parallel_4.5.2              prettyunits_1.2.0           #>  [27] cluster_2.1.8.1             R6_2.6.1                    #>  [29] stringi_1.8.7               RColorBrewer_1.1-3          #>  [31] limma_3.66.0                GenomicRanges_1.62.0        #>  [33] Rcpp_1.1.0                  Seqinfo_1.0.0               #>  [35] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [37] knitr_1.50                  IRanges_2.44.0              #>  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4                #>  [41] igraph_2.2.1                tidyselect_1.2.1            #>  [43] abind_1.4-8                 yaml_2.3.10                 #>  [45] doParallel_1.0.17           codetools_0.2-20            #>  [47] affy_1.88.0                 lattice_0.22-7              #>  [49] tibble_3.3.0                plyr_1.8.9                  #>  [51] Biobase_2.70.0              withr_3.0.2                 #>  [53] S7_0.2.0                    evaluate_1.0.5              #>  [55] Spectra_1.20.0              pillar_1.11.1               #>  [57] affyio_1.80.0               BiocManager_1.30.26         #>  [59] MatrixGenerics_1.22.0       foreach_1.5.2               #>  [61] stats4_4.5.2                MSnbase_2.36.0              #>  [63] MALDIquant_1.22.3           ncdf4_1.24                  #>  [65] generics_0.1.4              S4Vectors_0.48.0            #>  [67] hms_1.1.4                   scales_1.4.0                #>  [69] glue_1.8.0                  MsFeatures_1.18.0           #>  [71] lazyeval_0.2.2              tools_4.5.2                 #>  [73] mzID_1.48.0                 data.table_1.17.8           #>  [75] QFeatures_1.20.0            vsn_3.78.0                  #>  [77] mzR_2.44.0                  fs_1.6.6                    #>  [79] XML_3.99-0.19               grid_4.5.2                  #>  [81] impute_1.84.0               tidyr_1.3.1                 #>  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [85] PSMatch_1.14.0              cli_3.6.5                   #>  [87] viridisLite_0.4.2           S4Arrays_1.10.0             #>  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0     #>  [91] pcaMethods_2.2.0            gtable_0.3.6                #>  [93] digest_0.6.37               BiocGenerics_0.56.0         #>  [95] SparseArray_1.10.1          htmlwidgets_1.6.4           #>  [97] farver_2.1.2                htmltools_0.5.8.1           #>  [99] lifecycle_1.0.4             httr_1.4.7                  #> [101] statmod_1.5.1               MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/gplotAdjustedRtime.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Visualizing Retention Time Adjustment with gplotAdjustedRtime","text":"XCMS GitHub Repository: https://github.com/sneumann/xcms Original Feature Request: https://github.com/sneumann/xcms/issues/551 faahKO package: Bioconductor example dataset ggplot2 Documentation: https://ggplot2.tidyverse.org/ plotly R: https://plotly.com/r/","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Visualizing Chromatographic Peaks","text":"vignette demonstrates three ggplot2-based functions visualizing chromatographic peaks LC-MS metabolomics data: gplotChromPeaks(): Visualize detected peaks rectangles RT vs m/z space gplotChromPeakImage(): Heatmap showing peak density across samples retention time ghighlightChromPeaks(): Add peak annotations existing chromatogram plots functions work XcmsExperiment (XCMS v4+) XCMSnExp (XCMS v3) objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Visualizing Chromatographic Peaks","text":"","code":"library(xcms) library(ggplot2) library(plotly) library(faahKO) library(MsExperiment) library(BiocParallel) library(xcmsVis)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Visualizing Chromatographic Peaks","text":"‚Äôll use faahKO package example data:","code":"# Get example CDF files cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                   recursive = TRUE, full.names = TRUE)[1:3]  # Load data as XcmsExperiment xdata <- readMsExperiment(   spectraFiles = cdf_files,   BPPARAM = SerialParam() )  # Add sample metadata sampleData(xdata)$sample_name <- basename(cdf_files) sampleData(xdata)$sample_group <- c(\"KO\", \"KO\", \"WT\") # Detect peaks using CentWave algorithm cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Check number of peaks detected cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 6535"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"peak-detection","dir":"Articles","previous_headings":"","what":"Peak Detection","title":"Visualizing Chromatographic Peaks","text":"","code":"# Detect peaks using CentWave algorithm cwp <- CentWaveParam(   peakwidth = c(20, 80),   ppm = 25 ) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Check number of peaks detected cat(\"Total peaks detected:\", nrow(chromPeaks(xdata)), \"\\n\") #> Total peaks detected: 6535"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeaks-peak-distribution-visualization","dir":"Articles","previous_headings":"","what":"gplotChromPeaks: Peak Distribution Visualization","title":"Visualizing Chromatographic Peaks","text":"gplotChromPeaks() function creates scatter plot showing detected peaks rectangles retention time vs m/z space.","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) # ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1) # Customize colors and styling p1 +   labs(     title = \"Detected Peaks - Sample 1\",     x = \"Retention Time (s)\",     y = \"m/z\"   ) +   theme_minimal() # Focus on a specific RT and m/z region p2 <- gplotChromPeaks(   xdata,   file = 1,   xlim = c(3500,3800),    ylim = c(240,260),   border = \"darkblue\",   fill = \"lightblue\" ) print(p2) # Compare peak distributions across samples library(patchwork) p_s1 <- gplotChromPeaks(xdata, file = 1) + labs(title = \"Sample 1 (KO)\") p_s2 <- gplotChromPeaks(xdata, file = 2) + labs(title = \"Sample 2 (KO)\") p_s3 <- gplotChromPeaks(xdata, file = 3) + labs(title = \"Sample 3 (WT)\")  p_s1 + p_s2 + p_s3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) # ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version","dir":"Articles","previous_headings":"gplotChromPeaks: Peak Distribution Visualization","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version","dir":"Articles","previous_headings":"gplotChromPeaks: Peak Distribution Visualization","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p1 <- gplotChromPeaks(xdata, file = 1, xlim = c(3500,3800), , ylim = c(240,260)) print(p1)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"customizing-the-plot","dir":"Articles","previous_headings":"","what":"Customizing the Plot","title":"Visualizing Chromatographic Peaks","text":"","code":"# Customize colors and styling p1 +   labs(     title = \"Detected Peaks - Sample 1\",     x = \"Retention Time (s)\",     y = \"m/z\"   ) +   theme_minimal()"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"focusing-on-a-region","dir":"Articles","previous_headings":"","what":"Focusing on a Region","title":"Visualizing Chromatographic Peaks","text":"","code":"# Focus on a specific RT and m/z region p2 <- gplotChromPeaks(   xdata,   file = 1,   xlim = c(3500,3800),    ylim = c(240,260),   border = \"darkblue\",   fill = \"lightblue\" ) print(p2)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"comparing-multiple-samples","dir":"Articles","previous_headings":"","what":"Comparing Multiple Samples","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare peak distributions across samples library(patchwork) p_s1 <- gplotChromPeaks(xdata, file = 1) + labs(title = \"Sample 1 (KO)\") p_s2 <- gplotChromPeaks(xdata, file = 2) + labs(title = \"Sample 2 (KO)\") p_s3 <- gplotChromPeaks(xdata, file = 3) + labs(title = \"Sample 3 (WT)\")  p_s1 + p_s2 + p_s3"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplotchrompeakimage-peak-density-heatmap","dir":"Articles","previous_headings":"","what":"gplotChromPeakImage: Peak Density Heatmap","title":"Visualizing Chromatographic Peaks","text":"gplotChromPeakImage() function creates heatmap showing number detected peaks per sample across retention time bins.     default, gplotChromPeakImage() uses viridis color scale (reversed higher values darker, matching original XCMS behavior). Viridis perceptually uniform colorblind-friendly. can customize color palette suit needs:  can also use ggplot2 color scales:","code":"# Base R graphics version plotChromPeakImage(xdata, binSize = 30) # ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3) # Compare different bin sizes p_b15 <- gplotChromPeakImage(xdata, binSize = 15) +   labs(title = \"Bin Size: 15s\") p_b30 <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Bin Size: 30s\") p_b60 <- gplotChromPeakImage(xdata, binSize = 60) +   labs(title = \"Bin Size: 60s\")  p_b15 + p_b30 + p_b60 # Compare linear vs log scale p_linear <- gplotChromPeakImage(xdata, log_transform = FALSE) +   labs(title = \"Linear Scale\") p_log <- gplotChromPeakImage(xdata, log_transform = TRUE) +   labs(title = \"Log2 Scale\")  p_linear + p_log # Different viridis palettes p_magma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"magma\", direction = -1, name = \"count\") +   labs(title = \"Magma palette\")  p_plasma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"plasma\", direction = -1, name = \"count\") +   labs(title = \"Plasma palette\")  p_inferno <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"inferno\", direction = -1, name = \"count\") +   labs(title = \"Inferno palette\")  p_magma / p_plasma / p_inferno # Custom gradient p_gradient <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_gradient(low = \"white\", high = \"darkblue\", name = \"count\") +   labs(title = \"Custom gradient\")  # Color Brewer palette p_brewer <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_distiller(palette = \"RdYlBu\", name = \"count\") +   labs(title = \"RdYlBu palette\")  p_gradient + p_brewer # Make it interactive ggplotly(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"basic-usage-1","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeakImage(xdata, binSize = 30) # ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-1","dir":"Articles","previous_headings":"gplotChromPeakImage: Peak Density Heatmap","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version plotChromPeakImage(xdata, binSize = 30)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-1","dir":"Articles","previous_headings":"gplotChromPeakImage: Peak Density Heatmap","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version p3 <- gplotChromPeakImage(xdata, binSize = 30) print(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"with-different-bin-sizes","dir":"Articles","previous_headings":"","what":"With Different Bin Sizes","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare different bin sizes p_b15 <- gplotChromPeakImage(xdata, binSize = 15) +   labs(title = \"Bin Size: 15s\") p_b30 <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Bin Size: 30s\") p_b60 <- gplotChromPeakImage(xdata, binSize = 60) +   labs(title = \"Bin Size: 60s\")  p_b15 + p_b30 + p_b60"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"log-transformed-view","dir":"Articles","previous_headings":"","what":"Log-Transformed View","title":"Visualizing Chromatographic Peaks","text":"","code":"# Compare linear vs log scale p_linear <- gplotChromPeakImage(xdata, log_transform = FALSE) +   labs(title = \"Linear Scale\") p_log <- gplotChromPeakImage(xdata, log_transform = TRUE) +   labs(title = \"Log2 Scale\")  p_linear + p_log"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"custom-color-scales","dir":"Articles","previous_headings":"","what":"Custom Color Scales","title":"Visualizing Chromatographic Peaks","text":"default, gplotChromPeakImage() uses viridis color scale (reversed higher values darker, matching original XCMS behavior). Viridis perceptually uniform colorblind-friendly. can customize color palette suit needs:  can also use ggplot2 color scales:","code":"# Different viridis palettes p_magma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"magma\", direction = -1, name = \"count\") +   labs(title = \"Magma palette\")  p_plasma <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"plasma\", direction = -1, name = \"count\") +   labs(title = \"Plasma palette\")  p_inferno <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_viridis_c(option = \"inferno\", direction = -1, name = \"count\") +   labs(title = \"Inferno palette\")  p_magma / p_plasma / p_inferno # Custom gradient p_gradient <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_gradient(low = \"white\", high = \"darkblue\", name = \"count\") +   labs(title = \"Custom gradient\")  # Color Brewer palette p_brewer <- gplotChromPeakImage(xdata, binSize = 30) +   scale_fill_distiller(palette = \"RdYlBu\", name = \"count\") +   labs(title = \"RdYlBu palette\")  p_gradient + p_brewer"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"interactive-version","dir":"Articles","previous_headings":"","what":"Interactive Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Make it interactive ggplotly(p3)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"chromatogram-plotting-gplot-and-ghighlightchrompeaks","dir":"Articles","previous_headings":"","what":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","title":"Visualizing Chromatographic Peaks","text":"xcmsVis provides two approaches plotting chromatograms: gplot(XChromatogram) - Complete chromatogram plot detected peaks automatically marked (equivalent plot()) ghighlightChromPeaks() - Composable layers adding peak annotations existing plots First, let‚Äôs extract chromatogram specific m/z range:   control, ghighlightChromPeaks() returns ggplot2 layers can added chromatogram plot:","code":"# Extract chromatogram for m/z 200-210 mz_range <- c(200, 210) rt_range <- c(2500, 3500)  # Get chromatogram data chr <- chromatogram(xdata, mz = mz_range, rt = rt_range) # Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\") # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\") # Base R graphics version - plot then add highlights plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"), rt = rt_range, mz = mz_range,                    border = \"red\", col = adjustcolor(\"red\", alpha.f = 0.2)) # Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(   chr[1, 1],   type = \"rect\",   border = \"red\",   fill = alpha(\"red\", 0.2) )  # Combine base plot with peak annotations p_chrom + peak_layers # Type: Point (marks peak apex) p_point <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Points\", x = \"RT (s)\", y = \"Intensity\")  peak_points <- ghighlightChromPeaks(   chr[1, 1],   type = \"point\",   border = \"red\" )  # Type: Polygon (follows peak shape) p_poly <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Polygons\", x = \"RT (s)\", y = \"Intensity\")  peak_polygons <- ghighlightChromPeaks(   chr[1, 1],   type = \"polygon\",   border = \"blue\",   fill = alpha(\"blue\", 0.3) )  # Display all three types (p_chrom + peak_layers) / (p_point + peak_points) / (p_poly + peak_polygons) # whichPeaks: \"any\" - peaks that overlap the range p_any <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'any'\", x = \"RT (s)\", y = \"Intensity\")  peaks_any <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"any\", border = \"red\", fill = alpha(\"red\", 0.2) )  # whichPeaks: \"within\" - peaks fully within the range p_within <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_within <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"within\", border = \"blue\", fill = alpha(\"blue\", 0.2) )  # whichPeaks: \"apex_within\" - peaks with apex in range p_apex <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'apex_within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_apex <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"apex_within\", border = \"green\", fill = alpha(\"green\", 0.2) )  # Display comparison (p_any + peaks_any) / (p_within + peaks_within) / (p_apex + peaks_apex)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"gplot-automatic-chromatogram-plotting","dir":"Articles","previous_headings":"","what":"gplot(): Automatic Chromatogram Plotting","title":"Visualizing Chromatographic Peaks","text":"First, let‚Äôs extract chromatogram specific m/z range:","code":"# Extract chromatogram for m/z 200-210 mz_range <- c(200, 210) rt_range <- c(2500, 3500)  # Get chromatogram data chr <- chromatogram(xdata, mz = mz_range, rt = rt_range) # Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\") # ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-2","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot() automatically shows peaks plot(chr[1, 1], main = \"XCMS plot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-2","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# ggplot2 version - gplot() automatically shows peaks gplot(chr[1, 1]) +   labs(title = \"xcmsVis gplot(XChromatogram)\")"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"ghighlightchrompeaks-composable-layers","dir":"Articles","previous_headings":"","what":"ghighlightChromPeaks(): Composable Layers","title":"Visualizing Chromatographic Peaks","text":"control, ghighlightChromPeaks() returns ggplot2 layers can added chromatogram plot:","code":"# Base R graphics version - plot then add highlights plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"), rt = rt_range, mz = mz_range,                    border = \"red\", col = adjustcolor(\"red\", alpha.f = 0.2)) # Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(   chr[1, 1],   type = \"rect\",   border = \"red\",   fill = alpha(\"red\", 0.2) )  # Combine base plot with peak annotations p_chrom + peak_layers"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"original-xcms-version-3","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"Original XCMS Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Base R graphics version - plot then add highlights plot(chr[1, 1], main = \"XCMS highlightChromPeaks\") highlightChromPeaks(as(xdata, \"XCMSnExp\"), rt = rt_range, mz = mz_range,                    border = \"red\", col = adjustcolor(\"red\", alpha.f = 0.2))"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"xcmsvis-ggplot2-version-3","dir":"Articles","previous_headings":"Chromatogram Plotting: gplot() and ghighlightChromPeaks()","what":"xcmsVis ggplot2 Version","title":"Visualizing Chromatographic Peaks","text":"","code":"# Start with gplot() which creates the chromatogram p_chrom <- gplot(chr[1, 1], peakType = \"none\") +   labs(     title = \"Chromatogram with Highlighted Peaks (Rectangle)\",     x = \"Retention Time (s)\",     y = \"Intensity\"   )  # Add peak highlights as rectangles peak_layers <- ghighlightChromPeaks(   chr[1, 1],   type = \"rect\",   border = \"red\",   fill = alpha(\"red\", 0.2) )  # Combine base plot with peak annotations p_chrom + peak_layers"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"different-visualization-types","dir":"Articles","previous_headings":"","what":"Different Visualization Types","title":"Visualizing Chromatographic Peaks","text":"","code":"# Type: Point (marks peak apex) p_point <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Points\", x = \"RT (s)\", y = \"Intensity\")  peak_points <- ghighlightChromPeaks(   chr[1, 1],   type = \"point\",   border = \"red\" )  # Type: Polygon (follows peak shape) p_poly <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"Peak Annotations: Polygons\", x = \"RT (s)\", y = \"Intensity\")  peak_polygons <- ghighlightChromPeaks(   chr[1, 1],   type = \"polygon\",   border = \"blue\",   fill = alpha(\"blue\", 0.3) )  # Display all three types (p_chrom + peak_layers) / (p_point + peak_points) / (p_poly + peak_polygons)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"peak-selection-criteria","dir":"Articles","previous_headings":"","what":"Peak Selection Criteria","title":"Visualizing Chromatographic Peaks","text":"","code":"# whichPeaks: \"any\" - peaks that overlap the range p_any <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'any'\", x = \"RT (s)\", y = \"Intensity\")  peaks_any <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"any\", border = \"red\", fill = alpha(\"red\", 0.2) )  # whichPeaks: \"within\" - peaks fully within the range p_within <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_within <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"within\", border = \"blue\", fill = alpha(\"blue\", 0.2) )  # whichPeaks: \"apex_within\" - peaks with apex in range p_apex <- gplot(chr[1, 1], peakType = \"none\") +   labs(title = \"whichPeaks = 'apex_within'\", x = \"RT (s)\", y = \"Intensity\")  peaks_apex <- ghighlightChromPeaks(   chr[1, 1], rt = rt_range, mz = mz_range,   whichPeaks = \"apex_within\", border = \"green\", fill = alpha(\"green\", 0.2) )  # Display comparison (p_any + peaks_any) / (p_within + peaks_within) / (p_apex + peaks_apex)"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"combining-multiple-visualizations","dir":"Articles","previous_headings":"","what":"Combining Multiple Visualizations","title":"Visualizing Chromatographic Peaks","text":"can combine functions create comprehensive peak detection summaries:","code":"# Peak distribution for one sample p_dist <- gplotChromPeaks(xdata, file = 1) +   labs(title = \"Peak Distribution - Sample 1\")  # Peak density across all samples p_density <- gplotChromPeakImage(xdata, binSize = 30) +   labs(title = \"Peak Density Across Samples\")  # Combine p_dist / p_density"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Visualizing Chromatographic Peaks","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] patchwork_1.3.2     xcmsVis_0.99.5      MsExperiment_1.12.0 #> [4] ProtGenerics_1.42.0 faahKO_1.50.0       plotly_4.11.0       #> [7] ggplot2_4.0.0       xcms_4.8.0          BiocParallel_1.44.0 #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   rlang_1.1.6                 #>   [3] magrittr_2.0.4              clue_0.3-66                 #>   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0           #>   [7] compiler_4.5.2              vctrs_0.6.5                 #>   [9] reshape2_1.4.4              stringr_1.6.0               #>  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0      #>  [13] crayon_1.5.3                fastmap_1.2.0               #>  [15] XVector_0.50.0              labeling_0.4.3              #>  [17] rmarkdown_2.30              preprocessCore_1.72.0       #>  [19] purrr_1.2.0                 xfun_0.54                   #>  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0              #>  [23] progress_1.2.3              DelayedArray_0.36.0         #>  [25] parallel_4.5.2              prettyunits_1.2.0           #>  [27] cluster_2.1.8.1             R6_2.6.1                    #>  [29] stringi_1.8.7               RColorBrewer_1.1-3          #>  [31] limma_3.66.0                GenomicRanges_1.62.0        #>  [33] Rcpp_1.1.0                  Seqinfo_1.0.0               #>  [35] SummarizedExperiment_1.40.0 iterators_1.0.14            #>  [37] knitr_1.50                  IRanges_2.44.0              #>  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4                #>  [41] igraph_2.2.1                tidyselect_1.2.1            #>  [43] abind_1.4-8                 yaml_2.3.10                 #>  [45] doParallel_1.0.17           codetools_0.2-20            #>  [47] affy_1.88.0                 lattice_0.22-7              #>  [49] tibble_3.3.0                plyr_1.8.9                  #>  [51] Biobase_2.70.0              withr_3.0.2                 #>  [53] S7_0.2.0                    evaluate_1.0.5              #>  [55] Spectra_1.20.0              pillar_1.11.1               #>  [57] affyio_1.80.0               BiocManager_1.30.26         #>  [59] MatrixGenerics_1.22.0       foreach_1.5.2               #>  [61] stats4_4.5.2                MSnbase_2.36.0              #>  [63] MALDIquant_1.22.3           ncdf4_1.24                  #>  [65] generics_0.1.4              S4Vectors_0.48.0            #>  [67] hms_1.1.4                   scales_1.4.0                #>  [69] glue_1.8.0                  MsFeatures_1.18.0           #>  [71] lazyeval_0.2.2              tools_4.5.2                 #>  [73] mzID_1.48.0                 data.table_1.17.8           #>  [75] QFeatures_1.20.0            vsn_3.78.0                  #>  [77] mzR_2.44.0                  fs_1.6.6                    #>  [79] XML_3.99-0.19               grid_4.5.2                  #>  [81] impute_1.84.0               tidyr_1.3.1                 #>  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0          #>  [85] PSMatch_1.14.0              cli_3.6.5                   #>  [87] viridisLite_0.4.2           S4Arrays_1.10.0             #>  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0     #>  [91] pcaMethods_2.2.0            gtable_0.3.6                #>  [93] digest_0.6.37               BiocGenerics_0.56.0         #>  [95] SparseArray_1.10.1          htmlwidgets_1.6.4           #>  [97] farver_2.1.2                htmltools_0.5.8.1           #>  [99] lifecycle_1.0.4             httr_1.4.7                  #> [101] statmod_1.5.1               MASS_7.3-65"},{"path":"https://stanstrup.github.io/xcmsVis/articles/peak-visualization.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Visualizing Chromatographic Peaks","text":"XCMS GitHub Repository: https://github.com/sneumann/xcms Original Feature Request: https://github.com/sneumann/xcms/issues/551 faahKO package: Bioconductor example dataset ggplot2 Documentation: https://ggplot2.tidyverse.org/ plotly R: https://plotly.com/r/","code":""},{"path":"https://stanstrup.github.io/xcmsVis/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Stanstrup Jan. Author, maintainer. Anthropic. Contributor.           Code generated Claude AI","code":""},{"path":"https://stanstrup.github.io/xcmsVis/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jan S (2025). xcmsVis: Modern Visualization XCMS Data. R package version 0.99.5, https://stanstrup.github.io/xcmsVis.","code":"@Manual{,   title = {xcmsVis: Modern Visualization for XCMS Data},   author = {Stanstrup Jan},   year = {2025},   note = {R package version 0.99.5},   url = {https://stanstrup.github.io/xcmsVis}, }"},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":null,"dir":"","previous_headings":"","what":"Future Development Tasks","title":"Future Development Tasks","text":"file contains planned enhancements future work xcmsVis package.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"add-more-plotting-functions","dir":"","previous_headings":"","what":"Add More Plotting Functions","title":"Future Development Tasks","text":"Implement ggplot2 versions additional XCMS plotting functions:","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"priority-1-quality-control","dir":"","previous_headings":"Add More Plotting Functions","what":"Priority 1: Quality Control","title":"Future Development Tasks","text":"mzdevhist: Histogram m/z deviations rtdevhist: Histogram RT deviations mzdevmass: m/z deviation vs.¬†mass correlation (LOESS smoothing) mzdevtime: m/z deviation vs.¬†RT mzdevsample: Bar plot median m/z deviation per sample rtdevsample: Bar plot median RT deviation per sample","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"priority-2-peak-visualization","dir":"","previous_headings":"Add More Plotting Functions","what":"Priority 2: Peak Visualization","title":"Future Development Tasks","text":"Display detected peaks rectangles m/z-RT space Show peak width dimensions Color intensity plot peak counts across RT Support binning log transformation Visualize peaks grouped Show peaks combined features","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"priority-3-chromatograms","dir":"","previous_headings":"Add More Plotting Functions","what":"Priority 3: Chromatograms","title":"Future Development Tasks","text":"‚úÖ gplot() - Plot XChromatogram objects detected peaks (COMPLETED) ‚úÖ ghighlightChromPeaks() - Add peak annotations chromatograms (COMPLETED) gplotEIC() - Extracted ion chromatograms gplotTIC() - Total ion chromatogram gplotBPC() - Base peak chromatogram gplotChromatogramsOverlay() - Compare multiple chromatograms","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"priority-4-additional-visualizations","dir":"","previous_headings":"Add More Plotting Functions","what":"Priority 4: Additional Visualizations","title":"Future Development Tasks","text":"gplotMsData() - Mass spec data display gplotFeatureGroups() - Feature grouping visualization gplotPeaks() - Peak display gplotSpec() - Spectrum plotting gplotScan() - Individual scan plots","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"expand-vignettes","dir":"","previous_headings":"","what":"Expand Vignettes","title":"Future Development Tasks","text":"Add examples new plotting function comparison vignette Interactive plotting plotly: Advanced plotly features customization Quality control workflows: Complete QC pipeline using xcmsVis Complete LC-MS data analysis visualization: End--end workflow Customizing plots: Themes, colors, advanced ggplot2 techniques","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"add-real-data-examples","dir":"","previous_headings":"","what":"Add Real Data Examples","title":"Future Development Tasks","text":"Download example data Metabonaut tutorials Include small example datasets package (inst/extdata/) Create reproducible examples don‚Äôt require external data Add data documentation ?dataset_name","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"improve-testing","dir":"","previous_headings":"","what":"Improve Testing","title":"Future Development Tasks","text":"Create mock XCMSnExp XcmsExperiment objects unit tests Test function parameters thoroughly Add visual regression tests using vdiffr Test plotly interactivity tooltip content Add integration tests real XCMS workflows Increase code coverage >80%","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"documentation-enhancements","dir":"","previous_headings":"","what":"Documentation Enhancements","title":"Future Development Tasks","text":"Add @examples functions Create ‚ÄúGetting Started‚Äù vignette Add comparison tables plotting functions Document best practices interactive visualization Add troubleshooting section README","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"performance-optimization","dir":"","previous_headings":"","what":"Performance Optimization","title":"Future Development Tasks","text":"Profile functions large datasets Optimize data transformation pipelines Consider data.table large data operations Add progress bars long-running operations Implement caching expensive computations","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"interactivity-features","dir":"","previous_headings":"","what":"Interactivity Features","title":"Future Development Tasks","text":"Real-time parameter adjustment Interactive peak picking Dynamic filtering selection Add crosstalk support linked plots Implement plot animations time-series data","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"package-infrastructure","dir":"","previous_headings":"","what":"Package Infrastructure","title":"Future Development Tasks","text":"Set continuous integration testing Add code coverage reporting (codecov) Create pkgdown articles advanced topics Add hex sticker logo Submit CRAN (Bioconductor?) Consider Bioconductor submission","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"integration-with-other-packages","dir":"","previous_headings":"","what":"Integration with Other Packages","title":"Future Development Tasks","text":"Better integration MsFeatures package Support MetaboAnnotation workflows Integration xcms3 new features Support ion mobility data (available XcmsExperiment)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"advanced-features","dir":"","previous_headings":"","what":"Advanced Features","title":"Future Development Tasks","text":"Support faceting sample groups Automatic plot layout multi-panel figures Export functions publication-ready figures Support different color palettes (viridis, ColorBrewer, etc.) Add plot comparison functions (/processing) Implement plot templates common use cases","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"community-and-outreach","dir":"","previous_headings":"","what":"Community and Outreach","title":"Future Development Tasks","text":"Write blog posts package features Present R/Bioconductor conferences Create tutorial videos Engage users GitHub issues Contribute improvements back XCMS applicable","code":""},{"path":"https://stanstrup.github.io/xcmsVis/future_tasks.html","id":"notes","dir":"","previous_headings":"","what":"Notes","title":"Future Development Tasks","text":"Create function R/gplot*.R Add comprehensive roxygen2 documentation Update NAMESPACE Add tests tests/testthat/test-*.R Add examples comparison vignette Update NEWS.md Run devtools::check() Move task file completed_tasks.md done Always maintain compatibility XCMSnExp XcmsExperiment objects Include tooltip text plotly compatibility plotting functions Write clear, concise commit messages Update version number appropriately (MAJOR.MINOR.PATCH)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"xcmsvis","dir":"","previous_headings":"","what":"Modern Visualization for XCMS Data","title":"Modern Visualization for XCMS Data","text":"Modern, interactive visualizations XCMS metabolomics data using ggplot2.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Modern Visualization for XCMS Data","text":"xcmsVis provides ggplot2 implementations XCMS plotting functions, enabling: Modern, publication-ready visualizations Interactive plots plotly integration Consistent styling across plots Full compatibility XCMSnExp XcmsExperiment objects package complements XCMS package reimplementing base graphics plots using ggplot2.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Modern Visualization for XCMS Data","text":"","code":"# Install from GitHub (development version) # devtools::install_github(\"yourusername/xcmsVis\")"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"current-functions","dir":"","previous_headings":"Features","what":"Current Functions","title":"Modern Visualization for XCMS Data","text":"Works XCMSnExp XcmsExperiment objects Interactive tooltips plotly Modern ggplot2 aesthetics","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"planned-functions","dir":"","previous_headings":"Features","what":"Planned Functions","title":"Modern Visualization for XCMS Data","text":"Future releases include ggplot2 versions : - plotQC() - Quality control diagnostics - plotChromPeaks() - Chromatographic peak visualization - plotChromPeakImage() - Peak intensity heatmap - plotChromPeakDensity() - Peak density visualization - plotEIC() - Extracted ion chromatograms - !","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Modern Visualization for XCMS Data","text":"","code":"library(xcmsVis) library(xcms)  # Works with XcmsExperiment (XCMS v4+) xdata <- readMsExperiment(files = mzml_files) # ... perform peak detection, alignment, etc.  # Create retention time adjustment plot p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)  # Make it interactive library(plotly) ggplotly(p, tooltip = \"text\")  # Also works with XCMSnExp (XCMS v3) xdata_v3 <- readMSData(files = mzml_files, mode = \"onDisk\") # ... perform XCMS workflow p <- gplotAdjustedRtime(xdata_v3, color_by = sample_group)"},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"motivation","dir":"","previous_headings":"","what":"Motivation","title":"Modern Visualization for XCMS Data","text":"package addresses need discussed XCMS issue #551 ggplot2-based visualizations can easily made interactive using plotly.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Modern Visualization for XCMS Data","text":"Contributions welcome! Please feel free submit Pull Request.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Modern Visualization for XCMS Data","text":"MIT License - see LICENSE file details","code":""},{"path":"https://stanstrup.github.io/xcmsVis/instructions.html","id":null,"dir":"","previous_headings":"","what":"Current Tasks","title":"Current Tasks","text":"See CLAUDE.md development workflow, conventions, resources. Move remaining functions. Follow recipe. need also get plots Msnbase make ggplot2 implementations work . Use dev-docs roadmap keep updated. Skip functions legacy objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get sample data from XCMS object ‚Äî .get_sample_data","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"Internal helper handle XCMSnExp XcmsExperiment objects","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"","code":".get_sample_data(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"object XCMSnExp XcmsExperiment object","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_sample_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get sample data from XCMS object ‚Äî .get_sample_data","text":"data.frame sample metadata","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get spectra data from XCMS object ‚Äî .get_spectra_data","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"Internal helper extract spectra/feature data XCMSnExp XcmsExperiment objects","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"","code":".get_spectra_data(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"object XCMSnExp XcmsExperiment object","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-get_spectra_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get spectra data from XCMS object ‚Äî .get_spectra_data","text":"data.frame spectra data including retention times","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate XCMS object type ‚Äî .validate_xcms_object","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"Validate XCMS object type","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"","code":".validate_xcms_object(object)"},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"object Object validate","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/dot-validate_xcms_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate XCMS object type ‚Äî .validate_xcms_object","text":"TRUE valid, stops error otherwise","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"Adds chromatographic peak annotations existing chromatogram plots. ggplot2 implementation works XChromatogram objects, highlighting detected peaks rectangles, points, polygons.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"","code":"ghighlightChromPeaks(   object,   rt,   mz,   peakIds = character(),   border = \"#00000040\",   fill = NA,   type = c(\"rect\", \"point\", \"polygon\"),   whichPeaks = c(\"any\", \"within\", \"apex_within\") )  # S4 method for class 'XChromatogram' ghighlightChromPeaks(   object,   rt,   mz,   peakIds = character(),   border = \"#00000040\",   fill = NA,   type = c(\"rect\", \"point\", \"polygon\"),   whichPeaks = c(\"any\", \"within\", \"apex_within\") )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"object XChromatogram object detected peaks. rt Numeric vector length 2 specifying retention time range peak extraction (optional). mz Numeric vector length 2 specifying m/z range peak extraction (optional). peakIds Character vector peak identifiers (rownames chromPeaks) highlight. provided, rt mz ignored. border Color peak borders (default: semi-transparent grey). fill Color peak fills (default: NA). type Character specifying visualization type: \"rect\" (rectangle), \"point\" (apex point), \"polygon\" (peak shape). Default: \"rect\". whichPeaks Character specifying peak selection: \"\" (overlap), \"within\" (fully contained), \"apex_within\" (apex range). Default: \"\".","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"list ggplot2 layer objects can added existing ggplot chromatogram.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"function returns ggplot2 layers (geoms) can added existing chromatogram plot using + operator. Unlike base R version modifies existing plot, returns composable layers.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/ghighlightChromPeaks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of highlightChromPeaks ‚Äî ghighlightChromPeaks","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) #> Loading required package: BiocParallel #>  #> This is xcms version 4.8.0  library(faahKO) library(ggplot2)  # Load and process example data cdf_files <- system.file(\"cdf/KO/ko15.CDF\", package = \"faahKO\") xdata <- xcms::readMsExperiment(spectraFiles = cdf_files) #> Error: 'readMsExperiment' is not an exported object from 'namespace:xcms' xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam()) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'findChromPeaks': object 'xdata' not found  # Extract chromatogram chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'chromatogram': object 'xdata' not found  # Plot and highlight peaks gplot(chr[1, 1]) + ghighlightChromPeaks(chr[1, 1], rt = c(2500, 3500), mz = c(200, 210)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'gplot': object 'chr' not found # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"Creates ggplot2 version chromatogram detected peaks marked. equivalent base R plot() method XChromatogram objects.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"","code":"gplot(x, ...)  # S4 method for class 'XChromatogram' gplot(   x,   col = \"black\",   lty = 1,   type = \"l\",   xlab = \"retention time\",   ylab = \"intensity\",   main = NULL,   peakType = c(\"polygon\", \"point\", \"rectangle\", \"none\"),   peakCol = \"#00000060\",   peakBg = \"#00000020\",   peakPch = 1,   ... )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"x XChromatogram MChromatograms object. ... Additional arguments (compatibility plot). col Color chromatogram line (default: \"black\"). lty Line type chromatogram (default: 1). type Plot type (default: \"l\" line). xlab X-axis label (default: \"retention time\"). ylab Y-axis label (default: \"intensity\"). main Plot title (default: NULL). peakType Type peak annotation: \"polygon\", \"point\", \"rectangle\", \"none\" (default: \"polygon\"). peakCol Color peak markers (default: \"#00000060\"). peakBg Background color peak markers (default: \"#00000020\"). peakPch Point character peak markers peakType = \"point\" (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"ggplot object.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"function creates complete chromatogram plot detected peaks automatically marked, similar base R plot() method XChromatogram objects. chromatogram contains detected peaks, shown according peakType parameter.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plot for XChromatogram ‚Äî gplot","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(ggplot2)  # Load and process example data cdf_files <- system.file(\"cdf/KO/ko15.CDF\", package = \"faahKO\") xdata <- xcms::readMsExperiment(spectraFiles = cdf_files) #> Error: 'readMsExperiment' is not an exported object from 'namespace:xcms' xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam()) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'findChromPeaks': object 'xdata' not found  # Extract chromatogram chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'chromatogram': object 'xdata' not found  # Plot with ggplot2 gplot(chr[1, 1]) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'gplot': object 'chr' not found # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"Visualizes retention time correction plotting difference adjusted raw retention times across samples. ggplot2 implementation XCMS's plotAdjustedRtime() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"","code":"gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )  # S4 method for class 'XCMSnExp' gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )  # S4 method for class 'XcmsExperiment' gplotAdjustedRtime(   object,   color_by,   include_columns = NULL,   adjustedRtime = TRUE )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"object XCMSnExp XcmsExperiment object retention time adjustment results. color_by Column name sample metadata use coloring lines. provided unquoted column name (e.g., sample_group). XCMSnExp objects, comes pData(object). XcmsExperiment objects, comes sampleData(object). include_columns Character vector column names sample metadata include tooltip text. NULL (default), columns included. adjustedRtime Logical, whether use adjusted retention times x-axis. Default TRUE.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"ggplot object showing retention time adjustment. line represents one sample, grey points/lines show peak groups used alignment (using PeakGroupsParam).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"function: Plots adjusted RT vs. difference (adjusted RT - raw RT) Shows one line per sample colored specified variable Overlays peak groups used alignment (grey circles dashed lines) Includes tooltip-ready text interactive plotting plotly grey circles represent individual peaks used alignment, grey dashed lines connect peaks feature across samples.","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotAdjustedRtime.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotAdjustedRtime ‚Äî gplotAdjustedRtime","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) #> Loading required package: ProtGenerics #>  #> Attaching package: ‚ÄòProtGenerics‚Äô #> The following object is masked from ‚Äòpackage:stats‚Äô: #>  #>     smooth library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform basic workflow xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) MsExperiment::sampleData(xdata)$sample_group <- c(\"KO\", \"KO\", \"WT\")  # Peak detection cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Peak grouping pdp <- PeakDensityParam(sampleGroups = c(\"KO\", \"KO\", \"WT\"),                         minFraction = 0.4, bw = 30) xdata <- groupChromPeaks(xdata, param = pdp)  # Retention time adjustment pgp <- PeakGroupsParam(minFraction = 0.4) xdata <- adjustRtime(xdata, param = pgp) #> Performing retention time alignment using 882 anchor peaks.  # Create plot p <- gplotAdjustedRtime(xdata, color_by = sample_group) print(p)  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"Creates image/heatmap showing number detected chromatographic peaks per sample across retention time bins. ggplot2 implementation XCMS's plotChromPeakImage() function.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"","code":"gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )  # S4 method for class 'XCMSnExp' gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )  # S4 method for class 'XcmsExperiment' gplotChromPeakImage(   object,   binSize = 30,   xlim = NULL,   log_transform = FALSE,   msLevel = 1L )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"object XCMSnExp XcmsExperiment object detected chromatographic peaks. binSize Numeric value specifying bin size seconds retention time axis (default: 30). xlim Numeric vector length 2 specifying retention time range. NULL (default), uses full retention time range. log_transform Logical, whether log2-transform peak counts (default: FALSE). msLevel Integer specifying MS level (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"ggplot object showing peak counts heatmap retention time x-axis, samples y-axis, color representing peak density.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"function: Bins peaks across retention time using specified bin size Counts peaks per sample per bin Creates heatmap color representing peak density Optionally applies log2 transformation counts","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeakImage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromPeakImage ‚Äî gplotChromPeakImage","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Create plot p <- gplotChromPeakImage(xdata, binSize = 30) print(p)  # }"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"Visualizes identified chromatographic peaks rectangles retention time vs. m/z plane. ggplot2 implementation XCMS's plotChromPeaks() function, enabling modern visualization interactive plotting capabilities.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"","code":"gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )  # S4 method for class 'XCMSnExp' gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )  # S4 method for class 'XcmsExperiment' gplotChromPeaks(   object,   file = 1,   xlim = NULL,   ylim = NULL,   border = \"#00000060\",   fill = NA,   msLevel = 1L )"},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"object XCMSnExp XcmsExperiment object detected chromatographic peaks. file Integer specifying file/sample plot (default: 1). xlim Numeric vector length 2 specifying retention time range. NULL (default), uses full retention time range. ylim Numeric vector length 2 specifying m/z range. NULL (default), uses full m/z range. border Color peak rectangle borders (default: semi-transparent black). fill Color peak rectangle fills (default: NA fill). msLevel Integer specifying MS level (default: 1).","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"ggplot object showing chromatographic peaks rectangles retention time vs. m/z space.","code":""},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"function: Plots peak rectangle spanning rt m/z ranges Uses geom_rect create peak rectangles Supports interactive plotting plotly conversion","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/reference/gplotChromPeaks.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 Version of plotChromPeaks ‚Äî gplotChromPeaks","text":"","code":"# \\donttest{ library(xcmsVis) library(xcms) library(faahKO) library(MsExperiment) library(BiocParallel)  # Load example data cdf_files <- dir(system.file(\"cdf\", package = \"faahKO\"),                  recursive = TRUE, full.names = TRUE)[1:3]  # Create XcmsExperiment and perform peak detection xdata <- readMsExperiment(spectraFiles = cdf_files, BPPARAM = SerialParam()) cwp <- CentWaveParam(peakwidth = c(20, 80), ppm = 25) xdata <- findChromPeaks(xdata, param = cwp, BPPARAM = SerialParam())  # Create plot p <- gplotChromPeaks(xdata, file = 1) print(p)  # }"},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-5","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.5","text":"ensure .nojekyll file created pkgdown site (29eb82c) resolve R CMD check warnings gplot (86345f2) update prepare-news.sh path release workflow (f04ed39)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-4","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.4","text":"highlightChromPeaks works XCMSnExp (ebb1851) refactor gplot ghighlightChromPeaks per code review (14fb0de) remove library(xcmsVis) vignettes R CMD check (0d1aad6) restore library(xcmsVis) vignette (070bae0) reverse viridis scale gplotChromPeakImage match XCMS (049d978)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-4","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.4","text":"add gplot() method XChromatogram objects (9dbbc33)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-3","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.3","text":"constrain version 0.99.x Bioconductor development (5de5bfd) correct NEWS.md use 0.99.x versioning (f0978fd)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-2","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.2","text":"add gplotChromPeaks, gplotChromPeakImage, ghighlightChromPeaks (0893bfa) add SystemRequirements Quarto vignettes (498afc6) add comprehensive vignette peak visualization functions","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-2","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.2","text":"constrain version 0.99.x Bioconductor development convert MsExperiment XcmsExperiment skip peak picking (707aadb) account OnDiskMSnExp get filenames pData. (b1af112) add BiocParallel Suggests fix fileNames import (69fb33e) add missing dplyr::n import utils.R (dd8b918) add Quarto setup GitHub Actions workflows address BiocCheck requirements (b1c4d5f) coerce instead new peakpicking (159c06a) consistency objects (5e52665) correct version ordering NEWS.md (026dbcf) corrected tests. (3b61b79) properly import () methods package (4086c92) remove BPPARAM groupChromPeaks calls (26eec03) remove links NEWS.md headings pkgdown compatibility (8262eec) remove unused methods Imports (358535b) resolve R CMD check warnings (d892e19) use SerialParam tests avoid parallel processing warnings (abbfb4f)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"performance-improvements-0-99-2","dir":"Changelog","previous_headings":"","what":"Performance Improvements","title":"Changes in v0.99.2","text":"use SerialParam vignette faster processing (382f301)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-99-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.99.0","text":"provide spectraOrigin_base matching column names omit files filtered away alignment. (8aceeae) actually working version gplotAdjustedRtime now works XcmsExperiment objects. imports missing. fix later (5f9898c) add groupChromPeaks filterFile tests (73b30f4) add MSnbase Imports fix missing global variables (772346e) correct test fixtures helper functions dual-class support (cf9b1bd) exclude quarto cache R package builds (764d68f) fixed .get_spectra_data ahve columns (75b2b2b) fixed imports gplotAdjustedRtime (39aa2b3) re-add groupChromPeaks filterFile vignette (fe46d99) replace Quarto columns HTML flexbox pkgdown compatibility (646b3ef)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-99-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.99.0","text":"add comprehensive alt-text vignette figures (89a33aa) add comprehensive testing documentation gplotAdjustedRtime (552315e) add helper function get spectra data object types (47038d7)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-2-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.2.0","text":"correct GitHub Actions workflow vignette workflow (6dd52fd)","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-2-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.2.0","text":"add semantic versioning improve package infrastructure (86a0704)","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-1-0","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.1.0","text":"Support XCMSnExp XcmsExperiment objects Add utility functions object type handling (.get_sample_data, .validate_xcms_object) Comprehensive test suite faahKO example data Working vignette executable code examples using faahKO data pkgdown documentation site","code":""},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"bug-fixes-0-1-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"Changes in v0.1.0","text":"Fix vignette use real data instead eval=FALSE examples Update sample metadata extraction handle object types correctly","code":""},{"path":[]},{"path":"https://stanstrup.github.io/xcmsVis/news/index.html","id":"features-0-0-1","dir":"Changelog","previous_headings":"","what":"Features","title":"Changes in v0.0.1","text":"Initial release Implement gplotAdjustedRtime() function ggplot2 visualization retention time adjustment Interactive tooltip support plotly Complete package infrastructure (CI/CD, documentation, tests) Comparison vignette showing XCMS vs xcmsVis approaches","code":""}]
