% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/ghighlightChromPeaks-methods.R
\name{ghighlightChromPeaks}
\alias{ghighlightChromPeaks}
\alias{ghighlightChromPeaks,XCMSnExp-method}
\alias{ghighlightChromPeaks,XcmsExperiment-method}
\title{ggplot2 Version of highlightChromPeaks}
\usage{
ghighlightChromPeaks(
  object,
  rt,
  mz,
  peakIds = character(),
  border = "#00000040",
  fill = NA,
  type = c("rect", "point", "polygon"),
  whichPeaks = c("any", "within", "apex_within")
)

\S4method{ghighlightChromPeaks}{XCMSnExp}(
  object,
  rt,
  mz,
  peakIds = character(),
  border = "#00000040",
  fill = NA,
  type = c("rect", "point", "polygon"),
  whichPeaks = c("any", "within", "apex_within")
)

\S4method{ghighlightChromPeaks}{XcmsExperiment}(
  object,
  rt,
  mz,
  peakIds = character(),
  border = "#00000040",
  fill = NA,
  type = c("rect", "point", "polygon"),
  whichPeaks = c("any", "within", "apex_within")
)
}
\arguments{
\item{object}{An \code{XCMSnExp} or \code{XcmsExperiment} object with detected peaks.}

\item{rt}{Numeric vector of length 2 specifying retention time range for
peak extraction (optional).}

\item{mz}{Numeric vector of length 2 specifying m/z range for peak extraction (optional).}

\item{peakIds}{Character vector of peak identifiers (rownames from chromPeaks)
to highlight. If provided, \code{rt} and \code{mz} are ignored.}

\item{border}{Color for peak borders (default: semi-transparent grey).}

\item{fill}{Color for peak fills (default: NA).}

\item{type}{Character specifying visualization type: "rect" (rectangle),
"point" (apex point), or "polygon" (peak shape). Default: "rect".}

\item{whichPeaks}{Character specifying peak selection: "any" (any overlap),
"within" (fully contained), or "apex_within" (apex in range). Default: "any".}
}
\value{
A list of ggplot2 layer objects that can be added to an existing
ggplot chromatogram.
}
\description{
Adds chromatographic peak annotations to existing chromatogram plots.
This is a ggplot2 implementation that works with XCMSnExp or XcmsExperiment objects,
highlighting detected peaks with rectangles, points, or polygons.
}
\details{
This function returns ggplot2 layers (geoms) that can be added to an
existing chromatogram plot using the \code{+} operator. Unlike the base R
version which modifies an existing plot, this returns composable layers.

Like the original \code{highlightChromPeaks}, this function takes the full
XCMSnExp/XcmsExperiment object and searches ALL peaks across all samples,
then filters by rt/mz. This means it can highlight peaks from multiple
samples. To highlight only peaks from a specific sample, filter the object
first using \code{filterFile()}.
}
\examples{
\donttest{
library(xcmsVis)
library(xcms)
library(faahKO)
library(ggplot2)

# Load and process example data
cdf_files <- system.file("cdf/KO/ko15.CDF", package = "faahKO")
xdata <- xcms::readMsExperiment(spectraFiles = cdf_files)
xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam())

# Extract chromatogram for plotting
chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500))

# Highlight peaks from the full dataset (all samples in xdata)
gplot(chr[1, 1], peakType = "none") +
  ghighlightChromPeaks(xdata, rt = c(2500, 3500), mz = c(200, 210))

# Or filter to single sample first for cleaner visualization
xdata_filtered <- xcms::filterFile(xdata, 1)
gplot(chr[1, 1], peakType = "none") +
  ghighlightChromPeaks(xdata_filtered, rt = c(2500, 3500), mz = c(200, 210))
}

}
\seealso{
\code{\link[xcms]{highlightChromPeaks}} for the original XCMS implementation
}
