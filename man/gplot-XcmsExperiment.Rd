% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gplot-XcmsExperiment-methods.R
\name{gplot,XcmsExperiment-method}
\alias{gplot,XcmsExperiment-method}
\alias{gplot,XCMSnExp-method}
\title{ggplot2 Version of plot for XcmsExperiment and XCMSnExp}
\usage{
\S4method{gplot}{XcmsExperiment}(
  x,
  msLevel = 1L,
  peakCol = "#ff000060",
  col = "grey",
  colramp = grDevices::topo.colors,
  pch = 21,
  main = NULL,
  xlab = "Retention time",
  ...
)

\S4method{gplot}{XCMSnExp}(
  x,
  msLevel = 1L,
  peakCol = "#ff000060",
  col = "grey",
  colramp = grDevices::topo.colors,
  pch = 21,
  main = NULL,
  xlab = "Retention time",
  ...
)
}
\arguments{
\item{x}{XcmsExperiment or XCMSnExp object}

\item{msLevel}{integer(1) MS level to visualize (default: 1)}

\item{peakCol}{character(1) color for peak rectangles (default: "#ff000060")}

\item{col}{character(1) color for point borders (default: "grey")}

\item{colramp}{function color ramp for intensity mapping (default: grDevices::topo.colors)}

\item{pch}{integer(1) point shape (default: 21 = filled circle)}

\item{main}{character vector of titles (one per sample). If NULL, uses sample names.}

\item{xlab}{character(1) x-axis label (default: "Retention time")}

\item{...}{additional arguments (for compatibility)}
}
\value{
A ggplot or patchwork object showing the two-panel visualization.
For single samples, returns a patchwork object with two panels.
For multiple samples, returns a patchwork object with all sample plots stacked.
}
\description{
Creates a two-panel visualization of MS data showing:
\itemize{
\item Upper panel: Base Peak Intensity (BPI) chromatogram vs retention time
\item Lower panel: m/z vs retention time scatter plot with intensity-based coloring
}

This is a ggplot2 implementation of XCMS's \code{plot()} method for MsExperiment objects,
enabling modern visualization and interactive plotting capabilities.
}
\details{
The function:
\itemize{
\item Extracts spectra data filtered by MS level
\item Applies adjusted retention times if available
\item Upper panel: plots BPI (max intensity per retention time) with intensity-colored points
\item Lower panel: plots m/z vs retention time scatter with intensity-colored points
\item Overlays detected peaks as rectangles (if available)
\item Uses consistent color scale across both panels based on intensity
}
}
\examples{
\dontrun{
library(xcmsVis)
library(xcms)
library(MsExperiment)

# Load and filter data
fticr_xdata <- readMSData2(...)
mse <- filterRt(fticr_xdata, rt = c(175, 189)) \%>\%
       filterMzRange(mz = c(106.02, 106.07))

# Plot MS data
gplot(mse)

# With detected peaks
mse_peaks <- findChromPeaks(mse, ...)
gplot(mse_peaks, peakCol = "red")

# Multiple samples
gplot(mse[1:3])
}

}
\seealso{
\code{\link[xcms]{plot,MsExperiment,missing-method}} for the original XCMS implementation
}
