% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AllGenerics.R, R/gplot-LamaParama-methods.R,
%   R/gplot-methods.R
\name{gplot}
\alias{gplot}
\alias{gplot,LamaParama-method}
\alias{gplot,XChromatogram-method}
\alias{gplot,XChromatograms-method}
\alias{gplot,MChromatograms-method}
\title{ggplot2 Version of plot for XChromatogram}
\usage{
gplot(x, ...)

\S4method{gplot}{LamaParama}(x, index = 1L, colPoints = "#00000060", colFit = "#00000080", ...)

\S4method{gplot}{XChromatogram}(
  x,
  col = "black",
  lty = 1,
  type = "l",
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  ...
)

\S4method{gplot}{XChromatograms}(
  x,
  col = "#00000060",
  lty = 1,
  type = "l",
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  ...
)

\S4method{gplot}{MChromatograms}(
  x,
  col = "#00000060",
  lty = 1,
  type = "l",
  peakType = c("polygon", "point", "rectangle", "none"),
  peakCol = "#00000060",
  peakBg = "#00000020",
  peakPch = 1,
  ...
)
}
\arguments{
\item{x}{A \code{LamaParama} object containing retention time alignment parameters and results.}

\item{...}{Additional parameters (currently unused, for S4 compatibility).}

\item{index}{Integer specifying which retention time map to plot (default: 1).}

\item{colPoints}{Color for the matched peak points (default: semi-transparent black).}

\item{colFit}{Color for the fitted model line (default: semi-transparent black).}

\item{col}{Color for the chromatogram line (default: "black").}

\item{lty}{Line type for chromatogram (default: 1).}

\item{type}{Plot type (default: "l" for line).}

\item{peakType}{Type of peak annotation: "polygon", "point", "rectangle", or "none"
(default: "polygon").}

\item{peakCol}{Color for peak markers (default: "#00000060").}

\item{peakBg}{Background color for peak markers (default: "#00000020").}

\item{peakPch}{Point character for peak markers when peakType = "point" (default: 1).}
}
\value{
A ggplot object.

A ggplot object.
}
\description{
Creates a ggplot2 version of a chromatogram with detected peaks marked.
This is equivalent to the base R \code{plot()} method for XChromatogram objects.

Creates a ggplot2 version of the retention time alignment model visualization for LamaParama objects.
LamaParama objects contain parameters and results from landmark-based retention time alignment.
}
\details{
This function creates a complete chromatogram plot with detected peaks
automatically marked, similar to the base R \code{plot()} method for
XChromatogram objects. If the chromatogram contains detected peaks,
they will be shown according to the \code{peakType} parameter.

This function visualizes the retention time alignment model for a specific sample.
The plot shows:
\itemize{
\item Points representing matched chromatographic peaks between the sample and reference
\item A fitted line (loess or GAM) showing the retention time correction model
}

The LamaParama object contains parameters for landmark-based alignment including:
\itemize{
\item \code{method}: The fitting method ("loess" or "gam")
\item \code{span}: Span parameter for loess fitting
\item \code{outlierTolerance}: Tolerance for outlier detection
\item \code{zeroWeight}: Weight for the (0,0) anchor point
\item \code{bs}: Basis function for GAM fitting
\item \code{rtMap}: List of data frames with retention time pairs
}
}
\examples{
\donttest{
library(xcmsVis)
library(xcms)
library(faahKO)
library(MsExperiment)
library(ggplot2)

# Load and process example data
cdf_files <- system.file("cdf/KO/ko15.CDF", package = "faahKO")
xdata <- MsExperiment::readMsExperiment(spectraFiles = cdf_files,
                                        BPPARAM = BiocParallel::SerialParam())
xdata <- xcms::findChromPeaks(xdata, param = xcms::CentWaveParam(),
                               BPPARAM = BiocParallel::SerialParam())

# Extract chromatogram
chr <- xcms::chromatogram(xdata, mz = c(200, 210), rt = c(2500, 3500))

# Plot with ggplot2
gplot(chr[1, 1])
}

\dontrun{
library(xcmsVis)
library(xcms)
library(MsExperiment)

# LamaParama requires a reference dataset with landmarks
# See vignette("04-retention-time-alignment") for complete workflow

# Load reference and test datasets
ref <- loadXcmsData("xmse")
tst <- loadXcmsData("faahko_sub2")

# Extract landmarks from QC samples in reference
f <- sampleData(ref)$sample_type
f[f != "QC"] <- NA
ref_filtered <- filterFeatures(ref, PercentMissingFilter(threshold = 0, f = f))
ref_mz_rt <- featureDefinitions(ref_filtered)[, c("mzmed", "rtmed")]

# Create and apply LamaParama alignment
lama_param <- LamaParama(lamas = ref_mz_rt, method = "loess", span = 0.5)
tst_adjusted <- adjustRtime(tst, param = lama_param)

# Extract LamaParama result for visualization
proc_hist <- processHistory(tst_adjusted, type = xcms:::.PROCSTEP.RTIME.CORRECTION)
lama_result <- proc_hist[[length(proc_hist)]]@param

# Visualize the first sample's alignment
gplot(lama_result, index = 1)
}

}
\seealso{
\code{\link[xcms]{plot,XChromatogram,ANY-method}} for the original XCMS implementation

\code{\link[xcms]{LamaParama}} for the parameter class.
}
