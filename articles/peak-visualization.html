<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Chromatographic Peaks • xcmsVis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="peak-visualization_files/libs/quarto-html/popper.min.js"></script><script src="peak-visualization_files/libs/quarto-html/tippy.umd.min.js"></script><link href="peak-visualization_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="peak-visualization_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="peak-visualization_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="peak-visualization_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="peak-visualization_files/libs/plotly-binding-4.11.0/plotly.js"></script><script src="peak-visualization_files/libs/typedarray-0.1/typedarray.min.js"></script><link href="peak-visualization_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="peak-visualization_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="peak-visualization_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="peak-visualization_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualizing Chromatographic Peaks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xcmsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/gplotAdjustedRtime.html">gplotAdjustedRtime - Retention Time Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/peak-visualization.html">Peak Visualization Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stanstrup/xcmsVis" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualizing Chromatographic Peaks</h1>

      <p class="author">xcmsVis Package</p>
      <p class="date">2025-11-05</p>

      <small class="dont-index">Source: <a href="https://github.com/stanstrup/xcmsVis/blob/main/vignettes/peak-visualization.qmd" class="external-link"><code>vignettes/peak-visualization.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates three ggplot2-based functions for visualizing chromatographic peaks in LC-MS metabolomics data:</p>
<ul>
<li>
<strong><code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code></strong>: Visualize detected peaks as rectangles in RT vs m/z space</li>
<li>
<strong><code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code></strong>: Heatmap showing peak density across samples and retention time</li>
<li>
<strong><code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code></strong>: Add peak annotations to existing chromatogram plots</li>
</ul>
<p>All functions work with both <code>XcmsExperiment</code> (XCMS v4+) and <code>XCMSnExp</code> (XCMS v3) objects.</p>
</section><section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stanstrup.github.io/xcmsVis">xcmsVis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>We’ll use the faahKO package example data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get example CDF files</span></span>
<span><span class="va">cdf_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>,</span>
<span>                  recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Load data as XcmsExperiment</span></span>
<span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span></span>
<span>  spectraFiles <span class="op">=</span> <span class="va">cdf_files</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add sample metadata</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">cdf_files</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"WT"</span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level2"><h3 id="peak-detection">Peak Detection<a class="anchor" aria-label="anchor" href="#peak-detection"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Detect peaks using CentWave algorithm</span></span>
<span><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span></span>
<span>  peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="op">)</span></span>
<span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, param <span class="op">=</span> <span class="va">cwp</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check number of peaks detected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total peaks detected:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total peaks detected: 6535</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="gplotchrompeaks-peak-distribution-visualization">gplotChromPeaks: Peak Distribution Visualization<a class="anchor" aria-label="anchor" href="#gplotchrompeaks-peak-distribution-visualization"></a>
</h2>
<p>The <code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code> function creates a scatter plot showing detected peaks as rectangles in retention time vs m/z space.</p>
<section class="level2"><h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<div class="row">
<section class="level3 col-md-6"><h4 id="original-xcms-version">Original XCMS Version<a class="anchor" aria-label="anchor" href="#original-xcms-version"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base R graphics version</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/plotChromPeaks.html" class="external-link">plotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/original_chrompeaks-1.png" alt="XCMS plotChromPeaks showing detected peaks as rectangles in RT vs m/z space for the first sample. Each rectangle represents a chromatographic peak with its boundaries defined by retention time (x-axis) and m/z range (y-axis)." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3 col-md-6"><h4 id="xcmsvis-ggplot2-version">xcmsVis ggplot2 Version<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2-version"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot2 version</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/ggplot_chrompeaks-1.png" alt="ggplot2 version showing detected peaks as semi-transparent rectangles in RT vs m/z space. Modern styling with customizable aesthetics for publication-ready figures." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section><section class="level2"><h3 id="customizing-the-plot">Customizing the Plot<a class="anchor" aria-label="anchor" href="#customizing-the-plot"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customize colors and styling</span></span>
<span><span class="va">p1</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Detected Peaks - Sample 1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"m/z"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/custom_chrompeaks-1.png" alt="Customized chromatographic peaks plot with blue borders and light blue fill, minimal theme. Title reads 'Detected Peaks - Sample 1' with clear axis labels for retention time and m/z." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="focusing-on-a-region">Focusing on a Region<a class="anchor" aria-label="anchor" href="#focusing-on-a-region"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Focus on a specific RT and m/z region</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  file <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">3500</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">600</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/zoom_chrompeaks-1.png" alt="Zoomed view of chromatographic peaks in the m/z range 200-600 and retention time 2500-3500s. Detailed view allows inspection of peak distributions in specific regions of interest." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="comparing-multiple-samples">Comparing Multiple Samples<a class="anchor" aria-label="anchor" href="#comparing-multiple-samples"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare peak distributions across samples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 1 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 2 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 3 (WT)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_s1</span> <span class="op">+</span> <span class="va">p_s2</span> <span class="op">+</span> <span class="va">p_s3</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/compare_samples-1.png" alt="Side-by-side comparison of peak distributions across three samples (two KO and one WT). Each panel shows peaks as rectangles in RT vs m/z space, enabling visual comparison of peak detection consistency." width="960"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="gplotchrompeakimage-peak-density-heatmap">gplotChromPeakImage: Peak Density Heatmap<a class="anchor" aria-label="anchor" href="#gplotchrompeakimage-peak-density-heatmap"></a>
</h2>
<p>The <code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code> function creates a heatmap showing the number of detected peaks per sample across retention time bins.</p>
<section class="level2"><h3 id="basic-usage-1">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage-1"></a>
</h3>
<div class="row">
<section class="level3 col-md-6"><h4 id="original-xcms-version-1">Original XCMS Version<a class="anchor" aria-label="anchor" href="#original-xcms-version-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base R graphics version</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/plotChromPeaks.html" class="external-link">plotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/original_peakimage-1.png" alt="XCMS plotChromPeakImage showing peak density heatmap with retention time on x-axis and samples on y-axis. Color intensity represents the number of peaks detected in each time bin for each sample." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3 col-md-6"><h4 id="xcmsvis-ggplot2-version-1">xcmsVis ggplot2 Version<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2-version-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggplot2 version</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/ggplot_peakimage-1.png" alt="Modern ggplot2 heatmap of peak density using viridis color scale. Retention time bins on x-axis, samples on y-axis, with color intensity indicating peak counts per bin." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section><section class="level2"><h3 id="with-different-bin-sizes">With Different Bin Sizes<a class="anchor" aria-label="anchor" href="#with-different-bin-sizes"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different bin sizes</span></span>
<span><span class="va">p_b15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 15s"</span><span class="op">)</span></span>
<span><span class="va">p_b30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 30s"</span><span class="op">)</span></span>
<span><span class="va">p_b60</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 60s"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_b15</span> <span class="op">+</span> <span class="va">p_b30</span> <span class="op">+</span> <span class="va">p_b60</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/different_bins-1.png" alt="Comparison of peak density heatmaps using different bin sizes (15s, 30s, 60s). Smaller bins show finer detail while larger bins provide smoother overview of peak distribution patterns." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="log-transformed-view">Log-Transformed View<a class="anchor" aria-label="anchor" href="#log-transformed-view"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare linear vs log scale</span></span>
<span><span class="va">p_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear Scale"</span><span class="op">)</span></span>
<span><span class="va">p_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Log2 Scale"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_linear</span> <span class="op">+</span> <span class="va">p_log</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/log_transform-1.png" alt="Comparison of linear and log2-transformed peak density heatmaps. Log transformation reveals patterns in low-intensity regions that may be obscured in the linear scale." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="interactive-version">Interactive Version<a class="anchor" aria-label="anchor" href="#interactive-version"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make it interactive</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-48b9b7fa61aeb9ba93d6" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-48b9b7fa61aeb9ba93d6">{"x":{"data":[{"x":[2516,2546,2576,2606,2636,2666,2696,2726,2756,2786,2816,2846,2876,2906,2936,2966,2996,3026,3056,3086,3116,3146,3176,3206,3236,3266,3296,3326,3356,3386,3416,3446,3476,3506,3536,3566,3596,3626,3656,3686,3716,3746,3776,3806,3836,3866,3896,3926,3956,3986,4016,4046,4076,4106,4136,4166,4196,4226,4256,4286,4316,4346,4376,4406,4436,4466,4496],"y":[1,2,3],"z":[[0.57943925233644855,0.37383177570093457,0.23364485981308411,0.29906542056074764,0.21495327102803738,0.28037383177570091,0.37383177570093457,0.27102803738317754,0.21495327102803738,0.53271028037383172,0.24299065420560748,0.14953271028037382,0.25233644859813081,0.44859813084112149,0.35514018691588783,0.20560747663551401,0.23364485981308411,0.27102803738317754,0.15887850467289719,0.24299065420560748,0.19626168224299065,0.17757009345794392,0.26168224299065418,0.29906542056074764,0.29906542056074764,0.3644859813084112,0.23364485981308411,0.29906542056074764,0.3364485981308411,0.37383177570093457,0.38317757009345793,0.50467289719626163,0.28971962616822428,0.60747663551401865,0.41121495327102803,0.14953271028037382,0.26168224299065418,0.30841121495327101,0.42990654205607476,0.32710280373831774,0.51401869158878499,0.23364485981308411,0.17757009345794392,0.21495327102803738,0.23364485981308411,0.35514018691588783,0.16822429906542055,0.31775700934579437,0.18691588785046728,0.25233644859813081,0.26168224299065418,0.22429906542056074,0.25233644859813081,0.47663551401869159,0.66355140186915884,0.30841121495327101,0.16822429906542055,0.15887850467289719,0.046728971962616821,0.0093457943925233638,0.037383177570093455,0.065420560747663545,0.018691588785046728,0.0093457943925233638,0.028037383177570093,0,0.065420560747663545],[0.42056074766355139,0.28971962616822428,0.26168224299065418,0.25233644859813081,0.30841121495327101,0.24299065420560748,0.43925233644859812,0.28037383177570091,0.22429906542056074,0.37383177570093457,0.21495327102803738,0.16822429906542055,0.38317757009345793,0.7009345794392523,0.67289719626168221,0.35514018691588783,0.3644859813084112,0.19626168224299065,0.16822429906542055,0.19626168224299065,0.25233644859813081,0.22429906542056074,0.38317757009345793,0.28971962616822428,0.30841121495327101,0.44859813084112149,0.34579439252336447,0.45794392523364486,0.28971962616822428,0.38317757009345793,0.48598130841121495,0.55140186915887845,0.45794392523364486,0.68224299065420557,0.51401869158878499,0.16822429906542055,0.27102803738317754,0.50467289719626163,0.56074766355140182,0.57009345794392519,0.49532710280373832,0.66355140186915884,0.3364485981308411,0.3644859813084112,0.52336448598130836,0.51401869158878499,0.34579439252336447,0.3644859813084112,0.3925233644859813,0.3925233644859813,0.28037383177570091,0.31775700934579437,0.42990654205607476,0.47663551401869159,1,0.19626168224299065,0.22429906542056074,0.19626168224299065,0.028037383177570093,0.037383177570093455,0.037383177570093455,0.07476635514018691,0.018691588785046728,0.037383177570093455,0.028037383177570093,0.018691588785046728,0.056074766355140186],[0.3644859813084112,0.17757009345794392,0.28037383177570091,0.26168224299065418,0.25233644859813081,0.3925233644859813,0.26168224299065418,0.30841121495327101,0.20560747663551401,0.45794392523364486,0.14018691588785046,0.30841121495327101,0.26168224299065418,0.20560747663551401,0.22429906542056074,0.13084112149532709,0.26168224299065418,0.25233644859813081,0.3364485981308411,0.18691588785046728,0.26168224299065418,0.34579439252336447,0.46728971962616822,0.29906542056074764,0.38317757009345793,0.50467289719626163,0.44859813084112149,0.34579439252336447,0.40186915887850466,0.3925233644859813,0.44859813084112149,0.46728971962616822,0.31775700934579437,0.59813084112149528,0.35514018691588783,0.21495327102803738,0.34579439252336447,0.54205607476635509,0.57943925233644855,0.3925233644859813,0.51401869158878499,0.27102803738317754,0.28037383177570091,0.3925233644859813,0.40186915887850466,0.59813084112149528,0.32710280373831774,0.42990654205607476,0.31775700934579437,0.42056074766355139,0.26168224299065418,0.47663551401869159,0.28971962616822428,0.69158878504672894,0.57009345794392519,0.42990654205607476,0.15887850467289719,0.11214953271028037,0,0.046728971962616821,0.028037383177570093,0.0093457943925233638,0.037383177570093455,0.028037383177570093,0.046728971962616821,0.11214953271028037,0.028037383177570093]],"text":[["rt_center: 2516<br />sample_name: ko18.CDF<br />count:  62","rt_center: 2546<br />sample_name: ko18.CDF<br />count:  40","rt_center: 2576<br />sample_name: ko18.CDF<br />count:  25","rt_center: 2606<br />sample_name: ko18.CDF<br />count:  32","rt_center: 2636<br />sample_name: ko18.CDF<br />count:  23","rt_center: 2666<br />sample_name: ko18.CDF<br />count:  30","rt_center: 2696<br />sample_name: ko18.CDF<br />count:  40","rt_center: 2726<br />sample_name: ko18.CDF<br />count:  29","rt_center: 2756<br />sample_name: ko18.CDF<br />count:  23","rt_center: 2786<br />sample_name: ko18.CDF<br />count:  57","rt_center: 2816<br />sample_name: ko18.CDF<br />count:  26","rt_center: 2846<br />sample_name: ko18.CDF<br />count:  16","rt_center: 2876<br />sample_name: ko18.CDF<br />count:  27","rt_center: 2906<br />sample_name: ko18.CDF<br />count:  48","rt_center: 2936<br />sample_name: ko18.CDF<br />count:  38","rt_center: 2966<br />sample_name: ko18.CDF<br />count:  22","rt_center: 2996<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3026<br />sample_name: ko18.CDF<br />count:  29","rt_center: 3056<br />sample_name: ko18.CDF<br />count:  17","rt_center: 3086<br />sample_name: ko18.CDF<br />count:  26","rt_center: 3116<br />sample_name: ko18.CDF<br />count:  21","rt_center: 3146<br />sample_name: ko18.CDF<br />count:  19","rt_center: 3176<br />sample_name: ko18.CDF<br />count:  28","rt_center: 3206<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3236<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3266<br />sample_name: ko18.CDF<br />count:  39","rt_center: 3296<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3326<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3356<br />sample_name: ko18.CDF<br />count:  36","rt_center: 3386<br />sample_name: ko18.CDF<br />count:  40","rt_center: 3416<br />sample_name: ko18.CDF<br />count:  41","rt_center: 3446<br />sample_name: ko18.CDF<br />count:  54","rt_center: 3476<br />sample_name: ko18.CDF<br />count:  31","rt_center: 3506<br />sample_name: ko18.CDF<br />count:  65","rt_center: 3536<br />sample_name: ko18.CDF<br />count:  44","rt_center: 3566<br />sample_name: ko18.CDF<br />count:  16","rt_center: 3596<br />sample_name: ko18.CDF<br />count:  28","rt_center: 3626<br />sample_name: ko18.CDF<br />count:  33","rt_center: 3656<br />sample_name: ko18.CDF<br />count:  46","rt_center: 3686<br />sample_name: ko18.CDF<br />count:  35","rt_center: 3716<br />sample_name: ko18.CDF<br />count:  55","rt_center: 3746<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3776<br />sample_name: ko18.CDF<br />count:  19","rt_center: 3806<br />sample_name: ko18.CDF<br />count:  23","rt_center: 3836<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3866<br />sample_name: ko18.CDF<br />count:  38","rt_center: 3896<br />sample_name: ko18.CDF<br />count:  18","rt_center: 3926<br />sample_name: ko18.CDF<br />count:  34","rt_center: 3956<br />sample_name: ko18.CDF<br />count:  20","rt_center: 3986<br />sample_name: ko18.CDF<br />count:  27","rt_center: 4016<br />sample_name: ko18.CDF<br />count:  28","rt_center: 4046<br />sample_name: ko18.CDF<br />count:  24","rt_center: 4076<br />sample_name: ko18.CDF<br />count:  27","rt_center: 4106<br />sample_name: ko18.CDF<br />count:  51","rt_center: 4136<br />sample_name: ko18.CDF<br />count:  71","rt_center: 4166<br />sample_name: ko18.CDF<br />count:  33","rt_center: 4196<br />sample_name: ko18.CDF<br />count:  18","rt_center: 4226<br />sample_name: ko18.CDF<br />count:  17","rt_center: 4256<br />sample_name: ko18.CDF<br />count:   5","rt_center: 4286<br />sample_name: ko18.CDF<br />count:   1","rt_center: 4316<br />sample_name: ko18.CDF<br />count:   4","rt_center: 4346<br />sample_name: ko18.CDF<br />count:   7","rt_center: 4376<br />sample_name: ko18.CDF<br />count:   2","rt_center: 4406<br />sample_name: ko18.CDF<br />count:   1","rt_center: 4436<br />sample_name: ko18.CDF<br />count:   3","rt_center: 4466<br />sample_name: ko18.CDF<br />count:   0","rt_center: 4496<br />sample_name: ko18.CDF<br />count:   7"],["rt_center: 2516<br />sample_name: ko16.CDF<br />count:  45","rt_center: 2546<br />sample_name: ko16.CDF<br />count:  31","rt_center: 2576<br />sample_name: ko16.CDF<br />count:  28","rt_center: 2606<br />sample_name: ko16.CDF<br />count:  27","rt_center: 2636<br />sample_name: ko16.CDF<br />count:  33","rt_center: 2666<br />sample_name: ko16.CDF<br />count:  26","rt_center: 2696<br />sample_name: ko16.CDF<br />count:  47","rt_center: 2726<br />sample_name: ko16.CDF<br />count:  30","rt_center: 2756<br />sample_name: ko16.CDF<br />count:  24","rt_center: 2786<br />sample_name: ko16.CDF<br />count:  40","rt_center: 2816<br />sample_name: ko16.CDF<br />count:  23","rt_center: 2846<br />sample_name: ko16.CDF<br />count:  18","rt_center: 2876<br />sample_name: ko16.CDF<br />count:  41","rt_center: 2906<br />sample_name: ko16.CDF<br />count:  75","rt_center: 2936<br />sample_name: ko16.CDF<br />count:  72","rt_center: 2966<br />sample_name: ko16.CDF<br />count:  38","rt_center: 2996<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3026<br />sample_name: ko16.CDF<br />count:  21","rt_center: 3056<br />sample_name: ko16.CDF<br />count:  18","rt_center: 3086<br />sample_name: ko16.CDF<br />count:  21","rt_center: 3116<br />sample_name: ko16.CDF<br />count:  27","rt_center: 3146<br />sample_name: ko16.CDF<br />count:  24","rt_center: 3176<br />sample_name: ko16.CDF<br />count:  41","rt_center: 3206<br />sample_name: ko16.CDF<br />count:  31","rt_center: 3236<br />sample_name: ko16.CDF<br />count:  33","rt_center: 3266<br />sample_name: ko16.CDF<br />count:  48","rt_center: 3296<br />sample_name: ko16.CDF<br />count:  37","rt_center: 3326<br />sample_name: ko16.CDF<br />count:  49","rt_center: 3356<br />sample_name: ko16.CDF<br />count:  31","rt_center: 3386<br />sample_name: ko16.CDF<br />count:  41","rt_center: 3416<br />sample_name: ko16.CDF<br />count:  52","rt_center: 3446<br />sample_name: ko16.CDF<br />count:  59","rt_center: 3476<br />sample_name: ko16.CDF<br />count:  49","rt_center: 3506<br />sample_name: ko16.CDF<br />count:  73","rt_center: 3536<br />sample_name: ko16.CDF<br />count:  55","rt_center: 3566<br />sample_name: ko16.CDF<br />count:  18","rt_center: 3596<br />sample_name: ko16.CDF<br />count:  29","rt_center: 3626<br />sample_name: ko16.CDF<br />count:  54","rt_center: 3656<br />sample_name: ko16.CDF<br />count:  60","rt_center: 3686<br />sample_name: ko16.CDF<br />count:  61","rt_center: 3716<br />sample_name: ko16.CDF<br />count:  53","rt_center: 3746<br />sample_name: ko16.CDF<br />count:  71","rt_center: 3776<br />sample_name: ko16.CDF<br />count:  36","rt_center: 3806<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3836<br />sample_name: ko16.CDF<br />count:  56","rt_center: 3866<br />sample_name: ko16.CDF<br />count:  55","rt_center: 3896<br />sample_name: ko16.CDF<br />count:  37","rt_center: 3926<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3956<br />sample_name: ko16.CDF<br />count:  42","rt_center: 3986<br />sample_name: ko16.CDF<br />count:  42","rt_center: 4016<br />sample_name: ko16.CDF<br />count:  30","rt_center: 4046<br />sample_name: ko16.CDF<br />count:  34","rt_center: 4076<br />sample_name: ko16.CDF<br />count:  46","rt_center: 4106<br />sample_name: ko16.CDF<br />count:  51","rt_center: 4136<br />sample_name: ko16.CDF<br />count: 107","rt_center: 4166<br />sample_name: ko16.CDF<br />count:  21","rt_center: 4196<br />sample_name: ko16.CDF<br />count:  24","rt_center: 4226<br />sample_name: ko16.CDF<br />count:  21","rt_center: 4256<br />sample_name: ko16.CDF<br />count:   3","rt_center: 4286<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4316<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4346<br />sample_name: ko16.CDF<br />count:   8","rt_center: 4376<br />sample_name: ko16.CDF<br />count:   2","rt_center: 4406<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4436<br />sample_name: ko16.CDF<br />count:   3","rt_center: 4466<br />sample_name: ko16.CDF<br />count:   2","rt_center: 4496<br />sample_name: ko16.CDF<br />count:   6"],["rt_center: 2516<br />sample_name: ko15.CDF<br />count:  39","rt_center: 2546<br />sample_name: ko15.CDF<br />count:  19","rt_center: 2576<br />sample_name: ko15.CDF<br />count:  30","rt_center: 2606<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2636<br />sample_name: ko15.CDF<br />count:  27","rt_center: 2666<br />sample_name: ko15.CDF<br />count:  42","rt_center: 2696<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2726<br />sample_name: ko15.CDF<br />count:  33","rt_center: 2756<br />sample_name: ko15.CDF<br />count:  22","rt_center: 2786<br />sample_name: ko15.CDF<br />count:  49","rt_center: 2816<br />sample_name: ko15.CDF<br />count:  15","rt_center: 2846<br />sample_name: ko15.CDF<br />count:  33","rt_center: 2876<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2906<br />sample_name: ko15.CDF<br />count:  22","rt_center: 2936<br />sample_name: ko15.CDF<br />count:  24","rt_center: 2966<br />sample_name: ko15.CDF<br />count:  14","rt_center: 2996<br />sample_name: ko15.CDF<br />count:  28","rt_center: 3026<br />sample_name: ko15.CDF<br />count:  27","rt_center: 3056<br />sample_name: ko15.CDF<br />count:  36","rt_center: 3086<br />sample_name: ko15.CDF<br />count:  20","rt_center: 3116<br />sample_name: ko15.CDF<br />count:  28","rt_center: 3146<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3176<br />sample_name: ko15.CDF<br />count:  50","rt_center: 3206<br />sample_name: ko15.CDF<br />count:  32","rt_center: 3236<br />sample_name: ko15.CDF<br />count:  41","rt_center: 3266<br />sample_name: ko15.CDF<br />count:  54","rt_center: 3296<br />sample_name: ko15.CDF<br />count:  48","rt_center: 3326<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3356<br />sample_name: ko15.CDF<br />count:  43","rt_center: 3386<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3416<br />sample_name: ko15.CDF<br />count:  48","rt_center: 3446<br />sample_name: ko15.CDF<br />count:  50","rt_center: 3476<br />sample_name: ko15.CDF<br />count:  34","rt_center: 3506<br />sample_name: ko15.CDF<br />count:  64","rt_center: 3536<br />sample_name: ko15.CDF<br />count:  38","rt_center: 3566<br />sample_name: ko15.CDF<br />count:  23","rt_center: 3596<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3626<br />sample_name: ko15.CDF<br />count:  58","rt_center: 3656<br />sample_name: ko15.CDF<br />count:  62","rt_center: 3686<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3716<br />sample_name: ko15.CDF<br />count:  55","rt_center: 3746<br />sample_name: ko15.CDF<br />count:  29","rt_center: 3776<br />sample_name: ko15.CDF<br />count:  30","rt_center: 3806<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3836<br />sample_name: ko15.CDF<br />count:  43","rt_center: 3866<br />sample_name: ko15.CDF<br />count:  64","rt_center: 3896<br />sample_name: ko15.CDF<br />count:  35","rt_center: 3926<br />sample_name: ko15.CDF<br />count:  46","rt_center: 3956<br />sample_name: ko15.CDF<br />count:  34","rt_center: 3986<br />sample_name: ko15.CDF<br />count:  45","rt_center: 4016<br />sample_name: ko15.CDF<br />count:  28","rt_center: 4046<br />sample_name: ko15.CDF<br />count:  51","rt_center: 4076<br />sample_name: ko15.CDF<br />count:  31","rt_center: 4106<br />sample_name: ko15.CDF<br />count:  74","rt_center: 4136<br />sample_name: ko15.CDF<br />count:  61","rt_center: 4166<br />sample_name: ko15.CDF<br />count:  46","rt_center: 4196<br />sample_name: ko15.CDF<br />count:  17","rt_center: 4226<br />sample_name: ko15.CDF<br />count:  12","rt_center: 4256<br />sample_name: ko15.CDF<br />count:   0","rt_center: 4286<br />sample_name: ko15.CDF<br />count:   5","rt_center: 4316<br />sample_name: ko15.CDF<br />count:   3","rt_center: 4346<br />sample_name: ko15.CDF<br />count:   1","rt_center: 4376<br />sample_name: ko15.CDF<br />count:   4","rt_center: 4406<br />sample_name: ko15.CDF<br />count:   3","rt_center: 4436<br />sample_name: ko15.CDF<br />count:   5","rt_center: 4466<br />sample_name: ko15.CDF<br />count:  12","rt_center: 4496<br />sample_name: ko15.CDF<br />count:   3"]],"colorscale":[[0,"#440154"],[0.0093457943925233638,"#440656"],[0.018691588785046728,"#450B59"],[0.028037383177570093,"#450F5B"],[0.037383177570093455,"#45135D"],[0.046728971962616821,"#451760"],[0.056074766355140186,"#461A62"],[0.065420560747663545,"#461D64"],[0.07476635514018691,"#462067"],[0.11214953271028037,"#452C70"],[0.13084112149532709,"#453175"],[0.14018691588785046,"#453477"],[0.14953271028037382,"#44367A"],[0.15887850467289719,"#44397C"],[0.16822429906542055,"#433B7F"],[0.17757009345794392,"#433E81"],[0.18691588785046728,"#424084"],[0.19626168224299065,"#414386"],[0.20560747663551401,"#414687"],[0.21495327102803738,"#414888"],[0.22429906542056074,"#404B88"],[0.23364485981308411,"#404D88"],[0.24299065420560748,"#3F4F89"],[0.25233644859813081,"#3F5289"],[0.26168224299065418,"#3E5489"],[0.27102803738317754,"#3D578A"],[0.28037383177570091,"#3D598A"],[0.28971962616822428,"#3C5C8A"],[0.29906542056074764,"#3B5E8B"],[0.30841121495327101,"#3A618B"],[0.31775700934579437,"#39638B"],[0.32710280373831774,"#38658C"],[0.3364485981308411,"#36688C"],[0.34579439252336447,"#356A8C"],[0.35514018691588783,"#346D8D"],[0.3644859813084112,"#326F8D"],[0.37383177570093457,"#30718D"],[0.38317757009345793,"#2E748D"],[0.3925233644859813,"#2C768E"],[0.40186915887850466,"#2A788E"],[0.41121495327102803,"#2B7B8E"],[0.42056074766355139,"#2B7D8D"],[0.42990654205607476,"#2B7F8D"],[0.43925233644859812,"#2B818C"],[0.44859813084112149,"#2C838C"],[0.45794392523364486,"#2C868B"],[0.46728971962616822,"#2C888B"],[0.47663551401869159,"#2C8A8B"],[0.48598130841121495,"#2B8C8A"],[0.49532710280373832,"#2B8F8A"],[0.50467289719626163,"#2B9189"],[0.51401869158878499,"#2A9389"],[0.52336448598130836,"#2A9588"],[0.53271028037383172,"#299888"],[0.54205607476635509,"#299A87"],[0.55140186915887845,"#289C87"],[0.56074766355140182,"#279E86"],[0.57009345794392519,"#26A186"],[0.57943925233644855,"#25A385"],[0.59813084112149528,"#22A884"],[0.60747663551401865,"#29A982"],[0.66355140186915884,"#4BB576"],[0.67289719626168221,"#4FB774"],[0.68224299065420557,"#53B971"],[0.69158878504672894,"#56BA6F"],[0.7009345794392523,"#5ABC6D"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2500],"y":[1],"name":"9ad9b0b12e16e41b98f91fd980bbd041","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#440154"],[0.0033444816053511705,"#440355"],[0.006688963210702341,"#440456"],[0.010033444816053512,"#440656"],[0.013377926421404682,"#450857"],[0.016722408026755852,"#450958"],[0.020066889632107024,"#450B59"],[0.023411371237458192,"#450D5A"],[0.026755852842809364,"#450E5B"],[0.030100334448160532,"#45105B"],[0.033444816053511704,"#45115C"],[0.036789297658862873,"#45135D"],[0.040133779264214048,"#45145E"],[0.043478260869565216,"#45155F"],[0.046822742474916385,"#451760"],[0.050167224080267553,"#451860"],[0.053511705685618728,"#451961"],[0.056856187290969903,"#461A62"],[0.060200668896321065,"#461B63"],[0.06354515050167224,"#461D64"],[0.066889632107023408,"#461E65"],[0.070234113712374577,"#461F65"],[0.073578595317725745,"#462066"],[0.076923076923076913,"#462167"],[0.080267558528428096,"#462268"],[0.083612040133779264,"#462369"],[0.086956521739130432,"#46246A"],[0.090301003344481601,"#46256B"],[0.093645484949832769,"#46266B"],[0.096989966555183951,"#46276C"],[0.10033444816053511,"#46286D"],[0.10367892976588627,"#46296E"],[0.10702341137123746,"#462A6F"],[0.11036789297658862,"#452B70"],[0.11371237458193981,"#452C70"],[0.11705685618729096,"#452D71"],[0.12040133779264213,"#452E72"],[0.12374581939799331,"#452F73"],[0.12709030100334448,"#453074"],[0.13043478260869565,"#453175"],[0.13377926421404682,"#453276"],[0.13712374581939799,"#453377"],[0.14046822742474915,"#453477"],[0.14381270903010032,"#443578"],[0.14715719063545149,"#443679"],[0.15050167224080266,"#44367A"],[0.15384615384615383,"#44377B"],[0.157190635451505,"#44387C"],[0.16053511705685619,"#44397D"],[0.16387959866220736,"#443A7D"],[0.16722408026755853,"#433B7E"],[0.1705685618729097,"#433C7F"],[0.17391304347826086,"#433D80"],[0.17725752508361203,"#433E81"],[0.1806020066889632,"#433F82"],[0.18394648829431437,"#424083"],[0.18729096989966554,"#424184"],[0.19063545150501671,"#424185"],[0.1939799331103679,"#424285"],[0.19732441471571907,"#414386"],[0.20066889632107021,"#414487"],[0.20401337792642138,"#414587"],[0.20735785953177255,"#414687"],[0.21070234113712374,"#414787"],[0.21404682274247491,"#414888"],[0.21739130434782608,"#404988"],[0.22073578595317725,"#404A88"],[0.22408026755852842,"#404A88"],[0.22742474916387961,"#404B88"],[0.23076923076923075,"#404C88"],[0.23411371237458192,"#404D88"],[0.23745819397993309,"#404E88"],[0.24080267558528426,"#3F4F89"],[0.24414715719063546,"#3F5089"],[0.24749163879598662,"#3F5189"],[0.25083612040133779,"#3F5289"],[0.25418060200668896,"#3F5289"],[0.25752508361204013,"#3E5389"],[0.2608695652173913,"#3E5489"],[0.26421404682274247,"#3E5589"],[0.26755852842809363,"#3E568A"],[0.2709030100334448,"#3D578A"],[0.27424749163879597,"#3D588A"],[0.27759197324414714,"#3D598A"],[0.28093645484949831,"#3D598A"],[0.28428093645484948,"#3C5A8A"],[0.28762541806020064,"#3C5B8A"],[0.29096989966555181,"#3C5C8A"],[0.29431438127090298,"#3B5D8A"],[0.29765886287625415,"#3B5E8B"],[0.30100334448160532,"#3B5F8B"],[0.30434782608695649,"#3A5F8B"],[0.30769230769230765,"#3A608B"],[0.31103678929765882,"#3A618B"],[0.31438127090300999,"#39628B"],[0.31772575250836116,"#39638B"],[0.32107023411371238,"#38648B"],[0.32441471571906355,"#38658C"],[0.32775919732441472,"#38658C"],[0.33110367892976589,"#37668C"],[0.33444816053511706,"#37678C"],[0.33779264214046822,"#36688C"],[0.34113712374581939,"#36698C"],[0.34448160535117056,"#356A8C"],[0.34782608695652173,"#356B8C"],[0.35117056856187284,"#346B8C"],[0.35451505016722407,"#346C8D"],[0.35785953177257523,"#336D8D"],[0.3612040133779264,"#326E8D"],[0.36454849498327757,"#326F8D"],[0.36789297658862874,"#31708D"],[0.37123745819397991,"#31718D"],[0.37458193979933108,"#30718D"],[0.37792642140468224,"#2F728D"],[0.38127090301003341,"#2F738D"],[0.38461538461538464,"#2E748E"],[0.38795986622073581,"#2D758E"],[0.39130434782608697,"#2C768E"],[0.39464882943143814,"#2B778E"],[0.39799331103678931,"#2B778E"],[0.40133779264214042,"#2A788E"],[0.40468227424749159,"#2A798E"],[0.40802675585284276,"#2A7A8E"],[0.41137123745819393,"#2B7B8E"],[0.4147157190635451,"#2B7B8D"],[0.41806020066889626,"#2B7C8D"],[0.42140468227424749,"#2B7D8D"],[0.42474916387959866,"#2B7E8D"],[0.42809364548494983,"#2B7F8D"],[0.43143812709030099,"#2B7F8D"],[0.43478260869565216,"#2B808D"],[0.43812709030100333,"#2B818C"],[0.4414715719063545,"#2B828C"],[0.44481605351170567,"#2B838C"],[0.44816053511705684,"#2C838C"],[0.45150501672240806,"#2C848C"],[0.45484949832775923,"#2C858C"],[0.45819397993311034,"#2C868B"],[0.46153846153846151,"#2C878B"],[0.46488294314381268,"#2C878B"],[0.46822742474916385,"#2C888B"],[0.47157190635451501,"#2C898B"],[0.47491638795986618,"#2C8A8B"],[0.47826086956521735,"#2C8B8B"],[0.48160535117056852,"#2B8B8A"],[0.48494983277591969,"#2B8C8A"],[0.48829431438127091,"#2B8D8A"],[0.49163879598662208,"#2B8E8A"],[0.49498327759197325,"#2B8F8A"],[0.49832775919732442,"#2B8F8A"],[0.50167224080267558,"#2B9089"],[0.50501672240802675,"#2B9189"],[0.50836120401337792,"#2B9289"],[0.51170568561872909,"#2B9389"],[0.51505016722408026,"#2A9389"],[0.51839464882943143,"#2A9489"],[0.52173913043478259,"#2A9588"],[0.52508361204013376,"#2A9688"],[0.52842809364548493,"#2A9788"],[0.5317725752508361,"#2A9788"],[0.53511705685618727,"#299888"],[0.53846153846153844,"#299987"],[0.5418060200668896,"#299A87"],[0.54515050167224077,"#299B87"],[0.54849498327759194,"#289B87"],[0.55183946488294311,"#289C87"],[0.55518394648829428,"#289D87"],[0.55852842809364545,"#279E86"],[0.56187290969899661,"#279F86"],[0.56521739130434778,"#27A086"],[0.56856187290969895,"#26A086"],[0.57190635451505012,"#26A186"],[0.57525083612040129,"#26A285"],[0.57859531772575246,"#25A385"],[0.58193979933110362,"#25A485"],[0.58528428093645479,"#24A485"],[0.58862876254180596,"#24A585"],[0.59197324414715713,"#23A684"],[0.5953177257525083,"#23A784"],[0.59866220735785947,"#22A884"],[0.60200668896321063,"#24A884"],[0.6053511705685618,"#27A983"],[0.60869565217391297,"#2AAA82"],[0.61204013377926414,"#2DAA81"],[0.61538461538461531,"#2FAB81"],[0.61872909698996648,"#32AC80"],[0.62207357859531764,"#34AC7F"],[0.62541806020066881,"#36AD7E"],[0.62876254180601998,"#38AE7E"],[0.63210702341137115,"#3AAE7D"],[0.63545150501672232,"#3CAF7C"],[0.6387959866220736,"#3EB07B"],[0.64214046822742477,"#40B07B"],[0.64548494983277593,"#42B17A"],[0.6488294314381271,"#43B279"],[0.65217391304347827,"#45B278"],[0.65551839464882944,"#47B378"],[0.65886287625418061,"#48B477"],[0.66220735785953178,"#4AB476"],[0.66555183946488294,"#4BB575"],[0.66889632107023411,"#4DB675"],[0.67224080267558528,"#4EB674"],[0.67558528428093645,"#50B773"],[0.67892976588628762,"#51B872"],[0.68227424749163879,"#53B971"],[0.68561872909698995,"#54B971"],[0.68896321070234112,"#55BA70"],[0.69230769230769229,"#57BB6F"],[0.69565217391304346,"#58BB6E"],[0.69899665551839452,"#59BC6D"],[0.70234113712374568,"#5BBD6C"],[0.70568561872909685,"#5CBD6C"],[0.70903010033444813,"#5DBE6B"],[0.7123745819397993,"#5EBF6A"],[0.71571906354515047,"#5FBF69"],[0.71906354515050164,"#61C068"],[0.72240802675585281,"#62C167"],[0.72575250836120397,"#63C166"],[0.72909698996655514,"#64C266"],[0.73244147157190631,"#65C365"],[0.73578595317725748,"#66C464"],[0.73913043478260865,"#67C463"],[0.74247491638795982,"#69C562"],[0.74581939799331098,"#6AC661"],[0.74916387959866215,"#6BC660"],[0.75250836120401332,"#6CC75F"],[0.75585284280936449,"#6DC85E"],[0.75919732441471566,"#6EC85D"],[0.76254180602006683,"#6FC95C"],[0.76588628762541799,"#70CA5B"],[0.76923076923076927,"#71CB5A"],[0.77257525083612044,"#72CB59"],[0.77591973244147161,"#73CC58"],[0.77926421404682278,"#74CD57"],[0.78260869565217395,"#75CD56"],[0.78595317725752512,"#76CE55"],[0.78929765886287628,"#77CF54"],[0.79264214046822745,"#78CF53"],[0.79598662207357862,"#79D052"],[0.79933110367892979,"#7AD151"],[0.80267558528428085,"#7CD151"],[0.80602006688963201,"#7FD250"],[0.80936454849498318,"#81D250"],[0.81270903010033435,"#84D34F"],[0.81605351170568552,"#87D34F"],[0.81939799331103669,"#89D34E"],[0.82274247491638786,"#8CD44D"],[0.82608695652173902,"#8ED44D"],[0.82943143812709019,"#91D54C"],[0.83277591973244136,"#93D54C"],[0.83612040133779253,"#95D54B"],[0.83946488294314381,"#98D64B"],[0.84280936454849498,"#9AD64A"],[0.84615384615384615,"#9DD74A"],[0.84949832775919731,"#9FD749"],[0.85284280936454848,"#A1D748"],[0.85618729096989965,"#A3D848"],[0.85953177257525082,"#A6D847"],[0.86287625418060199,"#A8D947"],[0.86622073578595316,"#AAD946"],[0.86956521739130432,"#ACD946"],[0.87290969899665549,"#AFDA45"],[0.87625418060200666,"#B1DA44"],[0.87959866220735783,"#B3DB44"],[0.882943143812709,"#B5DB43"],[0.88628762541806017,"#B7DB42"],[0.88963210702341133,"#BADC42"],[0.8929765886287625,"#BCDC41"],[0.89632107023411367,"#BEDC40"],[0.89966555183946495,"#C0DD40"],[0.90301003344481612,"#C2DD3F"],[0.90635451505016729,"#C4DE3E"],[0.90969899665551845,"#C6DE3E"],[0.91304347826086951,"#C8DE3D"],[0.91638795986622068,"#CBDF3C"],[0.91973244147157185,"#CDDF3B"],[0.92307692307692302,"#CFDF3B"],[0.92642140468227419,"#D1E03A"],[0.92976588628762535,"#D3E039"],[0.93311036789297652,"#D5E038"],[0.93645484949832769,"#D7E138"],[0.93979933110367886,"#D9E137"],[0.94314381270903003,"#DBE136"],[0.9464882943143812,"#DDE235"],[0.94983277591973236,"#DFE234"],[0.95317725752508353,"#E1E233"],[0.9565217391304347,"#E3E333"],[0.95986622073578587,"#E5E332"],[0.96321070234113704,"#E7E331"],[0.96655518394648821,"#E9E430"],[0.96989966555183937,"#EBE42F"],[0.97324414715719065,"#EDE42E"],[0.97658862876254182,"#EFE52D"],[0.97993311036789299,"#F1E52C"],[0.98327759197324416,"#F3E52B"],[0.98662207357859533,"#F5E62A"],[0.98996655518394649,"#F7E629"],[0.99331103678929766,"#F9E627"],[0.99665551839464883,"#FBE726"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"thickness":23.040000000000003,"title":"count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0.0016666666666666668,0.23453271028037381,0.46739875389408092,0.70026479750778814,0.93313084112149525],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":57.716894977168977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Chromatographic peak counts","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2401.0500000000002,4599.9499999999998],"tickmode":"array","ticktext":["2500","3000","3500","4000","4500"],"tickvals":[2500,3000,3500,4000,4500],"categoryorder":"array","categoryarray":["2500","3000","3500","4000","4500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"retention time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["ko18.CDF","ko16.CDF","ko15.CDF"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["ko18.CDF","ko16.CDF","ko15.CDF"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"208530822e60":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"208530822e60","visdat":{"208530822e60":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section class="section level2"><h2 id="ghighlightchrompeaks-annotating-chromatograms">ghighlightChromPeaks: Annotating Chromatograms<a class="anchor" aria-label="anchor" href="#ghighlightchrompeaks-annotating-chromatograms"></a>
</h2>
<p>The <code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code> function adds peak annotations to existing chromatogram plots. It returns ggplot2 layers that can be added to chromatogram visualizations.</p>
<section class="level2"><h3 id="basic-usage-2">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage-2"></a>
</h3>
<p>First, let’s extract a chromatogram for a specific m/z range:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract chromatogram for m/z 200-210</span></span>
<span><span class="va">mz_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">210</span><span class="op">)</span></span>
<span><span class="va">rt_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">3500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get chromatogram data</span></span>
<span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">chromatogram</a></span><span class="op">(</span><span class="va">xdata</span>, mz <span class="op">=</span> <span class="va">mz_range</span>, rt <span class="op">=</span> <span class="va">rt_range</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to data frame for plotting</span></span>
<span><span class="va">chr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now let’s create the base chromatogram plot and add peak annotations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base chromatogram plot</span></span>
<span><span class="va">p_chrom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Chromatogram with Highlighted Peaks (Rectangle)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Intensity"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Add peak highlights as rectangles</span></span>
<span><span class="va">peak_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  chrom_data <span class="op">=</span> <span class="va">chr_data</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine base plot with peak annotations</span></span>
<span><span class="va">p_chrom</span> <span class="op">+</span> <span class="va">peak_layers</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/highlight_rect-1.png" alt="Chromatogram with detected peaks highlighted as semi-transparent rectangles. Base chromatogram shows intensity vs retention time, with rectangles marking peak boundaries from rtmin to rtmax at the peak's maximum intensity." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="different-visualization-types">Different Visualization Types<a class="anchor" aria-label="anchor" href="#different-visualization-types"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Type: Point (marks peak apex)</span></span>
<span><span class="va">p_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Points"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  chrom_data <span class="op">=</span> <span class="va">chr_data</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Polygon (follows peak shape)</span></span>
<span><span class="va">p_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Polygons"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  chrom_data <span class="op">=</span> <span class="va">chr_data</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display all three types</span></span>
<span><span class="op">(</span><span class="va">p_chrom</span> <span class="op">+</span> <span class="va">peak_layers</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_point</span> <span class="op">+</span> <span class="va">peak_points</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_poly</span> <span class="op">+</span> <span class="va">peak_polygons</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/highlight_types-1.png" alt="Three-panel comparison showing different peak annotation styles: rectangles spanning peak width, points at peak apex, and polygons following peak shape. Each method highlights the same detected peaks in different ways." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="peak-selection-criteria">Peak Selection Criteria<a class="anchor" aria-label="anchor" href="#peak-selection-criteria"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># whichPeaks: "any" - peaks that overlap the range</span></span>
<span><span class="va">p_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'any'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>, <span class="va">chr_data</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"any"</span>, border <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "within" - peaks fully within the range</span></span>
<span><span class="va">p_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>, <span class="va">chr_data</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"within"</span>, border <span class="op">=</span> <span class="st">"blue"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "apex_within" - peaks with apex in range</span></span>
<span><span class="va">p_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'apex_within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>, <span class="va">chr_data</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"apex_within"</span>, border <span class="op">=</span> <span class="st">"green"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display comparison</span></span>
<span><span class="op">(</span><span class="va">p_any</span> <span class="op">+</span> <span class="va">peaks_any</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_within</span> <span class="op">+</span> <span class="va">peaks_within</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_apex</span> <span class="op">+</span> <span class="va">peaks_apex</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/peak_selection-1.png" alt="Comparison of three peak selection methods: 'any' (partially overlapping), 'within' (fully contained), and 'apex_within' (apex in range). Each shows different subsets of peaks based on selection criteria." width="768"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="combining-multiple-visualizations">Combining Multiple Visualizations<a class="anchor" aria-label="anchor" href="#combining-multiple-visualizations"></a>
</h2>
<p>You can combine these functions to create comprehensive peak detection summaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Peak distribution for one sample</span></span>
<span><span class="va">p_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Distribution - Sample 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Peak density across all samples</span></span>
<span><span class="va">p_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Density Across Samples"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="va">p_dist</span> <span class="op">/</span> <span class="va">p_density</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="peak-visualization_files/figure-html/combined_view-1.png" alt="Comprehensive peak detection summary combining peak distribution scatter plot and density heatmap. Top panel shows individual peaks in RT vs m/z space, bottom panel shows peak density across samples over time." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="advantages-of-xcmsvis-functions">Advantages of xcmsVis Functions<a class="anchor" aria-label="anchor" href="#advantages-of-xcmsvis-functions"></a>
</h2>
<p><strong>Compared to XCMS base graphics:</strong></p>
<ul>
<li>Modern ggplot2 aesthetics</li>
<li>Easy customization using standard ggplot2 syntax</li>
<li>Interactive plotting via plotly</li>
<li>Consistent with other ggplot2-based visualizations</li>
<li>Publication-ready output</li>
<li>Composable layers (especially <code>ghighlightChromPeaks</code>)</li>
</ul></section><section class="section level2"><h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] patchwork_1.3.2     MsExperiment_1.12.0 ProtGenerics_1.42.0</span></span>
<span><span class="co">#&gt; [4] faahKO_1.50.0       plotly_4.11.0       ggplot2_4.0.0      </span></span>
<span><span class="co">#&gt; [7] xcmsVis_1.1.1       xcms_4.8.0          BiocParallel_1.44.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] DBI_1.2.3                   rlang_1.1.6                </span></span>
<span><span class="co">#&gt;   [3] magrittr_2.0.4              clue_0.3-66                </span></span>
<span><span class="co">#&gt;   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt;   [7] compiler_4.5.2              vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;   [9] reshape2_1.4.4              stringr_1.5.2              </span></span>
<span><span class="co">#&gt;  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0     </span></span>
<span><span class="co">#&gt;  [13] crayon_1.5.3                fastmap_1.2.0              </span></span>
<span><span class="co">#&gt;  [15] XVector_0.50.0              labeling_0.4.3             </span></span>
<span><span class="co">#&gt;  [17] rmarkdown_2.30              preprocessCore_1.72.0      </span></span>
<span><span class="co">#&gt;  [19] purrr_1.1.0                 xfun_0.54                  </span></span>
<span><span class="co">#&gt;  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0             </span></span>
<span><span class="co">#&gt;  [23] progress_1.2.3              DelayedArray_0.36.0        </span></span>
<span><span class="co">#&gt;  [25] parallel_4.5.2              prettyunits_1.2.0          </span></span>
<span><span class="co">#&gt;  [27] cluster_2.1.8.1             R6_2.6.1                   </span></span>
<span><span class="co">#&gt;  [29] stringi_1.8.7               RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;  [31] limma_3.66.0                GenomicRanges_1.62.0       </span></span>
<span><span class="co">#&gt;  [33] Rcpp_1.1.0                  Seqinfo_1.0.0              </span></span>
<span><span class="co">#&gt;  [35] SummarizedExperiment_1.40.0 iterators_1.0.14           </span></span>
<span><span class="co">#&gt;  [37] knitr_1.50                  IRanges_2.44.0             </span></span>
<span><span class="co">#&gt;  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4               </span></span>
<span><span class="co">#&gt;  [41] igraph_2.2.1                tidyselect_1.2.1           </span></span>
<span><span class="co">#&gt;  [43] abind_1.4-8                 yaml_2.3.10                </span></span>
<span><span class="co">#&gt;  [45] doParallel_1.0.17           codetools_0.2-20           </span></span>
<span><span class="co">#&gt;  [47] affy_1.88.0                 lattice_0.22-7             </span></span>
<span><span class="co">#&gt;  [49] tibble_3.3.0                plyr_1.8.9                 </span></span>
<span><span class="co">#&gt;  [51] Biobase_2.70.0              withr_3.0.2                </span></span>
<span><span class="co">#&gt;  [53] S7_0.2.0                    evaluate_1.0.5             </span></span>
<span><span class="co">#&gt;  [55] Spectra_1.20.0              pillar_1.11.1              </span></span>
<span><span class="co">#&gt;  [57] affyio_1.80.0               BiocManager_1.30.26        </span></span>
<span><span class="co">#&gt;  [59] MatrixGenerics_1.22.0       foreach_1.5.2              </span></span>
<span><span class="co">#&gt;  [61] stats4_4.5.2                MSnbase_2.36.0             </span></span>
<span><span class="co">#&gt;  [63] MALDIquant_1.22.3           ncdf4_1.24                 </span></span>
<span><span class="co">#&gt;  [65] generics_0.1.4              S4Vectors_0.48.0           </span></span>
<span><span class="co">#&gt;  [67] hms_1.1.4                   scales_1.4.0               </span></span>
<span><span class="co">#&gt;  [69] glue_1.8.0                  MsFeatures_1.18.0          </span></span>
<span><span class="co">#&gt;  [71] lazyeval_0.2.2              tools_4.5.2                </span></span>
<span><span class="co">#&gt;  [73] mzID_1.48.0                 data.table_1.17.8          </span></span>
<span><span class="co">#&gt;  [75] QFeatures_1.20.0            vsn_3.78.0                 </span></span>
<span><span class="co">#&gt;  [77] mzR_2.44.0                  fs_1.6.6                   </span></span>
<span><span class="co">#&gt;  [79] XML_3.99-0.19               grid_4.5.2                 </span></span>
<span><span class="co">#&gt;  [81] impute_1.84.0               tidyr_1.3.1                </span></span>
<span><span class="co">#&gt;  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0         </span></span>
<span><span class="co">#&gt;  [85] PSMatch_1.14.0              cli_3.6.5                  </span></span>
<span><span class="co">#&gt;  [87] viridisLite_0.4.2           S4Arrays_1.10.0            </span></span>
<span><span class="co">#&gt;  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0    </span></span>
<span><span class="co">#&gt;  [91] pcaMethods_2.2.0            gtable_0.3.6               </span></span>
<span><span class="co">#&gt;  [93] digest_0.6.37               BiocGenerics_0.56.0        </span></span>
<span><span class="co">#&gt;  [95] SparseArray_1.10.1          htmlwidgets_1.6.4          </span></span>
<span><span class="co">#&gt;  [97] farver_2.1.2                htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [99] lifecycle_1.0.4             httr_1.4.7                 </span></span>
<span><span class="co">#&gt; [101] statmod_1.5.1               MASS_7.3-65</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>XCMS GitHub Repository: https://github.com/sneumann/xcms</li>
<li>Original Feature Request: https://github.com/sneumann/xcms/issues/551</li>
<li>faahKO package: Bioconductor example dataset</li>
<li>ggplot2 Documentation: https://ggplot2.tidyverse.org/</li>
<li>plotly for R: https://plotly.com/r/</li>
</ul></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stanstrup Jan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
