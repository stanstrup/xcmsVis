<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step 2: Peak Detection Visualization • xcmsVis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="02-peak-detection_files/libs/quarto-html/popper.min.js"></script><script src="02-peak-detection_files/libs/quarto-html/tippy.umd.min.js"></script><link href="02-peak-detection_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-peak-detection_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="02-peak-detection_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="02-peak-detection_files/libs/plotly-binding-4.11.0/plotly.js"></script><script src="02-peak-detection_files/libs/typedarray-0.1/typedarray.min.js"></script><link href="02-peak-detection_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="02-peak-detection_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Step 2: Peak Detection Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xcmsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.23</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>---------- XCMS Workflow ----------</h6></li>
    <li><a class="dropdown-item" href="../articles/01-raw-data-visualization.html">Step 1: Raw Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/02-peak-detection.html">Step 2: Peak Detection Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/03-peak-correspondence.html">Step 3: Peak Correspondence Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/04-retention-time-alignment.html">Step 4: Retention Time Alignment Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/05-feature-grouping.html">Step 5: Feature Grouping Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stanstrup/xcmsVis" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Step 2: Peak Detection Visualization</h1>

      <p class="author">xcmsVis Package</p>
      <p class="date">2025-11-14</p>

      <small class="dont-index">Source: <a href="https://github.com/stanstrup/xcmsVis/blob/main/vignettes/02-peak-detection.qmd" class="external-link"><code>vignettes/02-peak-detection.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette covers the <strong>second step</strong> in the XCMS metabolomics workflow: <strong>visualizing detected chromatographic peaks</strong>. After running <code><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks()</a></code>, these functions help you:</p>
<ul>
<li>Assess peak detection quality</li>
<li>Visualize peak distribution across samples</li>
<li>Examine individual peak shapes</li>
<li>Annotate chromatograms with detected peaks</li>
</ul>
<section class="level2"><h3 id="xcms-workflow-context">XCMS Workflow Context<a class="anchor" aria-label="anchor" href="#xcms-workflow-context"></a>
</h3>
<pre><code>┌───────────────────────────────┐
│ 1. Raw Data Visualization     │
├───────────────────────────────┤
│ 2. PEAK DETECTION             │ ← YOU ARE HERE
├───────────────────────────────┤
│ 3. Peak Correspondence        │
│ 4. Retention Time Alignment   │
│ 5. Feature Grouping           │
└───────────────────────────────┘</code></pre>
</section><section class="level2"><h3 id="functions-covered">Functions Covered<a class="anchor" aria-label="anchor" href="#functions-covered"></a>
</h3>
<ul>
<li>
<strong><code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code></strong>: Visualize detected peaks as rectangles in RT vs m/z space</li>
<li>
<strong><code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code></strong>: Heatmap showing peak density across samples and retention time</li>
<li>
<strong><code>gplot(XChromatogram)</code></strong>: Plot individual chromatograms with detected peaks</li>
<li>
<strong><code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code></strong>: Add peak annotations to existing chromatogram plots</li>
</ul></section></section><section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stanstrup.github.io/xcmsVis">xcmsVis</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>We’ll use the faahKO package example data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get example CDF files</span></span>
<span><span class="va">cdf_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cdf"</span>, package <span class="op">=</span> <span class="st">"faahKO"</span><span class="op">)</span>,</span>
<span>                  recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Load data as XcmsExperiment</span></span>
<span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span></span>
<span>  spectraFiles <span class="op">=</span> <span class="va">cdf_files</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add sample metadata</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">cdf_files</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"WT"</span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level2"><h3 id="peak-detection">Peak Detection<a class="anchor" aria-label="anchor" href="#peak-detection"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Detect peaks using CentWave algorithm</span></span>
<span><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span></span>
<span>  peakwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>  ppm <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="op">)</span></span>
<span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, param <span class="op">=</span> <span class="va">cwp</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check number of peaks detected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total peaks detected:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total peaks detected: 6535</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="part-1-peak-distribution-visualization">Part 1: Peak Distribution Visualization<a class="anchor" aria-label="anchor" href="#part-1-peak-distribution-visualization"></a>
</h2>
<section class="level2"><h3 id="gplotchrompeaks-peak-rectangles-in-rtmz-space">gplotChromPeaks(): Peak Rectangles in RT/m/z Space<a class="anchor" aria-label="anchor" href="#gplotchrompeaks-peak-rectangles-in-rtmz-space"></a>
</h3>
<p>The <code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code> function creates a scatter plot showing detected peaks as rectangles in retention time vs m/z space.</p>
<section class="level3"><h4 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3500</span>, <span class="fl">3800</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_chrompeaks-1.png" alt="ggplot2 version showing detected peaks as semi-transparent rectangles in RT vs m/z space." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="customizing-the-plot">Customizing the Plot<a class="anchor" aria-label="anchor" href="#customizing-the-plot"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3500</span>, <span class="fl">3800</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Detected Peaks - Sample 1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"m/z"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/custom_chrompeaks-1.png" alt="Customized chromatographic peaks plot with custom styling." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="focusing-on-a-region">Focusing on a Region<a class="anchor" aria-label="anchor" href="#focusing-on-a-region"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Focus on a specific RT and m/z region</span></span>
<span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  file <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3500</span>, <span class="fl">3800</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>, <span class="fl">260</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/zoom_chrompeaks-1.png" alt="Zoomed view of chromatographic peaks in a specific region." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="comparing-multiple-samples">Comparing Multiple Samples<a class="anchor" aria-label="anchor" href="#comparing-multiple-samples"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 1 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 2 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 3 (WT)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_s1</span> <span class="op">+</span> <span class="va">p_s2</span> <span class="op">+</span> <span class="va">p_s3</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/compare_samples-1.png" alt="Side-by-side comparison of peak distributions across three samples." width="960"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="gplotchrompeakimage-peak-density-heatmap">gplotChromPeakImage(): Peak Density Heatmap<a class="anchor" aria-label="anchor" href="#gplotchrompeakimage-peak-density-heatmap"></a>
</h3>
<p>The <code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code> function creates a heatmap showing the number of detected peaks per sample across retention time bins.</p>
<section class="level3"><h4 id="basic-usage-1">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_peakimage-1.png" alt="ggplot2 heatmap of peak density using viridis color scale." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="with-different-bin-sizes">With Different Bin Sizes<a class="anchor" aria-label="anchor" href="#with-different-bin-sizes"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_b15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 15s"</span><span class="op">)</span></span>
<span><span class="va">p_b30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 30s"</span><span class="op">)</span></span>
<span><span class="va">p_b60</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 60s"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_b15</span> <span class="op">+</span> <span class="va">p_b30</span> <span class="op">+</span> <span class="va">p_b60</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/different_bins-1.png" alt="Comparison of peak density heatmaps using different bin sizes." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="log-transformed-view">Log-Transformed View<a class="anchor" aria-label="anchor" href="#log-transformed-view"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear Scale"</span><span class="op">)</span></span>
<span><span class="va">p_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Log2 Scale"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_linear</span> <span class="op">+</span> <span class="va">p_log</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/log_transform-1.png" alt="Comparison of linear and log2-transformed peak density heatmaps." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="interactive-version">Interactive Version<a class="anchor" aria-label="anchor" href="#interactive-version"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e38228fe2cd18736f815" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-e38228fe2cd18736f815">{"x":{"data":[{"x":[2516,2546,2576,2606,2636,2666,2696,2726,2756,2786,2816,2846,2876,2906,2936,2966,2996,3026,3056,3086,3116,3146,3176,3206,3236,3266,3296,3326,3356,3386,3416,3446,3476,3506,3536,3566,3596,3626,3656,3686,3716,3746,3776,3806,3836,3866,3896,3926,3956,3986,4016,4046,4076,4106,4136,4166,4196,4226,4256,4286,4316,4346,4376,4406,4436,4466,4496],"y":[1,2,3],"z":[[0.57943925233644855,0.37383177570093457,0.23364485981308411,0.29906542056074764,0.21495327102803738,0.28037383177570091,0.37383177570093457,0.27102803738317754,0.21495327102803738,0.53271028037383172,0.24299065420560748,0.14953271028037382,0.25233644859813081,0.44859813084112149,0.35514018691588783,0.20560747663551401,0.23364485981308411,0.27102803738317754,0.15887850467289719,0.24299065420560748,0.19626168224299065,0.17757009345794392,0.26168224299065418,0.29906542056074764,0.29906542056074764,0.3644859813084112,0.23364485981308411,0.29906542056074764,0.3364485981308411,0.37383177570093457,0.38317757009345793,0.50467289719626163,0.28971962616822428,0.60747663551401865,0.41121495327102803,0.14953271028037382,0.26168224299065418,0.30841121495327101,0.42990654205607476,0.32710280373831774,0.51401869158878499,0.23364485981308411,0.17757009345794392,0.21495327102803738,0.23364485981308411,0.35514018691588783,0.16822429906542055,0.31775700934579437,0.18691588785046728,0.25233644859813081,0.26168224299065418,0.22429906542056074,0.25233644859813081,0.47663551401869159,0.66355140186915884,0.30841121495327101,0.16822429906542055,0.15887850467289719,0.046728971962616821,0.0093457943925233638,0.037383177570093455,0.065420560747663545,0.018691588785046728,0.0093457943925233638,0.028037383177570093,0,0.065420560747663545],[0.42056074766355139,0.28971962616822428,0.26168224299065418,0.25233644859813081,0.30841121495327101,0.24299065420560748,0.43925233644859812,0.28037383177570091,0.22429906542056074,0.37383177570093457,0.21495327102803738,0.16822429906542055,0.38317757009345793,0.7009345794392523,0.67289719626168221,0.35514018691588783,0.3644859813084112,0.19626168224299065,0.16822429906542055,0.19626168224299065,0.25233644859813081,0.22429906542056074,0.38317757009345793,0.28971962616822428,0.30841121495327101,0.44859813084112149,0.34579439252336447,0.45794392523364486,0.28971962616822428,0.38317757009345793,0.48598130841121495,0.55140186915887845,0.45794392523364486,0.68224299065420557,0.51401869158878499,0.16822429906542055,0.27102803738317754,0.50467289719626163,0.56074766355140182,0.57009345794392519,0.49532710280373832,0.66355140186915884,0.3364485981308411,0.3644859813084112,0.52336448598130836,0.51401869158878499,0.34579439252336447,0.3644859813084112,0.3925233644859813,0.3925233644859813,0.28037383177570091,0.31775700934579437,0.42990654205607476,0.47663551401869159,1,0.19626168224299065,0.22429906542056074,0.19626168224299065,0.028037383177570093,0.037383177570093455,0.037383177570093455,0.07476635514018691,0.018691588785046728,0.037383177570093455,0.028037383177570093,0.018691588785046728,0.056074766355140186],[0.3644859813084112,0.17757009345794392,0.28037383177570091,0.26168224299065418,0.25233644859813081,0.3925233644859813,0.26168224299065418,0.30841121495327101,0.20560747663551401,0.45794392523364486,0.14018691588785046,0.30841121495327101,0.26168224299065418,0.20560747663551401,0.22429906542056074,0.13084112149532709,0.26168224299065418,0.25233644859813081,0.3364485981308411,0.18691588785046728,0.26168224299065418,0.34579439252336447,0.46728971962616822,0.29906542056074764,0.38317757009345793,0.50467289719626163,0.44859813084112149,0.34579439252336447,0.40186915887850466,0.3925233644859813,0.44859813084112149,0.46728971962616822,0.31775700934579437,0.59813084112149528,0.35514018691588783,0.21495327102803738,0.34579439252336447,0.54205607476635509,0.57943925233644855,0.3925233644859813,0.51401869158878499,0.27102803738317754,0.28037383177570091,0.3925233644859813,0.40186915887850466,0.59813084112149528,0.32710280373831774,0.42990654205607476,0.31775700934579437,0.42056074766355139,0.26168224299065418,0.47663551401869159,0.28971962616822428,0.69158878504672894,0.57009345794392519,0.42990654205607476,0.15887850467289719,0.11214953271028037,0,0.046728971962616821,0.028037383177570093,0.0093457943925233638,0.037383177570093455,0.028037383177570093,0.046728971962616821,0.11214953271028037,0.028037383177570093]],"text":[["rt_center: 2516<br />sample_name: ko18.CDF<br />count:  62","rt_center: 2546<br />sample_name: ko18.CDF<br />count:  40","rt_center: 2576<br />sample_name: ko18.CDF<br />count:  25","rt_center: 2606<br />sample_name: ko18.CDF<br />count:  32","rt_center: 2636<br />sample_name: ko18.CDF<br />count:  23","rt_center: 2666<br />sample_name: ko18.CDF<br />count:  30","rt_center: 2696<br />sample_name: ko18.CDF<br />count:  40","rt_center: 2726<br />sample_name: ko18.CDF<br />count:  29","rt_center: 2756<br />sample_name: ko18.CDF<br />count:  23","rt_center: 2786<br />sample_name: ko18.CDF<br />count:  57","rt_center: 2816<br />sample_name: ko18.CDF<br />count:  26","rt_center: 2846<br />sample_name: ko18.CDF<br />count:  16","rt_center: 2876<br />sample_name: ko18.CDF<br />count:  27","rt_center: 2906<br />sample_name: ko18.CDF<br />count:  48","rt_center: 2936<br />sample_name: ko18.CDF<br />count:  38","rt_center: 2966<br />sample_name: ko18.CDF<br />count:  22","rt_center: 2996<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3026<br />sample_name: ko18.CDF<br />count:  29","rt_center: 3056<br />sample_name: ko18.CDF<br />count:  17","rt_center: 3086<br />sample_name: ko18.CDF<br />count:  26","rt_center: 3116<br />sample_name: ko18.CDF<br />count:  21","rt_center: 3146<br />sample_name: ko18.CDF<br />count:  19","rt_center: 3176<br />sample_name: ko18.CDF<br />count:  28","rt_center: 3206<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3236<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3266<br />sample_name: ko18.CDF<br />count:  39","rt_center: 3296<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3326<br />sample_name: ko18.CDF<br />count:  32","rt_center: 3356<br />sample_name: ko18.CDF<br />count:  36","rt_center: 3386<br />sample_name: ko18.CDF<br />count:  40","rt_center: 3416<br />sample_name: ko18.CDF<br />count:  41","rt_center: 3446<br />sample_name: ko18.CDF<br />count:  54","rt_center: 3476<br />sample_name: ko18.CDF<br />count:  31","rt_center: 3506<br />sample_name: ko18.CDF<br />count:  65","rt_center: 3536<br />sample_name: ko18.CDF<br />count:  44","rt_center: 3566<br />sample_name: ko18.CDF<br />count:  16","rt_center: 3596<br />sample_name: ko18.CDF<br />count:  28","rt_center: 3626<br />sample_name: ko18.CDF<br />count:  33","rt_center: 3656<br />sample_name: ko18.CDF<br />count:  46","rt_center: 3686<br />sample_name: ko18.CDF<br />count:  35","rt_center: 3716<br />sample_name: ko18.CDF<br />count:  55","rt_center: 3746<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3776<br />sample_name: ko18.CDF<br />count:  19","rt_center: 3806<br />sample_name: ko18.CDF<br />count:  23","rt_center: 3836<br />sample_name: ko18.CDF<br />count:  25","rt_center: 3866<br />sample_name: ko18.CDF<br />count:  38","rt_center: 3896<br />sample_name: ko18.CDF<br />count:  18","rt_center: 3926<br />sample_name: ko18.CDF<br />count:  34","rt_center: 3956<br />sample_name: ko18.CDF<br />count:  20","rt_center: 3986<br />sample_name: ko18.CDF<br />count:  27","rt_center: 4016<br />sample_name: ko18.CDF<br />count:  28","rt_center: 4046<br />sample_name: ko18.CDF<br />count:  24","rt_center: 4076<br />sample_name: ko18.CDF<br />count:  27","rt_center: 4106<br />sample_name: ko18.CDF<br />count:  51","rt_center: 4136<br />sample_name: ko18.CDF<br />count:  71","rt_center: 4166<br />sample_name: ko18.CDF<br />count:  33","rt_center: 4196<br />sample_name: ko18.CDF<br />count:  18","rt_center: 4226<br />sample_name: ko18.CDF<br />count:  17","rt_center: 4256<br />sample_name: ko18.CDF<br />count:   5","rt_center: 4286<br />sample_name: ko18.CDF<br />count:   1","rt_center: 4316<br />sample_name: ko18.CDF<br />count:   4","rt_center: 4346<br />sample_name: ko18.CDF<br />count:   7","rt_center: 4376<br />sample_name: ko18.CDF<br />count:   2","rt_center: 4406<br />sample_name: ko18.CDF<br />count:   1","rt_center: 4436<br />sample_name: ko18.CDF<br />count:   3","rt_center: 4466<br />sample_name: ko18.CDF<br />count:   0","rt_center: 4496<br />sample_name: ko18.CDF<br />count:   7"],["rt_center: 2516<br />sample_name: ko16.CDF<br />count:  45","rt_center: 2546<br />sample_name: ko16.CDF<br />count:  31","rt_center: 2576<br />sample_name: ko16.CDF<br />count:  28","rt_center: 2606<br />sample_name: ko16.CDF<br />count:  27","rt_center: 2636<br />sample_name: ko16.CDF<br />count:  33","rt_center: 2666<br />sample_name: ko16.CDF<br />count:  26","rt_center: 2696<br />sample_name: ko16.CDF<br />count:  47","rt_center: 2726<br />sample_name: ko16.CDF<br />count:  30","rt_center: 2756<br />sample_name: ko16.CDF<br />count:  24","rt_center: 2786<br />sample_name: ko16.CDF<br />count:  40","rt_center: 2816<br />sample_name: ko16.CDF<br />count:  23","rt_center: 2846<br />sample_name: ko16.CDF<br />count:  18","rt_center: 2876<br />sample_name: ko16.CDF<br />count:  41","rt_center: 2906<br />sample_name: ko16.CDF<br />count:  75","rt_center: 2936<br />sample_name: ko16.CDF<br />count:  72","rt_center: 2966<br />sample_name: ko16.CDF<br />count:  38","rt_center: 2996<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3026<br />sample_name: ko16.CDF<br />count:  21","rt_center: 3056<br />sample_name: ko16.CDF<br />count:  18","rt_center: 3086<br />sample_name: ko16.CDF<br />count:  21","rt_center: 3116<br />sample_name: ko16.CDF<br />count:  27","rt_center: 3146<br />sample_name: ko16.CDF<br />count:  24","rt_center: 3176<br />sample_name: ko16.CDF<br />count:  41","rt_center: 3206<br />sample_name: ko16.CDF<br />count:  31","rt_center: 3236<br />sample_name: ko16.CDF<br />count:  33","rt_center: 3266<br />sample_name: ko16.CDF<br />count:  48","rt_center: 3296<br />sample_name: ko16.CDF<br />count:  37","rt_center: 3326<br />sample_name: ko16.CDF<br />count:  49","rt_center: 3356<br />sample_name: ko16.CDF<br />count:  31","rt_center: 3386<br />sample_name: ko16.CDF<br />count:  41","rt_center: 3416<br />sample_name: ko16.CDF<br />count:  52","rt_center: 3446<br />sample_name: ko16.CDF<br />count:  59","rt_center: 3476<br />sample_name: ko16.CDF<br />count:  49","rt_center: 3506<br />sample_name: ko16.CDF<br />count:  73","rt_center: 3536<br />sample_name: ko16.CDF<br />count:  55","rt_center: 3566<br />sample_name: ko16.CDF<br />count:  18","rt_center: 3596<br />sample_name: ko16.CDF<br />count:  29","rt_center: 3626<br />sample_name: ko16.CDF<br />count:  54","rt_center: 3656<br />sample_name: ko16.CDF<br />count:  60","rt_center: 3686<br />sample_name: ko16.CDF<br />count:  61","rt_center: 3716<br />sample_name: ko16.CDF<br />count:  53","rt_center: 3746<br />sample_name: ko16.CDF<br />count:  71","rt_center: 3776<br />sample_name: ko16.CDF<br />count:  36","rt_center: 3806<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3836<br />sample_name: ko16.CDF<br />count:  56","rt_center: 3866<br />sample_name: ko16.CDF<br />count:  55","rt_center: 3896<br />sample_name: ko16.CDF<br />count:  37","rt_center: 3926<br />sample_name: ko16.CDF<br />count:  39","rt_center: 3956<br />sample_name: ko16.CDF<br />count:  42","rt_center: 3986<br />sample_name: ko16.CDF<br />count:  42","rt_center: 4016<br />sample_name: ko16.CDF<br />count:  30","rt_center: 4046<br />sample_name: ko16.CDF<br />count:  34","rt_center: 4076<br />sample_name: ko16.CDF<br />count:  46","rt_center: 4106<br />sample_name: ko16.CDF<br />count:  51","rt_center: 4136<br />sample_name: ko16.CDF<br />count: 107","rt_center: 4166<br />sample_name: ko16.CDF<br />count:  21","rt_center: 4196<br />sample_name: ko16.CDF<br />count:  24","rt_center: 4226<br />sample_name: ko16.CDF<br />count:  21","rt_center: 4256<br />sample_name: ko16.CDF<br />count:   3","rt_center: 4286<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4316<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4346<br />sample_name: ko16.CDF<br />count:   8","rt_center: 4376<br />sample_name: ko16.CDF<br />count:   2","rt_center: 4406<br />sample_name: ko16.CDF<br />count:   4","rt_center: 4436<br />sample_name: ko16.CDF<br />count:   3","rt_center: 4466<br />sample_name: ko16.CDF<br />count:   2","rt_center: 4496<br />sample_name: ko16.CDF<br />count:   6"],["rt_center: 2516<br />sample_name: ko15.CDF<br />count:  39","rt_center: 2546<br />sample_name: ko15.CDF<br />count:  19","rt_center: 2576<br />sample_name: ko15.CDF<br />count:  30","rt_center: 2606<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2636<br />sample_name: ko15.CDF<br />count:  27","rt_center: 2666<br />sample_name: ko15.CDF<br />count:  42","rt_center: 2696<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2726<br />sample_name: ko15.CDF<br />count:  33","rt_center: 2756<br />sample_name: ko15.CDF<br />count:  22","rt_center: 2786<br />sample_name: ko15.CDF<br />count:  49","rt_center: 2816<br />sample_name: ko15.CDF<br />count:  15","rt_center: 2846<br />sample_name: ko15.CDF<br />count:  33","rt_center: 2876<br />sample_name: ko15.CDF<br />count:  28","rt_center: 2906<br />sample_name: ko15.CDF<br />count:  22","rt_center: 2936<br />sample_name: ko15.CDF<br />count:  24","rt_center: 2966<br />sample_name: ko15.CDF<br />count:  14","rt_center: 2996<br />sample_name: ko15.CDF<br />count:  28","rt_center: 3026<br />sample_name: ko15.CDF<br />count:  27","rt_center: 3056<br />sample_name: ko15.CDF<br />count:  36","rt_center: 3086<br />sample_name: ko15.CDF<br />count:  20","rt_center: 3116<br />sample_name: ko15.CDF<br />count:  28","rt_center: 3146<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3176<br />sample_name: ko15.CDF<br />count:  50","rt_center: 3206<br />sample_name: ko15.CDF<br />count:  32","rt_center: 3236<br />sample_name: ko15.CDF<br />count:  41","rt_center: 3266<br />sample_name: ko15.CDF<br />count:  54","rt_center: 3296<br />sample_name: ko15.CDF<br />count:  48","rt_center: 3326<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3356<br />sample_name: ko15.CDF<br />count:  43","rt_center: 3386<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3416<br />sample_name: ko15.CDF<br />count:  48","rt_center: 3446<br />sample_name: ko15.CDF<br />count:  50","rt_center: 3476<br />sample_name: ko15.CDF<br />count:  34","rt_center: 3506<br />sample_name: ko15.CDF<br />count:  64","rt_center: 3536<br />sample_name: ko15.CDF<br />count:  38","rt_center: 3566<br />sample_name: ko15.CDF<br />count:  23","rt_center: 3596<br />sample_name: ko15.CDF<br />count:  37","rt_center: 3626<br />sample_name: ko15.CDF<br />count:  58","rt_center: 3656<br />sample_name: ko15.CDF<br />count:  62","rt_center: 3686<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3716<br />sample_name: ko15.CDF<br />count:  55","rt_center: 3746<br />sample_name: ko15.CDF<br />count:  29","rt_center: 3776<br />sample_name: ko15.CDF<br />count:  30","rt_center: 3806<br />sample_name: ko15.CDF<br />count:  42","rt_center: 3836<br />sample_name: ko15.CDF<br />count:  43","rt_center: 3866<br />sample_name: ko15.CDF<br />count:  64","rt_center: 3896<br />sample_name: ko15.CDF<br />count:  35","rt_center: 3926<br />sample_name: ko15.CDF<br />count:  46","rt_center: 3956<br />sample_name: ko15.CDF<br />count:  34","rt_center: 3986<br />sample_name: ko15.CDF<br />count:  45","rt_center: 4016<br />sample_name: ko15.CDF<br />count:  28","rt_center: 4046<br />sample_name: ko15.CDF<br />count:  51","rt_center: 4076<br />sample_name: ko15.CDF<br />count:  31","rt_center: 4106<br />sample_name: ko15.CDF<br />count:  74","rt_center: 4136<br />sample_name: ko15.CDF<br />count:  61","rt_center: 4166<br />sample_name: ko15.CDF<br />count:  46","rt_center: 4196<br />sample_name: ko15.CDF<br />count:  17","rt_center: 4226<br />sample_name: ko15.CDF<br />count:  12","rt_center: 4256<br />sample_name: ko15.CDF<br />count:   0","rt_center: 4286<br />sample_name: ko15.CDF<br />count:   5","rt_center: 4316<br />sample_name: ko15.CDF<br />count:   3","rt_center: 4346<br />sample_name: ko15.CDF<br />count:   1","rt_center: 4376<br />sample_name: ko15.CDF<br />count:   4","rt_center: 4406<br />sample_name: ko15.CDF<br />count:   3","rt_center: 4436<br />sample_name: ko15.CDF<br />count:   5","rt_center: 4466<br />sample_name: ko15.CDF<br />count:  12","rt_center: 4496<br />sample_name: ko15.CDF<br />count:   3"]],"colorscale":[[0,"#FDE725"],[0.0093457943925233638,"#F7E628"],[0.018691588785046728,"#F2E52B"],[0.028037383177570093,"#ECE42E"],[0.037383177570093455,"#E7E331"],[0.046728971962616821,"#E1E233"],[0.056074766355140186,"#DBE236"],[0.065420560747663545,"#D6E138"],[0.07476635514018691,"#D0E03A"],[0.11214953271028037,"#B8DB42"],[0.13084112149532709,"#ACD946"],[0.14018691588785046,"#A6D847"],[0.14953271028037382,"#A0D749"],[0.15887850467289719,"#99D64A"],[0.16822429906542055,"#92D54C"],[0.17757009345794392,"#8BD44E"],[0.18691588785046728,"#84D34F"],[0.19626168224299065,"#7DD150"],[0.20560747663551401,"#78D053"],[0.21495327102803738,"#76CE56"],[0.22429906542056074,"#73CC59"],[0.23364485981308411,"#70CA5B"],[0.24299065420560748,"#6DC85E"],[0.25233644859813081,"#6AC661"],[0.26168224299065418,"#67C463"],[0.27102803738317754,"#64C266"],[0.28037383177570091,"#61C068"],[0.28971962616822428,"#5DBE6A"],[0.29906542056074764,"#5ABC6D"],[0.30841121495327101,"#56BA6F"],[0.31775700934579437,"#53B971"],[0.32710280373831774,"#4FB774"],[0.3364485981308411,"#4BB576"],[0.34579439252336447,"#46B378"],[0.35514018691588783,"#41B17A"],[0.3644859813084112,"#3CAF7C"],[0.37383177570093457,"#37AD7E"],[0.38317757009345793,"#30AB80"],[0.3925233644859813,"#29A982"],[0.40186915887850466,"#22A884"],[0.41121495327102803,"#24A585"],[0.42056074766355139,"#25A385"],[0.42990654205607476,"#26A186"],[0.43925233644859812,"#279E86"],[0.44859813084112149,"#289C87"],[0.45794392523364486,"#299A87"],[0.46728971962616822,"#299888"],[0.47663551401869159,"#2A9588"],[0.48598130841121495,"#2A9389"],[0.49532710280373832,"#2B9189"],[0.50467289719626163,"#2B8F8A"],[0.51401869158878499,"#2B8C8A"],[0.52336448598130836,"#2C8A8B"],[0.53271028037383172,"#2C888B"],[0.54205607476635509,"#2C868B"],[0.55140186915887845,"#2C838C"],[0.56074766355140182,"#2B818C"],[0.57009345794392519,"#2B7F8D"],[0.57943925233644855,"#2B7D8D"],[0.59813084112149528,"#2A788E"],[0.60747663551401865,"#2C768E"],[0.66355140186915884,"#36688C"],[0.67289719626168221,"#38658C"],[0.68224299065420557,"#39638B"],[0.69158878504672894,"#3A618B"],[0.7009345794392523,"#3B5E8B"],[1,"#440154"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2500],"y":[1],"name":"ffd50d1d02f884d10fbdccd3b7556d7a","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FDE725"],[0.0033444816053511705,"#FBE726"],[0.006688963210702341,"#F9E627"],[0.010033444816053512,"#F7E629"],[0.013377926421404682,"#F5E62A"],[0.016722408026755852,"#F3E52B"],[0.020066889632107024,"#F1E52C"],[0.023411371237458192,"#EFE52D"],[0.026755852842809364,"#EDE42E"],[0.030100334448160532,"#EBE42F"],[0.033444816053511704,"#E9E430"],[0.036789297658862873,"#E7E331"],[0.040133779264214048,"#E5E332"],[0.043478260869565216,"#E3E333"],[0.046822742474916385,"#E1E233"],[0.050167224080267553,"#DFE234"],[0.053511705685618728,"#DDE235"],[0.056856187290969903,"#DBE136"],[0.060200668896321065,"#D9E137"],[0.06354515050167224,"#D7E138"],[0.066889632107023408,"#D5E038"],[0.070234113712374577,"#D3E039"],[0.073578595317725745,"#D1E03A"],[0.076923076923076913,"#CFDF3B"],[0.080267558528428096,"#CDDF3B"],[0.083612040133779264,"#CBDF3C"],[0.086956521739130432,"#C8DE3D"],[0.090301003344481601,"#C6DE3E"],[0.093645484949832769,"#C4DE3E"],[0.096989966555183951,"#C2DD3F"],[0.10033444816053511,"#C0DD40"],[0.10367892976588627,"#BEDC40"],[0.10702341137123746,"#BCDC41"],[0.11036789297658862,"#BADC42"],[0.11371237458193981,"#B7DB42"],[0.11705685618729096,"#B5DB43"],[0.12040133779264213,"#B3DB44"],[0.12374581939799331,"#B1DA44"],[0.12709030100334448,"#AFDA45"],[0.13043478260869565,"#ACD946"],[0.13377926421404682,"#AAD946"],[0.13712374581939799,"#A8D947"],[0.14046822742474915,"#A6D847"],[0.14381270903010032,"#A3D848"],[0.14715719063545149,"#A1D748"],[0.15050167224080266,"#9FD749"],[0.15384615384615383,"#9DD74A"],[0.157190635451505,"#9AD64A"],[0.16053511705685619,"#98D64B"],[0.16387959866220736,"#95D54B"],[0.16722408026755853,"#93D54C"],[0.1705685618729097,"#91D54C"],[0.17391304347826086,"#8ED44D"],[0.17725752508361203,"#8CD44D"],[0.1806020066889632,"#89D34E"],[0.18394648829431437,"#87D34F"],[0.18729096989966554,"#84D34F"],[0.19063545150501671,"#81D250"],[0.1939799331103679,"#7FD250"],[0.19732441471571907,"#7CD151"],[0.20066889632107021,"#7AD151"],[0.20401337792642138,"#79D052"],[0.20735785953177255,"#78CF53"],[0.21070234113712374,"#77CF54"],[0.21404682274247491,"#76CE55"],[0.21739130434782608,"#75CD56"],[0.22073578595317725,"#74CD57"],[0.22408026755852842,"#73CC58"],[0.22742474916387961,"#72CB59"],[0.23076923076923075,"#71CB5A"],[0.23411371237458192,"#70CA5B"],[0.23745819397993309,"#6FC95C"],[0.24080267558528426,"#6EC85D"],[0.24414715719063546,"#6DC85E"],[0.24749163879598662,"#6CC75F"],[0.25083612040133779,"#6BC660"],[0.25418060200668896,"#6AC661"],[0.25752508361204013,"#69C562"],[0.2608695652173913,"#67C463"],[0.26421404682274247,"#66C464"],[0.26755852842809363,"#65C365"],[0.2709030100334448,"#64C266"],[0.27424749163879597,"#63C166"],[0.27759197324414714,"#62C167"],[0.28093645484949831,"#61C068"],[0.28428093645484948,"#5FBF69"],[0.28762541806020064,"#5EBF6A"],[0.29096989966555181,"#5DBE6B"],[0.29431438127090298,"#5CBD6C"],[0.29765886287625415,"#5BBD6C"],[0.30100334448160532,"#59BC6D"],[0.30434782608695649,"#58BB6E"],[0.30769230769230765,"#57BB6F"],[0.31103678929765882,"#55BA70"],[0.31438127090300999,"#54B971"],[0.31772575250836116,"#53B971"],[0.32107023411371238,"#51B872"],[0.32441471571906355,"#50B773"],[0.32775919732441472,"#4EB674"],[0.33110367892976589,"#4DB675"],[0.33444816053511706,"#4BB575"],[0.33779264214046822,"#4AB476"],[0.34113712374581939,"#48B477"],[0.34448160535117056,"#47B378"],[0.34782608695652173,"#45B278"],[0.35117056856187284,"#43B279"],[0.35451505016722407,"#42B17A"],[0.35785953177257523,"#40B07B"],[0.3612040133779264,"#3EB07B"],[0.36454849498327757,"#3CAF7C"],[0.36789297658862874,"#3AAE7D"],[0.37123745819397991,"#38AE7E"],[0.37458193979933108,"#36AD7E"],[0.37792642140468224,"#34AC7F"],[0.38127090301003341,"#32AC80"],[0.38461538461538464,"#2FAB81"],[0.38795986622073581,"#2DAA81"],[0.39130434782608697,"#2AAA82"],[0.39464882943143814,"#27A983"],[0.39799331103678931,"#24A884"],[0.40133779264214042,"#22A884"],[0.40468227424749159,"#23A784"],[0.40802675585284276,"#23A684"],[0.41137123745819393,"#24A585"],[0.4147157190635451,"#24A485"],[0.41806020066889626,"#25A485"],[0.42140468227424749,"#25A385"],[0.42474916387959866,"#26A285"],[0.42809364548494983,"#26A186"],[0.43143812709030099,"#26A086"],[0.43478260869565216,"#27A086"],[0.43812709030100333,"#279F86"],[0.4414715719063545,"#279E86"],[0.44481605351170567,"#289D87"],[0.44816053511705684,"#289C87"],[0.45150501672240806,"#289B87"],[0.45484949832775923,"#299B87"],[0.45819397993311034,"#299A87"],[0.46153846153846151,"#299987"],[0.46488294314381268,"#299888"],[0.46822742474916385,"#2A9788"],[0.47157190635451501,"#2A9788"],[0.47491638795986618,"#2A9688"],[0.47826086956521735,"#2A9588"],[0.48160535117056852,"#2A9489"],[0.48494983277591969,"#2A9389"],[0.48829431438127091,"#2B9389"],[0.49163879598662208,"#2B9289"],[0.49498327759197325,"#2B9189"],[0.49832775919732442,"#2B9089"],[0.50167224080267558,"#2B8F8A"],[0.50501672240802675,"#2B8F8A"],[0.50836120401337792,"#2B8E8A"],[0.51170568561872909,"#2B8D8A"],[0.51505016722408026,"#2B8C8A"],[0.51839464882943143,"#2B8B8A"],[0.52173913043478259,"#2C8B8B"],[0.52508361204013376,"#2C8A8B"],[0.52842809364548493,"#2C898B"],[0.5317725752508361,"#2C888B"],[0.53511705685618727,"#2C878B"],[0.53846153846153844,"#2C878B"],[0.5418060200668896,"#2C868B"],[0.54515050167224077,"#2C858C"],[0.54849498327759194,"#2C848C"],[0.55183946488294311,"#2C838C"],[0.55518394648829428,"#2B838C"],[0.55852842809364545,"#2B828C"],[0.56187290969899661,"#2B818C"],[0.56521739130434778,"#2B808D"],[0.56856187290969895,"#2B7F8D"],[0.57190635451505012,"#2B7F8D"],[0.57525083612040129,"#2B7E8D"],[0.57859531772575246,"#2B7D8D"],[0.58193979933110362,"#2B7C8D"],[0.58528428093645479,"#2B7B8D"],[0.58862876254180596,"#2B7B8E"],[0.59197324414715713,"#2A7A8E"],[0.5953177257525083,"#2A798E"],[0.59866220735785947,"#2A788E"],[0.60200668896321063,"#2B778E"],[0.6053511705685618,"#2B778E"],[0.60869565217391297,"#2C768E"],[0.61204013377926414,"#2D758E"],[0.61538461538461531,"#2E748E"],[0.61872909698996648,"#2F738D"],[0.62207357859531764,"#2F728D"],[0.62541806020066881,"#30718D"],[0.62876254180601998,"#31718D"],[0.63210702341137115,"#31708D"],[0.63545150501672232,"#326F8D"],[0.6387959866220736,"#326E8D"],[0.64214046822742477,"#336D8D"],[0.64548494983277593,"#346C8D"],[0.6488294314381271,"#346B8C"],[0.65217391304347827,"#356B8C"],[0.65551839464882944,"#356A8C"],[0.65886287625418061,"#36698C"],[0.66220735785953178,"#36688C"],[0.66555183946488294,"#37678C"],[0.66889632107023411,"#37668C"],[0.67224080267558528,"#38658C"],[0.67558528428093645,"#38658C"],[0.67892976588628762,"#38648B"],[0.68227424749163879,"#39638B"],[0.68561872909698995,"#39628B"],[0.68896321070234112,"#3A618B"],[0.69230769230769229,"#3A608B"],[0.69565217391304346,"#3A5F8B"],[0.69899665551839452,"#3B5F8B"],[0.70234113712374568,"#3B5E8B"],[0.70568561872909685,"#3B5D8A"],[0.70903010033444813,"#3C5C8A"],[0.7123745819397993,"#3C5B8A"],[0.71571906354515047,"#3C5A8A"],[0.71906354515050164,"#3D598A"],[0.72240802675585281,"#3D598A"],[0.72575250836120397,"#3D588A"],[0.72909698996655514,"#3D578A"],[0.73244147157190631,"#3E568A"],[0.73578595317725748,"#3E5589"],[0.73913043478260865,"#3E5489"],[0.74247491638795982,"#3E5389"],[0.74581939799331098,"#3F5289"],[0.74916387959866215,"#3F5289"],[0.75250836120401332,"#3F5189"],[0.75585284280936449,"#3F5089"],[0.75919732441471566,"#3F4F89"],[0.76254180602006683,"#404E88"],[0.76588628762541799,"#404D88"],[0.76923076923076927,"#404C88"],[0.77257525083612044,"#404B88"],[0.77591973244147161,"#404A88"],[0.77926421404682278,"#404A88"],[0.78260869565217395,"#404988"],[0.78595317725752512,"#414888"],[0.78929765886287628,"#414787"],[0.79264214046822745,"#414687"],[0.79598662207357862,"#414587"],[0.79933110367892979,"#414487"],[0.80267558528428085,"#414386"],[0.80602006688963201,"#424285"],[0.80936454849498318,"#424185"],[0.81270903010033435,"#424184"],[0.81605351170568552,"#424083"],[0.81939799331103669,"#433F82"],[0.82274247491638786,"#433E81"],[0.82608695652173902,"#433D80"],[0.82943143812709019,"#433C7F"],[0.83277591973244136,"#433B7E"],[0.83612040133779253,"#443A7D"],[0.83946488294314381,"#44397D"],[0.84280936454849498,"#44387C"],[0.84615384615384615,"#44377B"],[0.84949832775919731,"#44367A"],[0.85284280936454848,"#443679"],[0.85618729096989965,"#443578"],[0.85953177257525082,"#453477"],[0.86287625418060199,"#453377"],[0.86622073578595316,"#453276"],[0.86956521739130432,"#453175"],[0.87290969899665549,"#453074"],[0.87625418060200666,"#452F73"],[0.87959866220735783,"#452E72"],[0.882943143812709,"#452D71"],[0.88628762541806017,"#452C70"],[0.88963210702341133,"#452B70"],[0.8929765886287625,"#462A6F"],[0.89632107023411367,"#46296E"],[0.89966555183946495,"#46286D"],[0.90301003344481612,"#46276C"],[0.90635451505016729,"#46266B"],[0.90969899665551845,"#46256B"],[0.91304347826086951,"#46246A"],[0.91638795986622068,"#462369"],[0.91973244147157185,"#462268"],[0.92307692307692302,"#462167"],[0.92642140468227419,"#462066"],[0.92976588628762535,"#461F65"],[0.93311036789297652,"#461E65"],[0.93645484949832769,"#461D64"],[0.93979933110367886,"#461B63"],[0.94314381270903003,"#461A62"],[0.9464882943143812,"#451961"],[0.94983277591973236,"#451860"],[0.95317725752508353,"#451760"],[0.9565217391304347,"#45155F"],[0.95986622073578587,"#45145E"],[0.96321070234113704,"#45135D"],[0.96655518394648821,"#45115C"],[0.96989966555183937,"#45105B"],[0.97324414715719065,"#450E5B"],[0.97658862876254182,"#450D5A"],[0.97993311036789299,"#450B59"],[0.98327759197324416,"#450958"],[0.98662207357859533,"#450857"],[0.98996655518394649,"#440656"],[0.99331103678929766,"#440456"],[0.99665551839464883,"#440355"],[1,"#440154"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"thickness":23.040000000000003,"title":"count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0.0016666666666666668,0.23453271028037381,0.46739875389408092,0.70026479750778814,0.93313084112149525],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":57.716894977168977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Chromatographic peak counts","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2401.0500000000002,4599.9499999999998],"tickmode":"array","ticktext":["2500","3000","3500","4000","4500"],"tickvals":[2500,3000,3500,4000,4500],"categoryorder":"array","categoryarray":["2500","3000","3500","4000","4500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"retention time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["ko18.CDF","ko16.CDF","ko15.CDF"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["ko18.CDF","ko16.CDF","ko15.CDF"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"21e04c346e0b":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"21e04c346e0b","visdat":{"21e04c346e0b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section></section><section class="section level2"><h2 id="part-2-chromatogram-visualization">Part 2: Chromatogram Visualization<a class="anchor" aria-label="anchor" href="#part-2-chromatogram-visualization"></a>
</h2>
<section class="level2"><h3 id="gplotxchromatogram-automatic-peak-plotting">gplot(XChromatogram): Automatic Peak Plotting<a class="anchor" aria-label="anchor" href="#gplotxchromatogram-automatic-peak-plotting"></a>
</h3>
<p>First, let’s extract a chromatogram for a specific m/z range:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract chromatogram for m/z 200-210</span></span>
<span><span class="va">mz_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">210</span><span class="op">)</span></span>
<span><span class="va">rt_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2500</span>, <span class="fl">3500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get chromatogram data</span></span>
<span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">chromatogram</a></span><span class="op">(</span><span class="va">xdata</span>, mz <span class="op">=</span> <span class="va">mz_range</span>, rt <span class="op">=</span> <span class="va">rt_range</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Chromatogram with Detected Peaks"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_chromatogram-1.png" alt="ggplot2 version of chromatogram plot with detected peaks automatically marked." width="480"></p>
</figure>
</div>
</div>
</div>
<section class="level3"><h4 id="multiple-peak-types">Multiple Peak Types<a class="anchor" aria-label="anchor" href="#multiple-peak-types"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"polygon"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Polygon"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Point"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"rectangle"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Rectangle"</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"None"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/peak_types-1.png" alt="Four panel plot showing different peak annotation styles." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="interactive-chromatogram">Interactive Chromatogram<a class="anchor" aria-label="anchor" href="#interactive-chromatogram"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f3016f741a65ec987350" style="width:768px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-f3016f741a65ec987350">{"x":{"data":[{"x":[2501.3780000000002,2502.9430000000002,2504.5079999999998,2506.0729999999999,2507.6379999999999,2509.203,2510.768,2512.3330000000001,2513.8980000000001,2515.4630000000002,2517.0279999999998,2518.5929999999998,2520.1579999999999,2521.7220000000002,2523.2869999999998,2524.8519999999999,2526.4169999999999,2527.982,2529.547,2531.1120000000001,2532.6770000000001,2534.2420000000002,2535.8069999999998,2537.3719999999998,2538.9369999999999,2540.502,2542.067,2543.6320000000001,2545.1970000000001,2546.7620000000002,2548.3270000000002,2549.8919999999998,2551.4569999999999,2553.0219999999999,2554.5859999999998,2556.1509999999998,2557.7159999999999,2559.2809999999999,2560.846,2562.4110000000001,2563.9760000000001,2565.5410000000002,2567.1060000000002,2568.6709999999998,2570.2359999999999,2571.8009999999999,2573.366,2574.931,2576.4960000000001,2578.0610000000001,2579.6260000000002,2581.1909999999998,2582.7559999999999,2584.3209999999999,2585.886,2587.451,2589.0149999999999,2590.5799999999999,2592.145,2593.71,2595.2750000000001,2596.8400000000001,2598.4050000000002,2599.9699999999998,2601.5349999999999,2603.0999999999999,2604.665,2606.23,2607.7950000000001,2609.3600000000001,2610.9250000000002,2612.4899999999998,2614.0549999999998,2615.6199999999999,2617.1849999999999,2618.75,2620.3150000000001,2621.8789999999999,2623.444,2625.009,2626.5740000000001,2628.1390000000001,2629.7040000000002,2631.2689999999998,2632.8339999999998,2634.3989999999999,2635.9639999999999,2637.529,2639.0940000000001,2640.6590000000001,2642.2240000000002,2643.7890000000002,2645.3539999999998,2646.9189999999999,2648.4839999999999,2650.049,2651.614,2653.1790000000001,2654.7440000000001,2656.308,2657.873,2659.4380000000001,2661.0030000000002,2662.5680000000002,2664.1329999999998,2665.6979999999999,2667.2629999999999,2668.828,2670.393,2671.9580000000001,2673.5230000000001,2675.0880000000002,2676.6529999999998,2678.2179999999998,2679.7829999999999,2681.348,2682.913,2684.4780000000001,2686.0430000000001,2687.6080000000002,2689.172,2690.7370000000001,2692.3020000000001,2693.8670000000002,2695.4319999999998,2696.9969999999998,2698.5619999999999,2700.127,2701.692,2703.2570000000001,2704.8220000000001,2706.3870000000002,2707.9520000000002,2709.5169999999998,2711.0819999999999,2712.6469999999999,2714.212,2715.777,2717.3420000000001,2718.9070000000002,2720.4720000000002,2722.0369999999998,2723.6010000000001,2725.1660000000002,2726.7310000000002,2728.2959999999998,2729.8609999999999,2731.4259999999999,2732.991,2734.556,2736.1210000000001,2737.6860000000001,2739.2510000000002,2740.8159999999998,2742.3809999999999,2743.9459999999999,2745.511,2747.076,2748.6410000000001,2750.2060000000001,2751.7710000000002,2753.3359999999998,2754.9009999999998,2756.4650000000001,2758.0300000000002,2759.5949999999998,2761.1599999999999,2762.7249999999999,2764.29,2765.855,2767.4200000000001,2768.9850000000001,2770.5500000000002,2772.1149999999998,2773.6799999999998,2775.2449999999999,2776.8099999999999,2778.375,2779.9400000000001,2781.5050000000001,2783.0700000000002,2784.6350000000002,2786.1999999999998,2787.7649999999999,2789.3299999999999,2790.8939999999998,2792.4589999999998,2794.0239999999999,2795.5889999999999,2797.154,2798.7190000000001,2800.2840000000001,2801.8490000000002,2803.4140000000002,2804.9789999999998,2806.5439999999999,2808.1089999999999,2809.674,2811.239,2812.8040000000001,2814.3690000000001,2815.9340000000002,2817.4989999999998,2819.0639999999999,2820.6289999999999,2822.194,2823.7579999999998,2825.3229999999999,2826.8879999999999,2828.453,2830.018,2831.5830000000001,2833.1480000000001,2834.7130000000002,2836.2779999999998,2837.8429999999998,2839.4079999999999,2840.973,2842.538,2844.1030000000001,2845.6680000000001,2847.2330000000002,2848.7979999999998,2850.3629999999998,2851.9279999999999,2853.4929999999999,2855.058,2856.623,2858.1869999999999,2859.752,2861.317,2862.8820000000001,2864.4470000000001,2866.0120000000002,2867.5770000000002,2869.1419999999998,2870.7069999999999,2872.2719999999999,2873.837,2875.402,2876.9670000000001,2878.5320000000002,2880.0970000000002,2881.6619999999998,2883.2269999999999,2884.7919999999999,2886.357,2887.922,2889.4870000000001,2891.0509999999999,2892.616,2894.181,2895.7460000000001,2897.3110000000001,2898.8760000000002,2900.4409999999998,2902.0059999999999,2903.5709999999999,2905.136,2906.701,2908.2660000000001,2909.8310000000001,2911.3960000000002,2912.9609999999998,2914.5259999999998,2916.0909999999999,2917.6559999999999,2919.221,2920.7860000000001,2922.3510000000001,2923.9160000000002,2925.48,2927.0450000000001,2928.6100000000001,2930.1750000000002,2931.7399999999998,2933.3049999999998,2934.8699999999999,2936.4349999999999,2938,2939.5650000000001,2941.1300000000001,2942.6950000000002,2944.2600000000002,2945.8249999999998,2947.3899999999999,2948.9549999999999,2950.52,2952.085,2953.6500000000001,2955.2150000000001,2956.7800000000002,2958.3440000000001,2959.9090000000001,2961.4740000000002,2963.0390000000002,2964.6039999999998,2966.1689999999999,2967.7339999999999,2969.299,2970.864,2972.4290000000001,2973.9940000000001,2975.5590000000002,2977.1239999999998,2978.6889999999999,2980.2539999999999,2981.819,2983.384,2984.9490000000001,2986.5140000000001,2988.0790000000002,2989.6439999999998,2991.2089999999998,2992.7730000000001,2994.3380000000002,2995.9029999999998,2997.4679999999998,2999.0329999999999,3000.598,3002.163,3003.7280000000001,3005.2930000000001,3006.8580000000002,3008.4229999999998,3009.9879999999998,3011.5529999999999,3013.1179999999999,3014.683,3016.248,3017.8130000000001,3019.3780000000002,3020.9430000000002,3022.5079999999998,3024.0729999999999,3025.6370000000002,3027.2020000000002,3028.7669999999998,3030.3319999999999,3031.8969999999999,3033.462,3035.027,3036.5920000000001,3038.1570000000002,3039.7220000000002,3041.2869999999998,3042.8519999999999,3044.4169999999999,3045.982,3047.547,3049.1120000000001,3050.6770000000001,3052.2420000000002,3053.8069999999998,3055.3719999999998,3056.9369999999999,3058.502,3060.0659999999998,3061.6309999999999,3063.1959999999999,3064.761,3066.326,3067.8910000000001,3069.4560000000001,3071.0210000000002,3072.5859999999998,3074.1509999999998,3075.7159999999999,3077.2809999999999,3078.846,3080.4110000000001,3081.9760000000001,3083.5410000000002,3085.1060000000002,3086.6709999999998,3088.2359999999999,3089.8009999999999,3091.366,3092.9299999999998,3094.4949999999999,3096.0599999999999,3097.625,3099.1900000000001,3100.7550000000001,3102.3200000000002,3103.8850000000002,3105.4499999999998,3107.0149999999999,3108.5799999999999,3110.145,3111.71,3113.2750000000001,3114.8400000000001,3116.4050000000002,3117.9699999999998,3119.5349999999999,3121.0999999999999,3122.665,3124.23,3125.7939999999999,3127.3589999999999,3128.924,3130.489,3132.0540000000001,3133.6190000000001,3135.1840000000002,3136.7489999999998,3138.3139999999999,3139.8789999999999,3141.444,3143.009,3144.5740000000001,3146.1390000000001,3147.7040000000002,3149.2689999999998,3150.8339999999998,3152.3989999999999,3153.9639999999999,3155.529,3157.0940000000001,3158.6590000000001,3160.223,3161.788,3163.3530000000001,3164.9180000000001,3166.4830000000002,3168.0479999999998,3169.6129999999998,3171.1779999999999,3172.7429999999999,3174.308,3175.873,3177.4380000000001,3179.0030000000002,3180.5680000000002,3182.1329999999998,3183.6979999999999,3185.2629999999999,3186.828,3188.393,3189.9580000000001,3191.5230000000001,3193.087,3194.652,3196.2170000000001,3197.7820000000002,3199.3470000000002,3200.9119999999998,3202.4769999999999,3204.0419999999999,3205.607,3207.172,3208.7370000000001,3210.3020000000001,3211.8670000000002,3213.4319999999998,3214.9969999999998,3216.5619999999999,3218.127,3219.692,3221.2570000000001,3222.8220000000001,3224.3870000000002,3225.9520000000002,3227.5160000000001,3229.0810000000001,3230.6460000000002,3232.2109999999998,3233.7759999999998,3235.3409999999999,3236.9059999999999,3238.471,3240.0360000000001,3241.6010000000001,3243.1660000000002,3244.7310000000002,3246.2959999999998,3247.8609999999999,3249.4259999999999,3250.991,3252.556,3254.1210000000001,3255.6860000000001,3257.2510000000002,3258.8159999999998,3260.3800000000001,3261.9450000000002,3263.5100000000002,3265.0749999999998,3266.6399999999999,3268.2049999999999,3269.77,3271.335,3272.9000000000001,3274.4650000000001,3276.0300000000002,3277.5949999999998,3279.1599999999999,3280.7249999999999,3282.29,3283.855,3285.4200000000001,3286.9850000000001,3288.5500000000002,3290.1149999999998,3291.6799999999998,3293.2449999999999,3294.8090000000002,3296.3739999999998,3297.9389999999999,3299.5039999999999,3301.069,3302.634,3304.1990000000001,3305.7640000000001,3307.3290000000002,3308.8939999999998,3310.4589999999998,3312.0239999999999,3313.5889999999999,3315.154,3316.7190000000001,3318.2840000000001,3319.8490000000002,3321.4140000000002,3322.9789999999998,3324.5439999999999,3326.1089999999999,3327.6729999999998,3329.2379999999998,3330.8029999999999,3332.3679999999999,3333.933,3335.498,3337.0630000000001,3338.6280000000002,3340.1930000000002,3341.7579999999998,3343.3229999999999,3344.8879999999999,3346.453,3348.018,3349.5830000000001,3351.1480000000001,3352.7130000000002,3354.2779999999998,3355.8429999999998,3357.4079999999999,3358.973,3360.538,3362.1019999999999,3363.6669999999999,3365.232,3366.797,3368.3620000000001,3369.9270000000001,3371.4920000000002,3373.0569999999998,3374.6219999999998,3376.1869999999999,3377.752,3379.317,3380.8820000000001,3382.4470000000001,3384.0120000000002,3385.5770000000002,3387.1419999999998,3388.7069999999999,3390.2719999999999,3391.837,3393.402,3394.9659999999999,3396.5309999999999,3398.096,3399.6610000000001,3401.2260000000001,3402.7910000000002,3404.3560000000002,3405.9209999999998,3407.4859999999999,3409.0509999999999,3410.616,3412.181,3413.7460000000001,3415.3110000000001,3416.8760000000002,3418.4409999999998,3420.0059999999999,3421.5709999999999,3423.136,3424.701,3426.2660000000001,3427.8310000000001,3429.395,3430.96,3432.5250000000001,3434.0900000000001,3435.6550000000002,3437.2199999999998,3438.7849999999999,3440.3499999999999,3441.915,3443.48,3445.0450000000001,3446.6100000000001,3448.1750000000002,3449.7399999999998,3451.3049999999998,3452.8699999999999,3454.4349999999999,3456,3457.5650000000001,3459.1300000000001,3460.6950000000002,3462.259,3463.8240000000001,3465.3890000000001,3466.9540000000002,3468.5189999999998,3470.0839999999998,3471.6489999999999,3473.2139999999999,3474.779,3476.3440000000001,3477.9090000000001,3479.4740000000002,3481.0390000000002,3482.6039999999998,3484.1689999999999,3485.7339999999999,3487.299,3488.864,3490.4290000000001,3491.9940000000001,3493.5590000000002,3495.1239999999998,3496.6880000000001,3498.2530000000002,3499.8180000000002],"y":[17606,16120,16467,17334,17197,17877,18918,18394,17743,19405,19820,19957,20450,21532,21470,21981,21869,21282,20885,20551,22050,19661,20470,20340,20012,19616,20551,20878,20103,17917,17995,18135,17838,19862,19804,19891,19688,19135,18812,18301,16288,14470,14883,15631,15772,15268,15909,15790,15448,15059,14558,13412,14790,14727,13867,13274,13185,11471,12517,13282,14010,14703,14495,14677,16681,15594,15768,15641,15286,14861,14569,14490,15387,15813,16161,16604,16906,16905,17728,18308,17479,18165,21355,21523,21956,21249,22020,22134,21953,22255,24183,24373,24083,23051,21504,19830,17321,15164,14449,14548,15011,13812,14327,14547,13056,12052,11331,10335,10234,9880,9436,8932,8710,8453,9409,7574,7961,8938,8864,9953,10179,9868,10155,10695,13131,13360,15723,17117,20210,23561,26917,30205,31732,32187,31107,30737,30745,30655,29208,26693,26621,26233,24448,22893,20000,18474,16787,15519,14710,14484,15535,16283,17579,19489,20341,21577,22604,23616,25139,25264,24659,23667,22752,23721,23340,22848,21958,21267,21551,22495,22751,25917,32163,41303,52197,65841,79052,89959,98575,102840,104224,104184,103323,100528,94946,85195,75615,67213,60396,52958,46040,39992,35027,29735,26749,23212,21437,20151,19846,19749,19493,18918,16571,15938,16062,16536,15864,15290,14559,14669,14736,16720,17261,17173,14803,15052,14928,14950,14590,15513,15181,14991,15425,13810,14103,14046,15893,15675,15498,15628,13638,14024,16717,17060,17011,15923,16064,13309,16673,15835,15302,15194,15250,14094,13335,12641,13546,14169,12955,13286,13546,13932,13338,13057,14609,15032,14548,14299,14550,15054,15810,12935,13150,18862,20016,20834,13198,12669,12289,12619,23083,24012,23689,23213,22534,21627,20179,18281,16488,15739,12188,13053,13465,15750,14810,13690,11641,11667,11795,11895,12308,11911,10794,10662,10813,11632,11690,10930,11366,11885,12834,13301,13978,14219,14171,13513,12873,12534,12592,12877,13545,14670,14399,12936,12734,12319,12080,12085,12111,11933,13139,12925,13017,13381,12292,12653,12653,13320,13174,12596,12082,11770,11360,12377,12093,12674,12913,11939,12092,11969,11508,11079,12074,11297,9512,9668,10891,11272,11641,11201,10540,10439,9789,10026,10329,10392,9954,9320,9955,11290,11331,12896,13609,11993,9749,9359,10463,9961,10140,10392,10547,10793,11030,11501,10866,10933,12484,12673,12005,11816,10045,10443,11255,12485,13653,14262,14689,14688,14147,12775,11614,13008,13370,11948,11882,11722,11555,11519,11735,13691,14712,15915,15589,16833,16852,16880,16148,16251,16019,16285,15151,15066,13040,11395,9719,8272,7084,6923,5833,4861,4371,3875,3925,4876,5242,5662,5911,6919,6752,6790,7020,6955,7150,6356,6636,6875,6892,6892,7234,7638,7900,8999,9015,9079,9924,8197,8403,8850,9156,10191,9970,9764,9156,9565,9818,8815,8594,8322,8427,8601,8624,8474,7789,8367,8905,9009,9106,8658,8621,8925,7875,8961,8368,8028,8464,8557,8554,8442,7860,7575,8026,8640,9376,9854,10050,10219,9926,9151,8697,8633,8772,8666,9302,8725,6939,6504,6334,6115,6012,6574,6805,7102,5918,5114,5431,5504,5382,4431,3796,3216,3066,2883,2384,2475,2165,2152,1923,2196,2550,2624,3060,3624,4366,4375,4524,4893,5629,5672,5446,4998,5139,5409,5173,4021,4337,3449,3292,3657,4226,4973,4947,4650,4625,4471,4922,5007,5079,5643,5514,5167,5442,7260,7636,7510,6458,5856,5835,5972,6087,6294,5330,4992,5963,6232,6005,5336,4947,4333,4098,3990,4568,4825,4542,4598,4634,4663,4488,4761,4830,5080,5303,4636,4522,5030,5203,4683,4745,4889,5097,6121,6198,6713,7287,7864,7509,8578,8656,8470,8007,7774,7475,7235,7063,6301,6227,5899,5878,5659,5699,5713,5706,4898,5395,6506,6664,6687,6810,6986,6517,6197,6410,6622,6372,6300,6569,7078,7285,7667,8510,8971,8845,7804,7704,7337,7801,7499,7546,7428,5909],"text":["rt: 2501.378<br />intensity:  17606","rt: 2502.943<br />intensity:  16120","rt: 2504.508<br />intensity:  16467","rt: 2506.073<br />intensity:  17334","rt: 2507.638<br />intensity:  17197","rt: 2509.203<br />intensity:  17877","rt: 2510.768<br />intensity:  18918","rt: 2512.333<br />intensity:  18394","rt: 2513.898<br />intensity:  17743","rt: 2515.463<br />intensity:  19405","rt: 2517.028<br />intensity:  19820","rt: 2518.593<br />intensity:  19957","rt: 2520.158<br />intensity:  20450","rt: 2521.722<br />intensity:  21532","rt: 2523.287<br />intensity:  21470","rt: 2524.852<br />intensity:  21981","rt: 2526.417<br />intensity:  21869","rt: 2527.982<br />intensity:  21282","rt: 2529.547<br />intensity:  20885","rt: 2531.112<br />intensity:  20551","rt: 2532.677<br />intensity:  22050","rt: 2534.242<br />intensity:  19661","rt: 2535.807<br />intensity:  20470","rt: 2537.372<br />intensity:  20340","rt: 2538.937<br />intensity:  20012","rt: 2540.502<br />intensity:  19616","rt: 2542.067<br />intensity:  20551","rt: 2543.632<br />intensity:  20878","rt: 2545.197<br />intensity:  20103","rt: 2546.762<br />intensity:  17917","rt: 2548.327<br />intensity:  17995","rt: 2549.892<br />intensity:  18135","rt: 2551.457<br />intensity:  17838","rt: 2553.022<br />intensity:  19862","rt: 2554.586<br />intensity:  19804","rt: 2556.151<br />intensity:  19891","rt: 2557.716<br />intensity:  19688","rt: 2559.281<br />intensity:  19135","rt: 2560.846<br />intensity:  18812","rt: 2562.411<br />intensity:  18301","rt: 2563.976<br />intensity:  16288","rt: 2565.541<br />intensity:  14470","rt: 2567.106<br />intensity:  14883","rt: 2568.671<br />intensity:  15631","rt: 2570.236<br />intensity:  15772","rt: 2571.801<br />intensity:  15268","rt: 2573.366<br />intensity:  15909","rt: 2574.931<br />intensity:  15790","rt: 2576.496<br />intensity:  15448","rt: 2578.061<br />intensity:  15059","rt: 2579.626<br />intensity:  14558","rt: 2581.191<br />intensity:  13412","rt: 2582.756<br />intensity:  14790","rt: 2584.321<br />intensity:  14727","rt: 2585.886<br />intensity:  13867","rt: 2587.451<br />intensity:  13274","rt: 2589.015<br />intensity:  13185","rt: 2590.580<br />intensity:  11471","rt: 2592.145<br />intensity:  12517","rt: 2593.710<br />intensity:  13282","rt: 2595.275<br />intensity:  14010","rt: 2596.840<br />intensity:  14703","rt: 2598.405<br />intensity:  14495","rt: 2599.970<br />intensity:  14677","rt: 2601.535<br />intensity:  16681","rt: 2603.100<br />intensity:  15594","rt: 2604.665<br />intensity:  15768","rt: 2606.230<br />intensity:  15641","rt: 2607.795<br />intensity:  15286","rt: 2609.360<br />intensity:  14861","rt: 2610.925<br />intensity:  14569","rt: 2612.490<br />intensity:  14490","rt: 2614.055<br />intensity:  15387","rt: 2615.620<br />intensity:  15813","rt: 2617.185<br />intensity:  16161","rt: 2618.750<br />intensity:  16604","rt: 2620.315<br />intensity:  16906","rt: 2621.879<br />intensity:  16905","rt: 2623.444<br />intensity:  17728","rt: 2625.009<br />intensity:  18308","rt: 2626.574<br />intensity:  17479","rt: 2628.139<br />intensity:  18165","rt: 2629.704<br />intensity:  21355","rt: 2631.269<br />intensity:  21523","rt: 2632.834<br />intensity:  21956","rt: 2634.399<br />intensity:  21249","rt: 2635.964<br />intensity:  22020","rt: 2637.529<br />intensity:  22134","rt: 2639.094<br />intensity:  21953","rt: 2640.659<br />intensity:  22255","rt: 2642.224<br />intensity:  24183","rt: 2643.789<br />intensity:  24373","rt: 2645.354<br />intensity:  24083","rt: 2646.919<br />intensity:  23051","rt: 2648.484<br />intensity:  21504","rt: 2650.049<br />intensity:  19830","rt: 2651.614<br />intensity:  17321","rt: 2653.179<br />intensity:  15164","rt: 2654.744<br />intensity:  14449","rt: 2656.308<br />intensity:  14548","rt: 2657.873<br />intensity:  15011","rt: 2659.438<br />intensity:  13812","rt: 2661.003<br />intensity:  14327","rt: 2662.568<br />intensity:  14547","rt: 2664.133<br />intensity:  13056","rt: 2665.698<br />intensity:  12052","rt: 2667.263<br />intensity:  11331","rt: 2668.828<br />intensity:  10335","rt: 2670.393<br />intensity:  10234","rt: 2671.958<br />intensity:   9880","rt: 2673.523<br />intensity:   9436","rt: 2675.088<br />intensity:   8932","rt: 2676.653<br />intensity:   8710","rt: 2678.218<br />intensity:   8453","rt: 2679.783<br />intensity:   9409","rt: 2681.348<br />intensity:   7574","rt: 2682.913<br />intensity:   7961","rt: 2684.478<br />intensity:   8938","rt: 2686.043<br />intensity:   8864","rt: 2687.608<br />intensity:   9953","rt: 2689.172<br />intensity:  10179","rt: 2690.737<br />intensity:   9868","rt: 2692.302<br />intensity:  10155","rt: 2693.867<br />intensity:  10695","rt: 2695.432<br />intensity:  13131","rt: 2696.997<br />intensity:  13360","rt: 2698.562<br />intensity:  15723","rt: 2700.127<br />intensity:  17117","rt: 2701.692<br />intensity:  20210","rt: 2703.257<br />intensity:  23561","rt: 2704.822<br />intensity:  26917","rt: 2706.387<br />intensity:  30205","rt: 2707.952<br />intensity:  31732","rt: 2709.517<br />intensity:  32187","rt: 2711.082<br />intensity:  31107","rt: 2712.647<br />intensity:  30737","rt: 2714.212<br />intensity:  30745","rt: 2715.777<br />intensity:  30655","rt: 2717.342<br />intensity:  29208","rt: 2718.907<br />intensity:  26693","rt: 2720.472<br />intensity:  26621","rt: 2722.037<br />intensity:  26233","rt: 2723.601<br />intensity:  24448","rt: 2725.166<br />intensity:  22893","rt: 2726.731<br />intensity:  20000","rt: 2728.296<br />intensity:  18474","rt: 2729.861<br />intensity:  16787","rt: 2731.426<br />intensity:  15519","rt: 2732.991<br />intensity:  14710","rt: 2734.556<br />intensity:  14484","rt: 2736.121<br />intensity:  15535","rt: 2737.686<br />intensity:  16283","rt: 2739.251<br />intensity:  17579","rt: 2740.816<br />intensity:  19489","rt: 2742.381<br />intensity:  20341","rt: 2743.946<br />intensity:  21577","rt: 2745.511<br />intensity:  22604","rt: 2747.076<br />intensity:  23616","rt: 2748.641<br />intensity:  25139","rt: 2750.206<br />intensity:  25264","rt: 2751.771<br />intensity:  24659","rt: 2753.336<br />intensity:  23667","rt: 2754.901<br />intensity:  22752","rt: 2756.465<br />intensity:  23721","rt: 2758.030<br />intensity:  23340","rt: 2759.595<br />intensity:  22848","rt: 2761.160<br />intensity:  21958","rt: 2762.725<br />intensity:  21267","rt: 2764.290<br />intensity:  21551","rt: 2765.855<br />intensity:  22495","rt: 2767.420<br />intensity:  22751","rt: 2768.985<br />intensity:  25917","rt: 2770.550<br />intensity:  32163","rt: 2772.115<br />intensity:  41303","rt: 2773.680<br />intensity:  52197","rt: 2775.245<br />intensity:  65841","rt: 2776.810<br />intensity:  79052","rt: 2778.375<br />intensity:  89959","rt: 2779.940<br />intensity:  98575","rt: 2781.505<br />intensity: 102840","rt: 2783.070<br />intensity: 104224","rt: 2784.635<br />intensity: 104184","rt: 2786.200<br />intensity: 103323","rt: 2787.765<br />intensity: 100528","rt: 2789.330<br />intensity:  94946","rt: 2790.894<br />intensity:  85195","rt: 2792.459<br />intensity:  75615","rt: 2794.024<br />intensity:  67213","rt: 2795.589<br />intensity:  60396","rt: 2797.154<br />intensity:  52958","rt: 2798.719<br />intensity:  46040","rt: 2800.284<br />intensity:  39992","rt: 2801.849<br />intensity:  35027","rt: 2803.414<br />intensity:  29735","rt: 2804.979<br />intensity:  26749","rt: 2806.544<br />intensity:  23212","rt: 2808.109<br />intensity:  21437","rt: 2809.674<br />intensity:  20151","rt: 2811.239<br />intensity:  19846","rt: 2812.804<br />intensity:  19749","rt: 2814.369<br />intensity:  19493","rt: 2815.934<br />intensity:  18918","rt: 2817.499<br />intensity:  16571","rt: 2819.064<br />intensity:  15938","rt: 2820.629<br />intensity:  16062","rt: 2822.194<br />intensity:  16536","rt: 2823.758<br />intensity:  15864","rt: 2825.323<br />intensity:  15290","rt: 2826.888<br />intensity:  14559","rt: 2828.453<br />intensity:  14669","rt: 2830.018<br />intensity:  14736","rt: 2831.583<br />intensity:  16720","rt: 2833.148<br />intensity:  17261","rt: 2834.713<br />intensity:  17173","rt: 2836.278<br />intensity:  14803","rt: 2837.843<br />intensity:  15052","rt: 2839.408<br />intensity:  14928","rt: 2840.973<br />intensity:  14950","rt: 2842.538<br />intensity:  14590","rt: 2844.103<br />intensity:  15513","rt: 2845.668<br />intensity:  15181","rt: 2847.233<br />intensity:  14991","rt: 2848.798<br />intensity:  15425","rt: 2850.363<br />intensity:  13810","rt: 2851.928<br />intensity:  14103","rt: 2853.493<br />intensity:  14046","rt: 2855.058<br />intensity:  15893","rt: 2856.623<br />intensity:  15675","rt: 2858.187<br />intensity:  15498","rt: 2859.752<br />intensity:  15628","rt: 2861.317<br />intensity:  13638","rt: 2862.882<br />intensity:  14024","rt: 2864.447<br />intensity:  16717","rt: 2866.012<br />intensity:  17060","rt: 2867.577<br />intensity:  17011","rt: 2869.142<br />intensity:  15923","rt: 2870.707<br />intensity:  16064","rt: 2872.272<br />intensity:  13309","rt: 2873.837<br />intensity:  16673","rt: 2875.402<br />intensity:  15835","rt: 2876.967<br />intensity:  15302","rt: 2878.532<br />intensity:  15194","rt: 2880.097<br />intensity:  15250","rt: 2881.662<br />intensity:  14094","rt: 2883.227<br />intensity:  13335","rt: 2884.792<br />intensity:  12641","rt: 2886.357<br />intensity:  13546","rt: 2887.922<br />intensity:  14169","rt: 2889.487<br />intensity:  12955","rt: 2891.051<br />intensity:  13286","rt: 2892.616<br />intensity:  13546","rt: 2894.181<br />intensity:  13932","rt: 2895.746<br />intensity:  13338","rt: 2897.311<br />intensity:  13057","rt: 2898.876<br />intensity:  14609","rt: 2900.441<br />intensity:  15032","rt: 2902.006<br />intensity:  14548","rt: 2903.571<br />intensity:  14299","rt: 2905.136<br />intensity:  14550","rt: 2906.701<br />intensity:  15054","rt: 2908.266<br />intensity:  15810","rt: 2909.831<br />intensity:  12935","rt: 2911.396<br />intensity:  13150","rt: 2912.961<br />intensity:  18862","rt: 2914.526<br />intensity:  20016","rt: 2916.091<br />intensity:  20834","rt: 2917.656<br />intensity:  13198","rt: 2919.221<br />intensity:  12669","rt: 2920.786<br />intensity:  12289","rt: 2922.351<br />intensity:  12619","rt: 2923.916<br />intensity:  23083","rt: 2925.480<br />intensity:  24012","rt: 2927.045<br />intensity:  23689","rt: 2928.610<br />intensity:  23213","rt: 2930.175<br />intensity:  22534","rt: 2931.740<br />intensity:  21627","rt: 2933.305<br />intensity:  20179","rt: 2934.870<br />intensity:  18281","rt: 2936.435<br />intensity:  16488","rt: 2938.000<br />intensity:  15739","rt: 2939.565<br />intensity:  12188","rt: 2941.130<br />intensity:  13053","rt: 2942.695<br />intensity:  13465","rt: 2944.260<br />intensity:  15750","rt: 2945.825<br />intensity:  14810","rt: 2947.390<br />intensity:  13690","rt: 2948.955<br />intensity:  11641","rt: 2950.520<br />intensity:  11667","rt: 2952.085<br />intensity:  11795","rt: 2953.650<br />intensity:  11895","rt: 2955.215<br />intensity:  12308","rt: 2956.780<br />intensity:  11911","rt: 2958.344<br />intensity:  10794","rt: 2959.909<br />intensity:  10662","rt: 2961.474<br />intensity:  10813","rt: 2963.039<br />intensity:  11632","rt: 2964.604<br />intensity:  11690","rt: 2966.169<br />intensity:  10930","rt: 2967.734<br />intensity:  11366","rt: 2969.299<br />intensity:  11885","rt: 2970.864<br />intensity:  12834","rt: 2972.429<br />intensity:  13301","rt: 2973.994<br />intensity:  13978","rt: 2975.559<br />intensity:  14219","rt: 2977.124<br />intensity:  14171","rt: 2978.689<br />intensity:  13513","rt: 2980.254<br />intensity:  12873","rt: 2981.819<br />intensity:  12534","rt: 2983.384<br />intensity:  12592","rt: 2984.949<br />intensity:  12877","rt: 2986.514<br />intensity:  13545","rt: 2988.079<br />intensity:  14670","rt: 2989.644<br />intensity:  14399","rt: 2991.209<br />intensity:  12936","rt: 2992.773<br />intensity:  12734","rt: 2994.338<br />intensity:  12319","rt: 2995.903<br />intensity:  12080","rt: 2997.468<br />intensity:  12085","rt: 2999.033<br />intensity:  12111","rt: 3000.598<br />intensity:  11933","rt: 3002.163<br />intensity:  13139","rt: 3003.728<br />intensity:  12925","rt: 3005.293<br />intensity:  13017","rt: 3006.858<br />intensity:  13381","rt: 3008.423<br />intensity:  12292","rt: 3009.988<br />intensity:  12653","rt: 3011.553<br />intensity:  12653","rt: 3013.118<br />intensity:  13320","rt: 3014.683<br />intensity:  13174","rt: 3016.248<br />intensity:  12596","rt: 3017.813<br />intensity:  12082","rt: 3019.378<br />intensity:  11770","rt: 3020.943<br />intensity:  11360","rt: 3022.508<br />intensity:  12377","rt: 3024.073<br />intensity:  12093","rt: 3025.637<br />intensity:  12674","rt: 3027.202<br />intensity:  12913","rt: 3028.767<br />intensity:  11939","rt: 3030.332<br />intensity:  12092","rt: 3031.897<br />intensity:  11969","rt: 3033.462<br />intensity:  11508","rt: 3035.027<br />intensity:  11079","rt: 3036.592<br />intensity:  12074","rt: 3038.157<br />intensity:  11297","rt: 3039.722<br />intensity:   9512","rt: 3041.287<br />intensity:   9668","rt: 3042.852<br />intensity:  10891","rt: 3044.417<br />intensity:  11272","rt: 3045.982<br />intensity:  11641","rt: 3047.547<br />intensity:  11201","rt: 3049.112<br />intensity:  10540","rt: 3050.677<br />intensity:  10439","rt: 3052.242<br />intensity:   9789","rt: 3053.807<br />intensity:  10026","rt: 3055.372<br />intensity:  10329","rt: 3056.937<br />intensity:  10392","rt: 3058.502<br />intensity:   9954","rt: 3060.066<br />intensity:   9320","rt: 3061.631<br />intensity:   9955","rt: 3063.196<br />intensity:  11290","rt: 3064.761<br />intensity:  11331","rt: 3066.326<br />intensity:  12896","rt: 3067.891<br />intensity:  13609","rt: 3069.456<br />intensity:  11993","rt: 3071.021<br />intensity:   9749","rt: 3072.586<br />intensity:   9359","rt: 3074.151<br />intensity:  10463","rt: 3075.716<br />intensity:   9961","rt: 3077.281<br />intensity:  10140","rt: 3078.846<br />intensity:  10392","rt: 3080.411<br />intensity:  10547","rt: 3081.976<br />intensity:  10793","rt: 3083.541<br />intensity:  11030","rt: 3085.106<br />intensity:  11501","rt: 3086.671<br />intensity:  10866","rt: 3088.236<br />intensity:  10933","rt: 3089.801<br />intensity:  12484","rt: 3091.366<br />intensity:  12673","rt: 3092.930<br />intensity:  12005","rt: 3094.495<br />intensity:  11816","rt: 3096.060<br />intensity:  10045","rt: 3097.625<br />intensity:  10443","rt: 3099.190<br />intensity:  11255","rt: 3100.755<br />intensity:  12485","rt: 3102.320<br />intensity:  13653","rt: 3103.885<br />intensity:  14262","rt: 3105.450<br />intensity:  14689","rt: 3107.015<br />intensity:  14688","rt: 3108.580<br />intensity:  14147","rt: 3110.145<br />intensity:  12775","rt: 3111.710<br />intensity:  11614","rt: 3113.275<br />intensity:  13008","rt: 3114.840<br />intensity:  13370","rt: 3116.405<br />intensity:  11948","rt: 3117.970<br />intensity:  11882","rt: 3119.535<br />intensity:  11722","rt: 3121.100<br />intensity:  11555","rt: 3122.665<br />intensity:  11519","rt: 3124.230<br />intensity:  11735","rt: 3125.794<br />intensity:  13691","rt: 3127.359<br />intensity:  14712","rt: 3128.924<br />intensity:  15915","rt: 3130.489<br />intensity:  15589","rt: 3132.054<br />intensity:  16833","rt: 3133.619<br />intensity:  16852","rt: 3135.184<br />intensity:  16880","rt: 3136.749<br />intensity:  16148","rt: 3138.314<br />intensity:  16251","rt: 3139.879<br />intensity:  16019","rt: 3141.444<br />intensity:  16285","rt: 3143.009<br />intensity:  15151","rt: 3144.574<br />intensity:  15066","rt: 3146.139<br />intensity:  13040","rt: 3147.704<br />intensity:  11395","rt: 3149.269<br />intensity:   9719","rt: 3150.834<br />intensity:   8272","rt: 3152.399<br />intensity:   7084","rt: 3153.964<br />intensity:   6923","rt: 3155.529<br />intensity:   5833","rt: 3157.094<br />intensity:   4861","rt: 3158.659<br />intensity:   4371","rt: 3160.223<br />intensity:   3875","rt: 3161.788<br />intensity:   3925","rt: 3163.353<br />intensity:   4876","rt: 3164.918<br />intensity:   5242","rt: 3166.483<br />intensity:   5662","rt: 3168.048<br />intensity:   5911","rt: 3169.613<br />intensity:   6919","rt: 3171.178<br />intensity:   6752","rt: 3172.743<br />intensity:   6790","rt: 3174.308<br />intensity:   7020","rt: 3175.873<br />intensity:   6955","rt: 3177.438<br />intensity:   7150","rt: 3179.003<br />intensity:   6356","rt: 3180.568<br />intensity:   6636","rt: 3182.133<br />intensity:   6875","rt: 3183.698<br />intensity:   6892","rt: 3185.263<br />intensity:   6892","rt: 3186.828<br />intensity:   7234","rt: 3188.393<br />intensity:   7638","rt: 3189.958<br />intensity:   7900","rt: 3191.523<br />intensity:   8999","rt: 3193.087<br />intensity:   9015","rt: 3194.652<br />intensity:   9079","rt: 3196.217<br />intensity:   9924","rt: 3197.782<br />intensity:   8197","rt: 3199.347<br />intensity:   8403","rt: 3200.912<br />intensity:   8850","rt: 3202.477<br />intensity:   9156","rt: 3204.042<br />intensity:  10191","rt: 3205.607<br />intensity:   9970","rt: 3207.172<br />intensity:   9764","rt: 3208.737<br />intensity:   9156","rt: 3210.302<br />intensity:   9565","rt: 3211.867<br />intensity:   9818","rt: 3213.432<br />intensity:   8815","rt: 3214.997<br />intensity:   8594","rt: 3216.562<br />intensity:   8322","rt: 3218.127<br />intensity:   8427","rt: 3219.692<br />intensity:   8601","rt: 3221.257<br />intensity:   8624","rt: 3222.822<br />intensity:   8474","rt: 3224.387<br />intensity:   7789","rt: 3225.952<br />intensity:   8367","rt: 3227.516<br />intensity:   8905","rt: 3229.081<br />intensity:   9009","rt: 3230.646<br />intensity:   9106","rt: 3232.211<br />intensity:   8658","rt: 3233.776<br />intensity:   8621","rt: 3235.341<br />intensity:   8925","rt: 3236.906<br />intensity:   7875","rt: 3238.471<br />intensity:   8961","rt: 3240.036<br />intensity:   8368","rt: 3241.601<br />intensity:   8028","rt: 3243.166<br />intensity:   8464","rt: 3244.731<br />intensity:   8557","rt: 3246.296<br />intensity:   8554","rt: 3247.861<br />intensity:   8442","rt: 3249.426<br />intensity:   7860","rt: 3250.991<br />intensity:   7575","rt: 3252.556<br />intensity:   8026","rt: 3254.121<br />intensity:   8640","rt: 3255.686<br />intensity:   9376","rt: 3257.251<br />intensity:   9854","rt: 3258.816<br />intensity:  10050","rt: 3260.380<br />intensity:  10219","rt: 3261.945<br />intensity:   9926","rt: 3263.510<br />intensity:   9151","rt: 3265.075<br />intensity:   8697","rt: 3266.640<br />intensity:   8633","rt: 3268.205<br />intensity:   8772","rt: 3269.770<br />intensity:   8666","rt: 3271.335<br />intensity:   9302","rt: 3272.900<br />intensity:   8725","rt: 3274.465<br />intensity:   6939","rt: 3276.030<br />intensity:   6504","rt: 3277.595<br />intensity:   6334","rt: 3279.160<br />intensity:   6115","rt: 3280.725<br />intensity:   6012","rt: 3282.290<br />intensity:   6574","rt: 3283.855<br />intensity:   6805","rt: 3285.420<br />intensity:   7102","rt: 3286.985<br />intensity:   5918","rt: 3288.550<br />intensity:   5114","rt: 3290.115<br />intensity:   5431","rt: 3291.680<br />intensity:   5504","rt: 3293.245<br />intensity:   5382","rt: 3294.809<br />intensity:   4431","rt: 3296.374<br />intensity:   3796","rt: 3297.939<br />intensity:   3216","rt: 3299.504<br />intensity:   3066","rt: 3301.069<br />intensity:   2883","rt: 3302.634<br />intensity:   2384","rt: 3304.199<br />intensity:   2475","rt: 3305.764<br />intensity:   2165","rt: 3307.329<br />intensity:   2152","rt: 3308.894<br />intensity:   1923","rt: 3310.459<br />intensity:   2196","rt: 3312.024<br />intensity:   2550","rt: 3313.589<br />intensity:   2624","rt: 3315.154<br />intensity:   3060","rt: 3316.719<br />intensity:   3624","rt: 3318.284<br />intensity:   4366","rt: 3319.849<br />intensity:   4375","rt: 3321.414<br />intensity:   4524","rt: 3322.979<br />intensity:   4893","rt: 3324.544<br />intensity:   5629","rt: 3326.109<br />intensity:   5672","rt: 3327.673<br />intensity:   5446","rt: 3329.238<br />intensity:   4998","rt: 3330.803<br />intensity:   5139","rt: 3332.368<br />intensity:   5409","rt: 3333.933<br />intensity:   5173","rt: 3335.498<br />intensity:   4021","rt: 3337.063<br />intensity:   4337","rt: 3338.628<br />intensity:   3449","rt: 3340.193<br />intensity:   3292","rt: 3341.758<br />intensity:   3657","rt: 3343.323<br />intensity:   4226","rt: 3344.888<br />intensity:   4973","rt: 3346.453<br />intensity:   4947","rt: 3348.018<br />intensity:   4650","rt: 3349.583<br />intensity:   4625","rt: 3351.148<br />intensity:   4471","rt: 3352.713<br />intensity:   4922","rt: 3354.278<br />intensity:   5007","rt: 3355.843<br />intensity:   5079","rt: 3357.408<br />intensity:   5643","rt: 3358.973<br />intensity:   5514","rt: 3360.538<br />intensity:   5167","rt: 3362.102<br />intensity:   5442","rt: 3363.667<br />intensity:   7260","rt: 3365.232<br />intensity:   7636","rt: 3366.797<br />intensity:   7510","rt: 3368.362<br />intensity:   6458","rt: 3369.927<br />intensity:   5856","rt: 3371.492<br />intensity:   5835","rt: 3373.057<br />intensity:   5972","rt: 3374.622<br />intensity:   6087","rt: 3376.187<br />intensity:   6294","rt: 3377.752<br />intensity:   5330","rt: 3379.317<br />intensity:   4992","rt: 3380.882<br />intensity:   5963","rt: 3382.447<br />intensity:   6232","rt: 3384.012<br />intensity:   6005","rt: 3385.577<br />intensity:   5336","rt: 3387.142<br />intensity:   4947","rt: 3388.707<br />intensity:   4333","rt: 3390.272<br />intensity:   4098","rt: 3391.837<br />intensity:   3990","rt: 3393.402<br />intensity:   4568","rt: 3394.966<br />intensity:   4825","rt: 3396.531<br />intensity:   4542","rt: 3398.096<br />intensity:   4598","rt: 3399.661<br />intensity:   4634","rt: 3401.226<br />intensity:   4663","rt: 3402.791<br />intensity:   4488","rt: 3404.356<br />intensity:   4761","rt: 3405.921<br />intensity:   4830","rt: 3407.486<br />intensity:   5080","rt: 3409.051<br />intensity:   5303","rt: 3410.616<br />intensity:   4636","rt: 3412.181<br />intensity:   4522","rt: 3413.746<br />intensity:   5030","rt: 3415.311<br />intensity:   5203","rt: 3416.876<br />intensity:   4683","rt: 3418.441<br />intensity:   4745","rt: 3420.006<br />intensity:   4889","rt: 3421.571<br />intensity:   5097","rt: 3423.136<br />intensity:   6121","rt: 3424.701<br />intensity:   6198","rt: 3426.266<br />intensity:   6713","rt: 3427.831<br />intensity:   7287","rt: 3429.395<br />intensity:   7864","rt: 3430.960<br />intensity:   7509","rt: 3432.525<br />intensity:   8578","rt: 3434.090<br />intensity:   8656","rt: 3435.655<br />intensity:   8470","rt: 3437.220<br />intensity:   8007","rt: 3438.785<br />intensity:   7774","rt: 3440.350<br />intensity:   7475","rt: 3441.915<br />intensity:   7235","rt: 3443.480<br />intensity:   7063","rt: 3445.045<br />intensity:   6301","rt: 3446.610<br />intensity:   6227","rt: 3448.175<br />intensity:   5899","rt: 3449.740<br />intensity:   5878","rt: 3451.305<br />intensity:   5659","rt: 3452.870<br />intensity:   5699","rt: 3454.435<br />intensity:   5713","rt: 3456.000<br />intensity:   5706","rt: 3457.565<br />intensity:   4898","rt: 3459.130<br />intensity:   5395","rt: 3460.695<br />intensity:   6506","rt: 3462.259<br />intensity:   6664","rt: 3463.824<br />intensity:   6687","rt: 3465.389<br />intensity:   6810","rt: 3466.954<br />intensity:   6986","rt: 3468.519<br />intensity:   6517","rt: 3470.084<br />intensity:   6197","rt: 3471.649<br />intensity:   6410","rt: 3473.214<br />intensity:   6622","rt: 3474.779<br />intensity:   6372","rt: 3476.344<br />intensity:   6300","rt: 3477.909<br />intensity:   6569","rt: 3479.474<br />intensity:   7078","rt: 3481.039<br />intensity:   7285","rt: 3482.604<br />intensity:   7667","rt: 3484.169<br />intensity:   8510","rt: 3485.734<br />intensity:   8971","rt: 3487.299<br />intensity:   8845","rt: 3488.864<br />intensity:   7804","rt: 3490.429<br />intensity:   7704","rt: 3491.994<br />intensity:   7337","rt: 3493.559<br />intensity:   7801","rt: 3495.124<br />intensity:   7499","rt: 3496.688<br />intensity:   7546","rt: 3498.253<br />intensity:   7428","rt: 3499.818<br />intensity:   5909"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2693.8670000000002,2693.8670000000002,2695.4319999999998,2696.9969999999998,2698.5619999999999,2700.127,2701.692,2703.2570000000001,2704.8220000000001,2706.3870000000002,2707.9520000000002,2709.5169999999998,2711.0819999999999,2712.6469999999999,2714.212,2715.777,2717.3420000000001,2718.9070000000002,2720.4720000000002,2722.0369999999998,2723.6010000000001,2725.1660000000002,2726.7310000000002,2728.2959999999998,2729.8609999999999,2731.4259999999999,2732.991,2734.556,2734.556,null,2693.8670000000002,2693.8670000000002,2695.4319999999998,2696.9969999999998,2698.5619999999999,2700.127,2701.692,2703.2570000000001,2704.8220000000001,2706.3870000000002,2707.9520000000002,2709.5169999999998,2711.0819999999999,2712.6469999999999,2714.212,2715.777,2717.3420000000001,2718.9070000000002,2720.4720000000002,2722.0369999999998,2723.6010000000001,2725.1660000000002,2726.7310000000002,2728.2959999999998,2729.8609999999999,2731.4259999999999,2732.991,2734.556,2734.556,null,2762.7249999999999,2762.7249999999999,2764.29,2765.855,2767.4200000000001,2768.9850000000001,2770.5500000000002,2772.1149999999998,2773.6799999999998,2775.2449999999999,2776.8099999999999,2778.375,2779.9400000000001,2781.5050000000001,2783.0700000000002,2784.6350000000002,2786.1999999999998,2787.7649999999999,2789.3299999999999,2790.8939999999998,2792.4589999999998,2794.0239999999999,2795.5889999999999,2797.154,2798.7190000000001,2800.2840000000001,2801.8490000000002,2801.8490000000002,null,2790.8939999999998,2790.8939999999998,2792.4589999999998,2794.0239999999999,2795.5889999999999,2797.154,2798.7190000000001,2800.2840000000001,2801.8490000000002,2803.4140000000002,2804.9789999999998,2806.5439999999999,2808.1089999999999,2809.674,2809.674,null,2764.29,2764.29,2765.855,2767.4200000000001,2768.9850000000001,2770.5500000000002,2772.1149999999998,2773.6799999999998,2775.2449999999999,2776.8099999999999,2778.375,2779.9400000000001,2781.5050000000001,2783.0700000000002,2784.6350000000002,2786.1999999999998,2787.7649999999999,2789.3299999999999,2790.8939999999998,2792.4589999999998,2794.0239999999999,2795.5889999999999,2797.154,2798.7190000000001,2800.2840000000001,2801.8490000000002,2803.4140000000002,2804.9789999999998,2806.5439999999999,2808.1089999999999,2808.1089999999999,null,2889.4870000000001,2889.4870000000001,2891.0509999999999,2892.616,2894.181,2895.7460000000001,2897.3110000000001,2898.8760000000002,2900.4409999999998,2902.0059999999999,2903.5709999999999,2903.5709999999999,null,3003.7280000000001,3003.7280000000001,3005.2930000000001,3006.8580000000002,3008.4229999999998,3009.9879999999998,3011.5529999999999,3011.5529999999999,null,3049.1120000000001,3049.1120000000001,3050.6770000000001,3052.2420000000002,3053.8069999999998,3055.3719999999998,3056.9369999999999,3058.502,3060.0659999999998,3061.6309999999999,3063.1959999999999,3063.1959999999999,null,3058.502,3058.502,3060.0659999999998,3061.6309999999999,3063.1959999999999,3064.761,3066.326,3067.8910000000001,3069.4560000000001,3069.4560000000001,null,3136.7489999999998,3136.7489999999998,3138.3139999999999,3139.8789999999999,3141.444,3143.009,3144.5740000000001,3146.1390000000001,3147.7040000000002,3149.2689999999998,3150.8339999999998,3152.3989999999999,3153.9639999999999,3155.529,3157.0940000000001,3157.0940000000001,null,3160.223,3160.223,3161.788,3163.3530000000001,3164.9180000000001,3166.4830000000002,3168.0479999999998,3169.6129999999998,3171.1779999999999,3172.7429999999999,3174.308,3175.873,3175.873,null,3224.3870000000002,3224.3870000000002,3225.9520000000002,3227.5160000000001,3229.0810000000001,3230.6460000000002,3232.2109999999998,3233.7759999999998,3235.3409999999999,3236.9059999999999,3238.471,3238.471,null,3260.3800000000001,3260.3800000000001,3261.9450000000002,3263.5100000000002,3265.0749999999998,3266.6399999999999,3268.2049999999999,3269.77,3271.335,3272.9000000000001,3274.4650000000001,3274.4650000000001,null,3265.0749999999998,3265.0749999999998,3266.6399999999999,3268.2049999999999,3269.77,3271.335,3272.9000000000001,3274.4650000000001,3276.0300000000002,3276.0300000000002,null,3222.8220000000001,3222.8220000000001,3224.3870000000002,3225.9520000000002,3227.5160000000001,3229.0810000000001,3230.6460000000002,3232.2109999999998,3233.7759999999998,3235.3409999999999,3236.9059999999999,3238.471,3240.0360000000001,3241.6010000000001,3243.1660000000002,3244.7310000000002,3246.2959999999998,3247.8609999999999,3249.4259999999999,3250.991,3252.556,3254.1210000000001,3255.6860000000001,3257.2510000000002,3258.8159999999998,3260.3800000000001,3261.9450000000002,3263.5100000000002,3265.0749999999998,3266.6399999999999,3268.2049999999999,3269.77,3271.335,3272.9000000000001,3274.4650000000001,3276.0300000000002,3277.5949999999998,3279.1599999999999,3280.7249999999999,3282.29,3283.855,3285.4200000000001,3286.9850000000001,3288.5500000000002,3290.1149999999998,3291.6799999999998,3293.2449999999999,3294.8090000000002,3296.3739999999998,3297.9389999999999,3299.5039999999999,3301.069,3302.634,3304.1990000000001,3304.1990000000001,null,3307.3290000000002,3307.3290000000002,3308.8939999999998,3310.4589999999998,3312.0239999999999,3313.5889999999999,3315.154,3316.7190000000001,3318.2840000000001,3319.8490000000002,3321.4140000000002,3321.4140000000002,null,3319.8490000000002,3319.8490000000002,3321.4140000000002,3322.9789999999998,3324.5439999999999,3326.1089999999999,3327.6729999999998,3327.6729999999998,null,3369.9270000000001,3369.9270000000001,3371.4920000000002,3373.0569999999998,3374.6219999999998,3376.1869999999999,3377.752,3377.752,null,3445.0450000000001,3445.0450000000001,3446.6100000000001,3448.1750000000002,3449.7399999999998,3451.3049999999998,3452.8699999999999,3452.8699999999999,null,3477.9090000000001,3477.9090000000001,3479.4740000000002,3481.0390000000002,3482.6039999999998,3484.1689999999999,3485.7339999999999,3487.299,3487.299,2693.8670000000002],"y":[0,10695,13131,13360,15723,17117,20210,23561,26917,30205,31732,32187,31107,30737,30745,30655,29208,26693,26621,26233,24448,22893,20000,18474,16787,15519,14710,14484,0,null,0,10695,13131,13360,15723,17117,20210,23561,26917,30205,31732,32187,31107,30737,30745,30655,29208,26693,26621,26233,24448,22893,20000,18474,16787,15519,14710,14484,0,null,0,21267,21551,22495,22751,25917,32163,41303,52197,65841,79052,89959,98575,102840,104224,104184,103323,100528,94946,85195,75615,67213,60396,52958,46040,39992,35027,0,null,0,85195,75615,67213,60396,52958,46040,39992,35027,29735,26749,23212,21437,20151,0,null,0,21551,22495,22751,25917,32163,41303,52197,65841,79052,89959,98575,102840,104224,104184,103323,100528,94946,85195,75615,67213,60396,52958,46040,39992,35027,29735,26749,23212,21437,0,null,0,12955,13286,13546,13932,13338,13057,14609,15032,14548,14299,0,null,0,12925,13017,13381,12292,12653,12653,0,null,0,10540,10439,9789,10026,10329,10392,9954,9320,9955,11290,0,null,0,9954,9320,9955,11290,11331,12896,13609,11993,0,null,0,16148,16251,16019,16285,15151,15066,13040,11395,9719,8272,7084,6923,5833,4861,0,null,0,3875,3925,4876,5242,5662,5911,6919,6752,6790,7020,6955,0,null,0,7789,8367,8905,9009,9106,8658,8621,8925,7875,8961,0,null,0,10219,9926,9151,8697,8633,8772,8666,9302,8725,6939,0,null,0,8697,8633,8772,8666,9302,8725,6939,6504,0,null,0,8474,7789,8367,8905,9009,9106,8658,8621,8925,7875,8961,8368,8028,8464,8557,8554,8442,7860,7575,8026,8640,9376,9854,10050,10219,9926,9151,8697,8633,8772,8666,9302,8725,6939,6504,6334,6115,6012,6574,6805,7102,5918,5114,5431,5504,5382,4431,3796,3216,3066,2883,2384,2475,0,null,0,2152,1923,2196,2550,2624,3060,3624,4366,4375,4524,0,null,0,4375,4524,4893,5629,5672,5446,0,null,0,5856,5835,5972,6087,6294,5330,0,null,0,6301,6227,5899,5878,5659,5699,0,null,0,6569,7078,7285,7667,8510,8971,8845,0,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,0.3765)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,0,0,0.1255)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":60.639269406392714},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2451.4560000000001,3549.7400000000002],"tickmode":"array","ticktext":["2500","2750","3000","3250","3500"],"tickvals":[2500,2750,3000,3250,3500],"categoryorder":"array","categoryarray":["2500","2750","3000","3250","3500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"retention time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5211.2000000000007,109435.2],"tickmode":"array","ticktext":["0","25000","50000","75000","100000"],"tickvals":[0,25000.000000000004,50000,75000,100000],"categoryorder":"array","categoryarray":["0","25000","50000","75000","100000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"intensity","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716894984}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"21e036aa540a":{"x":{},"y":{},"type":"scatter"},"21e045ac0eb9":{"x":{},"y":{}}},"cur_data":"21e036aa540a","visdat":{"21e036aa540a":["function (y) ","x"],"21e045ac0eb9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section></section><section class="section level2"><h2 id="part-3-composable-peak-highlighting">Part 3: Composable Peak Highlighting<a class="anchor" aria-label="anchor" href="#part-3-composable-peak-highlighting"></a>
</h2>
<section class="level2"><h3 id="ghighlightchrompeaks-adding-peak-layers">ghighlightChromPeaks(): Adding Peak Layers<a class="anchor" aria-label="anchor" href="#ghighlightchrompeaks-adding-peak-layers"></a>
</h3>
<p>For more control, <code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code> returns ggplot2 layers that can be added to any chromatogram plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start with gplot() which creates the chromatogram</span></span>
<span><span class="va">p_chrom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Chromatogram with Highlighted Peaks (Rectangle)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Intensity"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Add peak highlights as rectangles</span></span>
<span><span class="va">peak_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine base plot with peak annotations</span></span>
<span><span class="va">p_chrom</span> <span class="op">+</span> <span class="va">peak_layers</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_rect-1.png" alt="Chromatogram with detected peaks highlighted as semi-transparent rectangles." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="understanding-peak-highlighting-behavior">Understanding Peak Highlighting Behavior<a class="anchor" aria-label="anchor" href="#understanding-peak-highlighting-behavior"></a>
</h3>
<p>The <code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code> function searches <strong>all peaks across all samples</strong>. For cleaner visualization, filter to a single sample:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Without filtering: shows peaks from ALL samples</span></span>
<span><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>,</span>
<span>                       rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>                       mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>                       border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                       fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Samples (may show extra peaks)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With filtering: shows only peaks from sample 1</span></span>
<span><span class="va">xdata_filtered</span> <span class="op">&lt;-</span> <span class="fu">filterFile</span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata_filtered</span>,</span>
<span>                       rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>                       mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>                       border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                       fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Single Sample (sample 1 only)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_all</span> <span class="op">+</span> <span class="va">p_filtered</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_filtered-1.png" alt="Comparison showing peak highlighting with and without sample filtering." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="different-visualization-types">Different Visualization Types<a class="anchor" aria-label="anchor" href="#different-visualization-types"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xdata_filtered</span> <span class="op">&lt;-</span> <span class="fu">filterFile</span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Rectangle</span></span>
<span><span class="va">p_rect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Rectangles"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_rects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Point</span></span>
<span><span class="va">p_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Points"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Polygon</span></span>
<span><span class="va">p_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Polygons"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display all three types</span></span>
<span><span class="op">(</span><span class="va">p_rect</span> <span class="op">+</span> <span class="va">peak_rects</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_point</span> <span class="op">+</span> <span class="va">peak_points</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_poly</span> <span class="op">+</span> <span class="va">peak_polygons</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_types-1.png" alt="Three-panel comparison showing different peak annotation styles." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="peak-selection-criteria">Peak Selection Criteria<a class="anchor" aria-label="anchor" href="#peak-selection-criteria"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># whichPeaks: "any" - peaks that overlap the range</span></span>
<span><span class="va">p_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'any'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"any"</span>, border <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "within" - peaks fully within the range</span></span>
<span><span class="va">p_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"within"</span>, border <span class="op">=</span> <span class="st">"blue"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "apex_within" - peaks with apex in range</span></span>
<span><span class="va">p_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'apex_within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"apex_within"</span>, border <span class="op">=</span> <span class="st">"green"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display comparison</span></span>
<span><span class="op">(</span><span class="va">p_any</span> <span class="op">+</span> <span class="va">peaks_any</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_within</span> <span class="op">+</span> <span class="va">peaks_within</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_apex</span> <span class="op">+</span> <span class="va">peaks_apex</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/peak_selection-1.png" alt="Comparison of three peak selection methods." width="768"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="combining-visualizations">Combining Visualizations<a class="anchor" aria-label="anchor" href="#combining-visualizations"></a>
</h2>
<p>Create comprehensive peak detection summaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Peak distribution for one sample</span></span>
<span><span class="va">p_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Distribution - Sample 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Peak density across all samples</span></span>
<span><span class="va">p_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Density Across Samples"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="va">p_dist</span> <span class="op">/</span> <span class="va">p_density</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/combined_view-1.png" alt="Combined peak detection summary." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<section class="level2"><h3 id="functions-covered-1">Functions Covered<a class="anchor" aria-label="anchor" href="#functions-covered-1"></a>
</h3>
<table class="table caption-top">
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
<th>Input</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code></td>
<td>Show peaks in RT/m/z space</td>
<td>XcmsExperiment</td>
</tr>
<tr class="even">
<td><code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code></td>
<td>Peak density heatmap</td>
<td>XcmsExperiment</td>
</tr>
<tr class="odd">
<td><code>gplot(XChromatogram)</code></td>
<td>Chromatogram with peaks</td>
<td>XChromatogram</td>
</tr>
<tr class="even">
<td><code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code></td>
<td>Add peak annotations</td>
<td>Layer for ggplot</td>
</tr>
</tbody>
</table></section><section class="level2"><h3 id="use-cases">Use Cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h3>
<ul>
<li>
<strong>Quality control</strong>: Verify peak detection quality</li>
<li>
<strong>Method development</strong>: Optimize CentWave parameters</li>
<li>
<strong>Sample comparison</strong>: Compare peak detection across samples</li>
<li>
<strong>Peak inspection</strong>: Examine individual peak shapes</li>
</ul></section><section class="level2"><h3 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<p>After visualizing detected peaks, proceed to:</p>
<p>→ <strong><a href="03-peak-correspondence.html">Step 3: Peak Correspondence</a></strong> - Group peaks across samples</p>
</section></section><section class="section level2"><h2 id="comparison-with-original-xcms">Comparison with Original XCMS<a class="anchor" aria-label="anchor" href="#comparison-with-original-xcms"></a>
</h2>
<div class="row">
<section class="level2 col-md-6"><h3 id="original-xcms">Original XCMS<a class="anchor" aria-label="anchor" href="#original-xcms"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/plotChromPeaks.html" class="external-link">plotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3500</span>, <span class="fl">3800</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/original_chrompeaks-1.png" alt="XCMS plotChromPeaks using base R graphics." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2 col-md-6"><h3 id="xcmsvis-ggplot2">xcmsVis ggplot2<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3500</span>, <span class="fl">3800</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/ggplot_chrompeaks_supp-1.png" alt="ggplot2 version with modern aesthetics." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section><section class="section level2"><h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] xcmsVis_0.99.23     patchwork_1.3.2     MsExperiment_1.12.0</span></span>
<span><span class="co">#&gt; [4] ProtGenerics_1.42.0 faahKO_1.50.0       plotly_4.11.0      </span></span>
<span><span class="co">#&gt; [7] ggplot2_4.0.0       xcms_4.8.0          BiocParallel_1.44.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] DBI_1.2.3                   rlang_1.1.6                </span></span>
<span><span class="co">#&gt;   [3] magrittr_2.0.4              clue_0.3-66                </span></span>
<span><span class="co">#&gt;   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt;   [7] compiler_4.5.2              vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;   [9] reshape2_1.4.5              stringr_1.6.0              </span></span>
<span><span class="co">#&gt;  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0     </span></span>
<span><span class="co">#&gt;  [13] crayon_1.5.3                fastmap_1.2.0              </span></span>
<span><span class="co">#&gt;  [15] XVector_0.50.0              labeling_0.4.3             </span></span>
<span><span class="co">#&gt;  [17] rmarkdown_2.30              preprocessCore_1.72.0      </span></span>
<span><span class="co">#&gt;  [19] purrr_1.2.0                 xfun_0.54                  </span></span>
<span><span class="co">#&gt;  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0             </span></span>
<span><span class="co">#&gt;  [23] progress_1.2.3              DelayedArray_0.36.0        </span></span>
<span><span class="co">#&gt;  [25] parallel_4.5.2              prettyunits_1.2.0          </span></span>
<span><span class="co">#&gt;  [27] cluster_2.1.8.1             R6_2.6.1                   </span></span>
<span><span class="co">#&gt;  [29] stringi_1.8.7               RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;  [31] limma_3.66.0                GenomicRanges_1.62.0       </span></span>
<span><span class="co">#&gt;  [33] Rcpp_1.1.0                  Seqinfo_1.0.0              </span></span>
<span><span class="co">#&gt;  [35] SummarizedExperiment_1.40.0 iterators_1.0.14           </span></span>
<span><span class="co">#&gt;  [37] knitr_1.50                  IRanges_2.44.0             </span></span>
<span><span class="co">#&gt;  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4               </span></span>
<span><span class="co">#&gt;  [41] igraph_2.2.1                tidyselect_1.2.1           </span></span>
<span><span class="co">#&gt;  [43] abind_1.4-8                 yaml_2.3.10                </span></span>
<span><span class="co">#&gt;  [45] doParallel_1.0.17           codetools_0.2-20           </span></span>
<span><span class="co">#&gt;  [47] affy_1.88.0                 lattice_0.22-7             </span></span>
<span><span class="co">#&gt;  [49] tibble_3.3.0                plyr_1.8.9                 </span></span>
<span><span class="co">#&gt;  [51] Biobase_2.70.0              withr_3.0.2                </span></span>
<span><span class="co">#&gt;  [53] S7_0.2.0                    evaluate_1.0.5             </span></span>
<span><span class="co">#&gt;  [55] Spectra_1.20.0              pillar_1.11.1              </span></span>
<span><span class="co">#&gt;  [57] affyio_1.80.0               BiocManager_1.30.26        </span></span>
<span><span class="co">#&gt;  [59] MatrixGenerics_1.22.0       foreach_1.5.2              </span></span>
<span><span class="co">#&gt;  [61] stats4_4.5.2                MSnbase_2.36.0             </span></span>
<span><span class="co">#&gt;  [63] MALDIquant_1.22.3           ncdf4_1.24                 </span></span>
<span><span class="co">#&gt;  [65] generics_0.1.4              S4Vectors_0.48.0           </span></span>
<span><span class="co">#&gt;  [67] hms_1.1.4                   scales_1.4.0               </span></span>
<span><span class="co">#&gt;  [69] glue_1.8.0                  MsFeatures_1.18.0          </span></span>
<span><span class="co">#&gt;  [71] lazyeval_0.2.2              tools_4.5.2                </span></span>
<span><span class="co">#&gt;  [73] mzID_1.48.0                 data.table_1.17.8          </span></span>
<span><span class="co">#&gt;  [75] QFeatures_1.20.0            vsn_3.78.0                 </span></span>
<span><span class="co">#&gt;  [77] mzR_2.44.0                  fs_1.6.6                   </span></span>
<span><span class="co">#&gt;  [79] XML_3.99-0.20               grid_4.5.2                 </span></span>
<span><span class="co">#&gt;  [81] impute_1.84.0               tidyr_1.3.1                </span></span>
<span><span class="co">#&gt;  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0         </span></span>
<span><span class="co">#&gt;  [85] PSMatch_1.14.0              cli_3.6.5                  </span></span>
<span><span class="co">#&gt;  [87] viridisLite_0.4.2           S4Arrays_1.10.0            </span></span>
<span><span class="co">#&gt;  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0    </span></span>
<span><span class="co">#&gt;  [91] pcaMethods_2.2.0            gtable_0.3.6               </span></span>
<span><span class="co">#&gt;  [93] digest_0.6.38               BiocGenerics_0.56.0        </span></span>
<span><span class="co">#&gt;  [95] SparseArray_1.10.1          htmlwidgets_1.6.4          </span></span>
<span><span class="co">#&gt;  [97] farver_2.1.2                htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [99] lifecycle_1.0.4             httr_1.4.7                 </span></span>
<span><span class="co">#&gt; [101] statmod_1.5.1               MASS_7.3-65</span></span></code></pre></div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stanstrup Jan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
