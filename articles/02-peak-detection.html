<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step 2: Peak Detection Visualization • xcmsVis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="02-peak-detection_files/libs/quarto-html/popper.min.js"></script><script src="02-peak-detection_files/libs/quarto-html/tippy.umd.min.js"></script><link href="02-peak-detection_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-peak-detection_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="02-peak-detection_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="02-peak-detection_files/libs/plotly-binding-4.11.0/plotly.js"></script><script src="02-peak-detection_files/libs/typedarray-0.1/typedarray.min.js"></script><link href="02-peak-detection_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="02-peak-detection_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="02-peak-detection_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Step 2: Peak Detection Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xcmsVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>---------- XCMS Workflow ----------</h6></li>
    <li><a class="dropdown-item" href="../articles/01-raw-data-visualization.html">Step 1: Raw Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/02-peak-detection.html">Step 2: Peak Detection Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/03-peak-correspondence.html">Step 3: Peak Correspondence Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/04-retention-time-alignment.html">Step 4: Retention Time Alignment Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/05-feature-grouping.html">Step 5: Feature Grouping Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stanstrup/xcmsVis" aria-label="GitHub repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Step 2: Peak Detection Visualization</h1>

      <p class="author">xcmsVis Package</p>
      <p class="date">2025-11-15</p>

      <small class="dont-index">Source: <a href="https://github.com/stanstrup/xcmsVis/blob/main/vignettes/02-peak-detection.qmd" class="external-link"><code>vignettes/02-peak-detection.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette covers the <strong>second step</strong> in the XCMS metabolomics workflow: <strong>visualizing detected chromatographic peaks</strong>. After running <code><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks.html" class="external-link">findChromPeaks()</a></code>, these functions help you:</p>
<ul>
<li>Assess peak detection quality</li>
<li>Visualize peak distribution across samples</li>
<li>Examine individual peak shapes</li>
<li>Annotate chromatograms with detected peaks</li>
</ul>
<section class="level2"><h3 id="xcms-workflow-context">XCMS Workflow Context<a class="anchor" aria-label="anchor" href="#xcms-workflow-context"></a>
</h3>
<pre><code>┌───────────────────────────────┐
│ 1. Raw Data Visualization     │
├───────────────────────────────┤
│ 2. PEAK DETECTION             │ ← YOU ARE HERE
├───────────────────────────────┤
│ 3. Peak Correspondence        │
│ 4. Retention Time Alignment   │
│ 5. Feature Grouping           │
└───────────────────────────────┘</code></pre>
</section><section class="level2"><h3 id="functions-covered">Functions Covered<a class="anchor" aria-label="anchor" href="#functions-covered"></a>
</h3>
<ul>
<li>
<strong><code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code></strong>: Visualize detected peaks as rectangles in RT vs m/z space</li>
<li>
<strong><code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code></strong>: Heatmap showing peak density across samples and retention time</li>
<li>
<strong><code>gplot(XChromatogram)</code></strong>: Plot individual chromatograms with detected peaks</li>
<li>
<strong><code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code></strong>: Add peak annotations to existing chromatogram plots</li>
</ul></section></section><section class="section level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sneumann/xcms" class="external-link">xcms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.doi.org/10.1021/bi0480335" class="external-link">faahKO</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stanstrup.github.io/xcmsVis">xcmsVis</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<p>We’ll use pre-processed example data with peaks already detected:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load pre-processed data with detected peaks</span></span>
<span><span class="co"># This dataset contains 248 detected peaks from 3 samples</span></span>
<span><span class="va">xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/loadXcmsData.html" class="external-link">loadXcmsData</a></span><span class="op">(</span><span class="st">"faahko_sub2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add sample metadata for visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO01"</span>, <span class="st">"KO02"</span>, <span class="st">"WT01"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">$</span><span class="va">sample_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span>, <span class="st">"KO"</span>, <span class="st">"WT"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check number of peaks detected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total peaks detected:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">chromPeaks</a></span><span class="op">(</span><span class="va">xdata</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total peaks detected: 248</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="part-1-peak-distribution-visualization">Part 1: Peak Distribution Visualization<a class="anchor" aria-label="anchor" href="#part-1-peak-distribution-visualization"></a>
</h2>
<section class="level2"><h3 id="gplotchrompeaks-peak-rectangles-in-rtmz-space">gplotChromPeaks(): Peak Rectangles in RT/m/z Space<a class="anchor" aria-label="anchor" href="#gplotchrompeaks-peak-rectangles-in-rtmz-space"></a>
</h3>
<p>The <code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code> function creates a scatter plot showing detected peaks as rectangles in retention time vs m/z space.</p>
<section class="level3"><h4 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_chrompeaks-1.png" alt="ggplot2 version showing detected peaks as semi-transparent rectangles in RT vs m/z space." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="focusing-on-a-region">Focusing on a Region<a class="anchor" aria-label="anchor" href="#focusing-on-a-region"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Focus on a specific RT and m/z region</span></span>
<span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span></span>
<span>                <span class="va">xdata</span>,</span>
<span>                file <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2600</span>, <span class="fl">2750</span><span class="op">)</span>,</span>
<span>                ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">325</span>,<span class="fl">460</span><span class="op">)</span></span>
<span>              <span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/zoom_chrompeaks-1.png" alt="Zoomed view of chromatographic peaks in a specific region." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="customizing-the-plot">Customizing the Plot<a class="anchor" aria-label="anchor" href="#customizing-the-plot"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2600</span>, <span class="fl">2750</span><span class="op">)</span>,</span>
<span>                ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">325</span>,<span class="fl">460</span><span class="op">)</span>,</span>
<span>                border <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"lightblue"</span></span>
<span>                <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Detected Peaks - Sample 1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"m/z"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/custom_chrompeaks-1.png" alt="Customized chromatographic peaks plot with custom styling." width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="comparing-multiple-samples">Comparing Multiple Samples<a class="anchor" aria-label="anchor" href="#comparing-multiple-samples"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 1 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 2 (KO)"</span><span class="op">)</span></span>
<span><span class="va">p_s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sample 3 (WT)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_s1</span> <span class="op">+</span> <span class="va">p_s2</span> <span class="op">+</span> <span class="va">p_s3</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/compare_samples-1.png" alt="Side-by-side comparison of peak distributions across three samples." width="960"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="level2"><h3 id="gplotchrompeakimage-peak-density-heatmap">gplotChromPeakImage(): Peak Density Heatmap<a class="anchor" aria-label="anchor" href="#gplotchrompeakimage-peak-density-heatmap"></a>
</h3>
<p>The <code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code> function creates a heatmap showing the number of detected peaks per sample across retention time bins.</p>
<section class="level3"><h4 id="basic-usage-1">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_peakimage-1.png" alt="ggplot2 heatmap of peak density using viridis color scale." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="with-different-bin-sizes">With Different Bin Sizes<a class="anchor" aria-label="anchor" href="#with-different-bin-sizes"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_b15</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 15s"</span><span class="op">)</span></span>
<span><span class="va">p_b30</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 30s"</span><span class="op">)</span></span>
<span><span class="va">p_b60</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Bin Size: 60s"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_b15</span> <span class="op">+</span> <span class="va">p_b30</span> <span class="op">+</span> <span class="va">p_b60</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/different_bins-1.png" alt="Comparison of peak density heatmaps using different bin sizes." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="log-transformed-view">Log-Transformed View<a class="anchor" aria-label="anchor" href="#log-transformed-view"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear Scale"</span><span class="op">)</span></span>
<span><span class="va">p_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, log_transform <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Log2 Scale"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_linear</span> <span class="op">+</span> <span class="va">p_log</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/log_transform-1.png" alt="Comparison of linear and log2-transformed peak density heatmaps." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="interactive-version">Interactive Version<a class="anchor" aria-label="anchor" href="#interactive-version"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8b47a3b00dc4653bef22" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-8b47a3b00dc4653bef22">{"x":{"data":[{"x":[2516,2546,2576,2606,2636,2666,2696,2726,2756,2786,2816,2846,2876,2906,2936,2966,2996,3026,3056,3086,3116,3146,3176,3206,3236,3266,3296,3326,3356,3386,3416,3446,3476,3506,3536,3566,3596,3626,3656,3686,3716,3746,3776,3806,3836,3866,3896,3926,3956,3986,4016,4046,4076,4106,4136,4166,4196,4226,4256,4286,4316,4346,4376,4406,4436,4466,4496],"y":[1,2,3],"z":[[0.40000000000000002,0,0,0,0,0,0.5,0,0,0.29999999999999999,0,0,0,0.20000000000000001,0.10000000000000001,0,0.10000000000000001,0,0,0,0,0.10000000000000001,0,0.10000000000000001,0.10000000000000001,0,0.20000000000000001,0.20000000000000001,0.29999999999999999,0.20000000000000001,0.40000000000000002,0.20000000000000001,0.10000000000000001,0.20000000000000001,0.29999999999999999,0,0.20000000000000001,0.29999999999999999,0.10000000000000001,0.10000000000000001,0.5,0,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.20000000000000001,0,0.20000000000000001,0,0.10000000000000001,0,0.10000000000000001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0.10000000000000001,0,0,0.5,0,0,0.40000000000000002,0,0,0.10000000000000001,0.29999999999999999,0.20000000000000001,0.29999999999999999,0,0.10000000000000001,0,0,0,0.20000000000000001,0.10000000000000001,0.29999999999999999,0.10000000000000001,0.20000000000000001,0.10000000000000001,0.40000000000000002,0.5,0.29999999999999999,0.59999999999999998,0,0.40000000000000002,0.69999999999999996,0.40000000000000002,0,0.10000000000000001,1,0.20000000000000001,0.20000000000000001,0.59999999999999998,0.40000000000000002,0.20000000000000001,0.10000000000000001,0.40000000000000002,0.10000000000000001,0,0.10000000000000001,0.10000000000000001,0,0,0.10000000000000001,0,0.10000000000000001,0,0,0,0,0,0,0,0,0,0,0,0,0],[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.20000000000000001,0.10000000000000001,0.40000000000000002,0.10000000000000001,0.20000000000000001,0.10000000000000001,0.40000000000000002,0.20000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.20000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0,0,0.10000000000000001,0,0,0.20000000000000001,0.20000000000000001,0,0.10000000000000001,0.20000000000000001,0.20000000000000001,0.40000000000000002,0.10000000000000001,0.29999999999999999,0.80000000000000004,0.10000000000000001,0.20000000000000001,0.5,0.29999999999999999,0.59999999999999998,0.10000000000000001,0.20000000000000001,0,0.10000000000000001,0.20000000000000001,0.10000000000000001,0,0,0,0,0,0,0.20000000000000001,0,0.29999999999999999,0.29999999999999999,0,0,0,0,0,0,0,0,0,0,0,0]],"text":[["rt_center: 2516<br />sample_name: ko18.CDF<br />count:  4","rt_center: 2546<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2576<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2606<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2636<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2666<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2696<br />sample_name: ko18.CDF<br />count:  5","rt_center: 2726<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2756<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2786<br />sample_name: ko18.CDF<br />count:  3","rt_center: 2816<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2846<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2876<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2906<br />sample_name: ko18.CDF<br />count:  2","rt_center: 2936<br />sample_name: ko18.CDF<br />count:  1","rt_center: 2966<br />sample_name: ko18.CDF<br />count:  0","rt_center: 2996<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3026<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3056<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3086<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3116<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3146<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3176<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3206<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3236<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3266<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3296<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3326<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3356<br />sample_name: ko18.CDF<br />count:  3","rt_center: 3386<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3416<br />sample_name: ko18.CDF<br />count:  4","rt_center: 3446<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3476<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3506<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3536<br />sample_name: ko18.CDF<br />count:  3","rt_center: 3566<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3596<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3626<br />sample_name: ko18.CDF<br />count:  3","rt_center: 3656<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3686<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3716<br />sample_name: ko18.CDF<br />count:  5","rt_center: 3746<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3776<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3806<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3836<br />sample_name: ko18.CDF<br />count:  1","rt_center: 3866<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3896<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3926<br />sample_name: ko18.CDF<br />count:  2","rt_center: 3956<br />sample_name: ko18.CDF<br />count:  0","rt_center: 3986<br />sample_name: ko18.CDF<br />count:  1","rt_center: 4016<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4046<br />sample_name: ko18.CDF<br />count:  1","rt_center: 4076<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4106<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4136<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4166<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4196<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4226<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4256<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4286<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4316<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4346<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4376<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4406<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4436<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4466<br />sample_name: ko18.CDF<br />count:  0","rt_center: 4496<br />sample_name: ko18.CDF<br />count:  0"],["rt_center: 2516<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2546<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2576<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2606<br />sample_name: ko16.CDF<br />count:  1","rt_center: 2636<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2666<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2696<br />sample_name: ko16.CDF<br />count:  5","rt_center: 2726<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2756<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2786<br />sample_name: ko16.CDF<br />count:  4","rt_center: 2816<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2846<br />sample_name: ko16.CDF<br />count:  0","rt_center: 2876<br />sample_name: ko16.CDF<br />count:  1","rt_center: 2906<br />sample_name: ko16.CDF<br />count:  3","rt_center: 2936<br />sample_name: ko16.CDF<br />count:  2","rt_center: 2966<br />sample_name: ko16.CDF<br />count:  3","rt_center: 2996<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3026<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3056<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3086<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3116<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3146<br />sample_name: ko16.CDF<br />count:  2","rt_center: 3176<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3206<br />sample_name: ko16.CDF<br />count:  3","rt_center: 3236<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3266<br />sample_name: ko16.CDF<br />count:  2","rt_center: 3296<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3326<br />sample_name: ko16.CDF<br />count:  4","rt_center: 3356<br />sample_name: ko16.CDF<br />count:  5","rt_center: 3386<br />sample_name: ko16.CDF<br />count:  3","rt_center: 3416<br />sample_name: ko16.CDF<br />count:  6","rt_center: 3446<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3476<br />sample_name: ko16.CDF<br />count:  4","rt_center: 3506<br />sample_name: ko16.CDF<br />count:  7","rt_center: 3536<br />sample_name: ko16.CDF<br />count:  4","rt_center: 3566<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3596<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3626<br />sample_name: ko16.CDF<br />count: 10","rt_center: 3656<br />sample_name: ko16.CDF<br />count:  2","rt_center: 3686<br />sample_name: ko16.CDF<br />count:  2","rt_center: 3716<br />sample_name: ko16.CDF<br />count:  6","rt_center: 3746<br />sample_name: ko16.CDF<br />count:  4","rt_center: 3776<br />sample_name: ko16.CDF<br />count:  2","rt_center: 3806<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3836<br />sample_name: ko16.CDF<br />count:  4","rt_center: 3866<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3896<br />sample_name: ko16.CDF<br />count:  0","rt_center: 3926<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3956<br />sample_name: ko16.CDF<br />count:  1","rt_center: 3986<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4016<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4046<br />sample_name: ko16.CDF<br />count:  1","rt_center: 4076<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4106<br />sample_name: ko16.CDF<br />count:  1","rt_center: 4136<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4166<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4196<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4226<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4256<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4286<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4316<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4346<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4376<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4406<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4436<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4466<br />sample_name: ko16.CDF<br />count:  0","rt_center: 4496<br />sample_name: ko16.CDF<br />count:  0"],["rt_center: 2516<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2546<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2576<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2606<br />sample_name: ko15.CDF<br />count:  2","rt_center: 2636<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2666<br />sample_name: ko15.CDF<br />count:  4","rt_center: 2696<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2726<br />sample_name: ko15.CDF<br />count:  2","rt_center: 2756<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2786<br />sample_name: ko15.CDF<br />count:  4","rt_center: 2816<br />sample_name: ko15.CDF<br />count:  2","rt_center: 2846<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2876<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2906<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2936<br />sample_name: ko15.CDF<br />count:  2","rt_center: 2966<br />sample_name: ko15.CDF<br />count:  1","rt_center: 2996<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3026<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3056<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3086<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3116<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3146<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3176<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3206<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3236<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3266<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3296<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3326<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3356<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3386<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3416<br />sample_name: ko15.CDF<br />count:  4","rt_center: 3446<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3476<br />sample_name: ko15.CDF<br />count:  3","rt_center: 3506<br />sample_name: ko15.CDF<br />count:  8","rt_center: 3536<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3566<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3596<br />sample_name: ko15.CDF<br />count:  5","rt_center: 3626<br />sample_name: ko15.CDF<br />count:  3","rt_center: 3656<br />sample_name: ko15.CDF<br />count:  6","rt_center: 3686<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3716<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3746<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3776<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3806<br />sample_name: ko15.CDF<br />count:  2","rt_center: 3836<br />sample_name: ko15.CDF<br />count:  1","rt_center: 3866<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3896<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3926<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3956<br />sample_name: ko15.CDF<br />count:  0","rt_center: 3986<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4016<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4046<br />sample_name: ko15.CDF<br />count:  2","rt_center: 4076<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4106<br />sample_name: ko15.CDF<br />count:  3","rt_center: 4136<br />sample_name: ko15.CDF<br />count:  3","rt_center: 4166<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4196<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4226<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4256<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4286<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4316<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4346<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4376<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4406<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4436<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4466<br />sample_name: ko15.CDF<br />count:  0","rt_center: 4496<br />sample_name: ko15.CDF<br />count:  0"]],"colorscale":[[0,"#FDE725"],[0.10000000000000001,"#C0DD40"],[0.20000000000000001,"#7AD151"],[0.29999999999999999,"#5ABC6D"],[0.40000000000000002,"#22A884"],[0.5,"#2B9089"],[0.59999999999999998,"#2A788E"],[0.69999999999999996,"#3B5E8B"],[0.80000000000000004,"#414487"],[1,"#440154"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2500],"y":[1],"name":"ed78401a7e1c1d1b81b050953f38c6cb","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FDE725"],[0.0033444816053511705,"#FBE726"],[0.006688963210702341,"#F9E627"],[0.01003344481605351,"#F7E629"],[0.013377926421404682,"#F5E62A"],[0.016722408026755852,"#F3E52B"],[0.02006688963210702,"#F1E52C"],[0.023411371237458192,"#EFE52D"],[0.026755852842809364,"#EDE42E"],[0.030100334448160532,"#EBE42F"],[0.033444816053511704,"#E9E430"],[0.036789297658862873,"#E7E331"],[0.040133779264214041,"#E5E332"],[0.043478260869565216,"#E3E333"],[0.046822742474916385,"#E1E233"],[0.05016722408026756,"#DFE234"],[0.053511705685618728,"#DDE235"],[0.056856187290969896,"#DBE136"],[0.060200668896321065,"#D9E137"],[0.06354515050167224,"#D7E138"],[0.066889632107023408,"#D5E038"],[0.070234113712374577,"#D3E039"],[0.073578595317725745,"#D1E03A"],[0.076923076923076913,"#CFDF3B"],[0.080267558528428082,"#CDDF3B"],[0.083612040133779264,"#CBDF3C"],[0.086956521739130432,"#C8DE3D"],[0.090301003344481601,"#C6DE3E"],[0.093645484949832769,"#C4DE3E"],[0.096989966555183937,"#C2DD3F"],[0.10033444816053512,"#C0DD40"],[0.10367892976588629,"#BEDC40"],[0.10702341137123746,"#BCDC41"],[0.11036789297658862,"#BADC42"],[0.11371237458193979,"#B7DB42"],[0.11705685618729096,"#B5DB43"],[0.12040133779264213,"#B3DB44"],[0.1237458193979933,"#B1DA44"],[0.12709030100334448,"#AFDA45"],[0.13043478260869565,"#ACD946"],[0.13377926421404682,"#AAD946"],[0.13712374581939799,"#A8D947"],[0.14046822742474915,"#A6D847"],[0.14381270903010032,"#A3D848"],[0.14715719063545149,"#A1D748"],[0.15050167224080266,"#9FD749"],[0.15384615384615383,"#9DD74A"],[0.157190635451505,"#9AD64A"],[0.16053511705685616,"#98D64B"],[0.16387959866220736,"#95D54B"],[0.16722408026755853,"#93D54C"],[0.1705685618729097,"#91D54C"],[0.17391304347826086,"#8ED44D"],[0.17725752508361203,"#8CD44D"],[0.1806020066889632,"#89D34E"],[0.18394648829431437,"#87D34F"],[0.18729096989966554,"#84D34F"],[0.19063545150501671,"#81D250"],[0.19397993311036787,"#7FD250"],[0.19732441471571907,"#7CD151"],[0.20066889632107024,"#7AD151"],[0.20401337792642141,"#79D052"],[0.20735785953177258,"#78CF53"],[0.21070234113712374,"#77CF54"],[0.21404682274247491,"#76CE55"],[0.21739130434782608,"#75CD56"],[0.22073578595317725,"#74CD57"],[0.22408026755852842,"#73CC58"],[0.22742474916387959,"#72CB59"],[0.23076923076923075,"#71CB5A"],[0.23411371237458192,"#70CA5B"],[0.23745819397993309,"#6FC95C"],[0.24080267558528426,"#6EC85D"],[0.24414715719063543,"#6DC85E"],[0.2474916387959866,"#6CC75F"],[0.25083612040133779,"#6BC660"],[0.25418060200668896,"#6AC661"],[0.25752508361204013,"#69C562"],[0.2608695652173913,"#67C463"],[0.26421404682274247,"#66C464"],[0.26755852842809363,"#65C365"],[0.2709030100334448,"#64C266"],[0.27424749163879597,"#63C166"],[0.27759197324414714,"#62C167"],[0.28093645484949831,"#61C068"],[0.28428093645484948,"#5FBF69"],[0.28762541806020064,"#5EBF6A"],[0.29096989966555181,"#5DBE6B"],[0.29431438127090298,"#5CBD6C"],[0.29765886287625415,"#5BBD6C"],[0.30100334448160532,"#59BC6D"],[0.30434782608695649,"#58BB6E"],[0.30769230769230765,"#57BB6F"],[0.31103678929765882,"#55BA70"],[0.31438127090300999,"#54B971"],[0.31772575250836116,"#53B971"],[0.32107023411371233,"#51B872"],[0.32441471571906355,"#50B773"],[0.32775919732441472,"#4EB674"],[0.33110367892976589,"#4DB675"],[0.33444816053511706,"#4BB575"],[0.33779264214046822,"#4AB476"],[0.34113712374581939,"#48B477"],[0.34448160535117056,"#47B378"],[0.34782608695652173,"#45B278"],[0.3511705685618729,"#43B279"],[0.35451505016722407,"#42B17A"],[0.35785953177257523,"#40B07B"],[0.3612040133779264,"#3EB07B"],[0.36454849498327757,"#3CAF7C"],[0.36789297658862874,"#3AAE7D"],[0.37123745819397991,"#38AE7E"],[0.37458193979933108,"#36AD7E"],[0.37792642140468224,"#34AC7F"],[0.38127090301003341,"#32AC80"],[0.38461538461538458,"#2FAB81"],[0.38795986622073575,"#2DAA81"],[0.39130434782608692,"#2AAA82"],[0.39464882943143814,"#27A983"],[0.39799331103678931,"#24A884"],[0.40133779264214048,"#22A884"],[0.40468227424749159,"#23A784"],[0.40802675585284282,"#23A684"],[0.41137123745819393,"#24A585"],[0.41471571906354515,"#24A485"],[0.41806020066889626,"#25A485"],[0.42140468227424749,"#25A385"],[0.4247491638795986,"#26A285"],[0.42809364548494983,"#26A186"],[0.43143812709030105,"#26A086"],[0.43478260869565216,"#27A086"],[0.43812709030100339,"#279F86"],[0.4414715719063545,"#279E86"],[0.44481605351170572,"#289D87"],[0.44816053511705684,"#289C87"],[0.45150501672240806,"#289B87"],[0.45484949832775917,"#299B87"],[0.4581939799331104,"#299A87"],[0.46153846153846151,"#299987"],[0.46488294314381273,"#299888"],[0.46822742474916385,"#2A9788"],[0.47157190635451507,"#2A9788"],[0.47491638795986618,"#2A9688"],[0.47826086956521741,"#2A9588"],[0.48160535117056852,"#2A9489"],[0.48494983277591974,"#2A9389"],[0.48829431438127086,"#2B9389"],[0.49163879598662208,"#2B9289"],[0.49498327759197319,"#2B9189"],[0.49832775919732442,"#2B9089"],[0.50167224080267558,"#2B8F8A"],[0.50501672240802675,"#2B8F8A"],[0.50836120401337792,"#2B8E8A"],[0.51170568561872909,"#2B8D8A"],[0.51505016722408026,"#2B8C8A"],[0.51839464882943143,"#2B8B8A"],[0.52173913043478259,"#2C8B8B"],[0.52508361204013376,"#2C8A8B"],[0.52842809364548493,"#2C898B"],[0.5317725752508361,"#2C888B"],[0.53511705685618727,"#2C878B"],[0.53846153846153844,"#2C878B"],[0.5418060200668896,"#2C868B"],[0.54515050167224077,"#2C858C"],[0.54849498327759194,"#2C848C"],[0.55183946488294311,"#2C838C"],[0.55518394648829428,"#2B838C"],[0.55852842809364545,"#2B828C"],[0.56187290969899661,"#2B818C"],[0.56521739130434778,"#2B808D"],[0.56856187290969895,"#2B7F8D"],[0.57190635451505023,"#2B7F8D"],[0.57525083612040129,"#2B7E8D"],[0.57859531772575257,"#2B7D8D"],[0.58193979933110362,"#2B7C8D"],[0.5852842809364549,"#2B7B8D"],[0.58862876254180596,"#2B7B8E"],[0.59197324414715724,"#2A7A8E"],[0.5953177257525083,"#2A798E"],[0.59866220735785958,"#2A788E"],[0.60200668896321063,"#2B778E"],[0.60535117056856191,"#2B778E"],[0.60869565217391297,"#2C768E"],[0.61204013377926425,"#2D758E"],[0.61538461538461531,"#2E748E"],[0.61872909698996659,"#2F738D"],[0.62207357859531764,"#2F728D"],[0.62541806020066892,"#30718D"],[0.62876254180601998,"#31718D"],[0.63210702341137126,"#31708D"],[0.63545150501672232,"#326F8D"],[0.6387959866220736,"#326E8D"],[0.64214046822742465,"#336D8D"],[0.64548494983277593,"#346C8D"],[0.6488294314381271,"#346B8C"],[0.65217391304347827,"#356B8C"],[0.65551839464882944,"#356A8C"],[0.65886287625418061,"#36698C"],[0.66220735785953178,"#36688C"],[0.66555183946488294,"#37678C"],[0.66889632107023411,"#37668C"],[0.67224080267558528,"#38658C"],[0.67558528428093645,"#38658C"],[0.67892976588628762,"#38648B"],[0.68227424749163879,"#39638B"],[0.68561872909698995,"#39628B"],[0.68896321070234112,"#3A618B"],[0.69230769230769229,"#3A608B"],[0.69565217391304346,"#3A5F8B"],[0.69899665551839463,"#3B5F8B"],[0.7023411371237458,"#3B5E8B"],[0.70568561872909696,"#3B5D8A"],[0.70903010033444813,"#3C5C8A"],[0.7123745819397993,"#3C5B8A"],[0.71571906354515047,"#3C5A8A"],[0.71906354515050164,"#3D598A"],[0.72240802675585281,"#3D598A"],[0.72575250836120397,"#3D588A"],[0.72909698996655514,"#3D578A"],[0.73244147157190631,"#3E568A"],[0.73578595317725748,"#3E5589"],[0.73913043478260865,"#3E5489"],[0.74247491638795982,"#3E5389"],[0.74581939799331098,"#3F5289"],[0.74916387959866215,"#3F5289"],[0.75250836120401332,"#3F5189"],[0.75585284280936449,"#3F5089"],[0.75919732441471566,"#3F4F89"],[0.76254180602006683,"#404E88"],[0.76588628762541799,"#404D88"],[0.76923076923076916,"#404C88"],[0.77257525083612033,"#404B88"],[0.7759197324414715,"#404A88"],[0.77926421404682267,"#404A88"],[0.78260869565217384,"#404988"],[0.785953177257525,"#414888"],[0.78929765886287628,"#414787"],[0.79264214046822734,"#414687"],[0.79598662207357862,"#414587"],[0.79933110367892968,"#414487"],[0.80267558528428096,"#414386"],[0.80602006688963213,"#424285"],[0.80936454849498318,"#424185"],[0.81270903010033435,"#424184"],[0.81605351170568563,"#424083"],[0.8193979933110368,"#433F82"],[0.82274247491638786,"#433E81"],[0.82608695652173902,"#433D80"],[0.8294314381270903,"#433C7F"],[0.83277591973244147,"#433B7E"],[0.83612040133779253,"#443A7D"],[0.8394648829431437,"#44397D"],[0.84280936454849498,"#44387C"],[0.84615384615384615,"#44377B"],[0.8494983277591972,"#44367A"],[0.85284280936454837,"#443679"],[0.85618729096989965,"#443578"],[0.85953177257525082,"#453477"],[0.8628762541806021,"#453377"],[0.86622073578595304,"#453276"],[0.86956521739130432,"#453175"],[0.87290969899665549,"#453074"],[0.87625418060200677,"#452F73"],[0.87959866220735772,"#452E72"],[0.882943143812709,"#452D71"],[0.88628762541806017,"#452C70"],[0.88963210702341144,"#452B70"],[0.89297658862876239,"#462A6F"],[0.89632107023411367,"#46296E"],[0.89966555183946484,"#46286D"],[0.90301003344481612,"#46276C"],[0.90635451505016706,"#46266B"],[0.90969899665551834,"#46256B"],[0.91304347826086951,"#46246A"],[0.91638795986622079,"#462369"],[0.91973244147157174,"#462268"],[0.92307692307692302,"#462167"],[0.92642140468227419,"#462066"],[0.92976588628762546,"#461F65"],[0.93311036789297663,"#461E65"],[0.93645484949832769,"#461D64"],[0.93979933110367886,"#461B63"],[0.94314381270903014,"#461A62"],[0.94648829431438131,"#451961"],[0.94983277591973236,"#451860"],[0.95317725752508353,"#451760"],[0.95652173913043481,"#45155F"],[0.95986622073578598,"#45145E"],[0.96321070234113704,"#45135D"],[0.96655518394648821,"#45115C"],[0.96989966555183948,"#45105B"],[0.97324414715719065,"#450E5B"],[0.97658862876254171,"#450D5A"],[0.97993311036789288,"#450B59"],[0.98327759197324416,"#450958"],[0.98662207357859533,"#450857"],[0.98996655518394638,"#440656"],[0.99331103678929755,"#440456"],[0.99665551839464883,"#440355"],[1,"#440154"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"thickness":23.040000000000003,"title":"count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.0","2.5","5.0","7.5","10.0"],"tickvals":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":40.840182648401829,"r":7.3059360730593621,"b":37.260273972602747,"l":57.716894977168977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Chromatographic peak counts","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2401.0500000000002,4599.9499999999998],"tickmode":"array","ticktext":["2500","3000","3500","4000","4500"],"tickvals":[2500,3000,3500,4000,4500],"categoryorder":"array","categoryarray":["2500","3000","3500","4000","4500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"retention time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["ko18.CDF","ko16.CDF","ko15.CDF"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["ko18.CDF","ko16.CDF","ko15.CDF"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1d4d265e8c98":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"1d4d265e8c98","visdat":{"1d4d265e8c98":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section></section><section class="section level2"><h2 id="part-2-chromatogram-visualization">Part 2: Chromatogram Visualization<a class="anchor" aria-label="anchor" href="#part-2-chromatogram-visualization"></a>
</h2>
<section class="level2"><h3 id="gplotxchromatogram-automatic-peak-plotting">gplot(XChromatogram): Automatic Peak Plotting<a class="anchor" aria-label="anchor" href="#gplotxchromatogram-automatic-peak-plotting"></a>
</h3>
<p>First, let’s extract a chromatogram for a specific m/z range:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract chromatogram for m/z 200-210</span></span>
<span><span class="va">mz_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">343</span><span class="op">-</span><span class="fl">0.2</span>,<span class="fl">343</span><span class="op">+</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">rt_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2600</span>, <span class="fl">2750</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get chromatogram data</span></span>
<span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">chromatogram</a></span><span class="op">(</span><span class="va">xdata</span>, mz <span class="op">=</span> <span class="va">mz_range</span>, rt <span class="op">=</span> <span class="va">rt_range</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Chromatogram with Detected Peaks"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/gplot_chromatogram-1.png" alt="ggplot2 version of chromatogram plot with detected peaks automatically marked." width="480"></p>
</figure>
</div>
</div>
</div>
<section class="level3"><h4 id="multiple-peak-types">Multiple Peak Types<a class="anchor" aria-label="anchor" href="#multiple-peak-types"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"polygon"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Polygon"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Point"</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"rectangle"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Rectangle"</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"None"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/peak_types-1.png" alt="Four panel plot showing different peak annotation styles." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="interactive-chromatogram">Interactive Chromatogram<a class="anchor" aria-label="anchor" href="#interactive-chromatogram"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f4a950631ada015db5fb" style="width:768px;height:384px;"></div>
<script type="application/json" data-for="htmlwidget-f4a950631ada015db5fb">{"x":{"data":[{"x":[2601.5349999999999,2603.0999999999999,2604.665,2606.23,2607.7950000000001,2609.3600000000001,2610.9250000000002,2612.4899999999998,2614.0549999999998,2615.6199999999999,2617.1849999999999,2618.75,2620.3150000000001,2621.8789999999999,2623.444,2625.009,2626.5740000000001,2628.1390000000001,2629.7040000000002,2631.2689999999998,2632.8339999999998,2634.3989999999999,2635.9639999999999,2637.529,2639.0940000000001,2640.6590000000001,2642.2240000000002,2643.7890000000002,2645.3539999999998,2646.9189999999999,2648.4839999999999,2650.049,2651.614,2653.1790000000001,2654.7440000000001,2656.308,2657.873,2659.4380000000001,2661.0030000000002,2662.5680000000002,2664.1329999999998,2665.6979999999999,2667.2629999999999,2668.828,2670.393,2671.9580000000001,2673.5230000000001,2675.0880000000002,2676.6529999999998,2678.2179999999998,2679.7829999999999,2681.348,2682.913,2684.4780000000001,2686.0430000000001,2687.6080000000002,2689.172,2690.7370000000001,2692.3020000000001,2693.8670000000002,2695.4319999999998,2696.9969999999998,2698.5619999999999,2700.127,2701.692,2703.2570000000001,2704.8220000000001,2706.3870000000002,2707.9520000000002,2709.5169999999998,2711.0819999999999,2712.6469999999999,2714.212,2715.777,2717.3420000000001,2718.9070000000002,2720.4720000000002,2722.0369999999998,2723.6010000000001,2725.1660000000002,2726.7310000000002,2728.2959999999998,2729.8609999999999,2731.4259999999999,2732.991,2734.556,2736.1210000000001,2737.6860000000001,2739.2510000000002,2740.8159999999998,2742.3809999999999,2743.9459999999999,2745.511,2747.076,2748.6410000000001],"y":[67952,59464,50624,42352,35392,29528,24400,19904,15778,12153,9258,7336,6076,5382,4953,4590,4143,3820,3652,3611,3642,3724,3785,3866,4761,7720,14550,27448,49200,82296,127032,178368,231808,285120,334464,369856,387136,393344,395904,395456,391936,396608,419008,465280,526336,586624,625472,642304,651392,664256,672064,664448,642048,611776,577216,537408,489984,437248,385536,336256,287104,240512,201024,166656,134976,107664,86384,68824,53984,41960,33336,27224,23184,19688,16888,14686,12799,11220,10104,9472,9260,8895,8343,7897,7681,7657,7970,8183,8284,8433,8819,9303,10262,11667,13436],"text":["rt: 2601.535<br />intensity:  67952","rt: 2603.100<br />intensity:  59464","rt: 2604.665<br />intensity:  50624","rt: 2606.230<br />intensity:  42352","rt: 2607.795<br />intensity:  35392","rt: 2609.360<br />intensity:  29528","rt: 2610.925<br />intensity:  24400","rt: 2612.490<br />intensity:  19904","rt: 2614.055<br />intensity:  15778","rt: 2615.620<br />intensity:  12153","rt: 2617.185<br />intensity:   9258","rt: 2618.750<br />intensity:   7336","rt: 2620.315<br />intensity:   6076","rt: 2621.879<br />intensity:   5382","rt: 2623.444<br />intensity:   4953","rt: 2625.009<br />intensity:   4590","rt: 2626.574<br />intensity:   4143","rt: 2628.139<br />intensity:   3820","rt: 2629.704<br />intensity:   3652","rt: 2631.269<br />intensity:   3611","rt: 2632.834<br />intensity:   3642","rt: 2634.399<br />intensity:   3724","rt: 2635.964<br />intensity:   3785","rt: 2637.529<br />intensity:   3866","rt: 2639.094<br />intensity:   4761","rt: 2640.659<br />intensity:   7720","rt: 2642.224<br />intensity:  14550","rt: 2643.789<br />intensity:  27448","rt: 2645.354<br />intensity:  49200","rt: 2646.919<br />intensity:  82296","rt: 2648.484<br />intensity: 127032","rt: 2650.049<br />intensity: 178368","rt: 2651.614<br />intensity: 231808","rt: 2653.179<br />intensity: 285120","rt: 2654.744<br />intensity: 334464","rt: 2656.308<br />intensity: 369856","rt: 2657.873<br />intensity: 387136","rt: 2659.438<br />intensity: 393344","rt: 2661.003<br />intensity: 395904","rt: 2662.568<br />intensity: 395456","rt: 2664.133<br />intensity: 391936","rt: 2665.698<br />intensity: 396608","rt: 2667.263<br />intensity: 419008","rt: 2668.828<br />intensity: 465280","rt: 2670.393<br />intensity: 526336","rt: 2671.958<br />intensity: 586624","rt: 2673.523<br />intensity: 625472","rt: 2675.088<br />intensity: 642304","rt: 2676.653<br />intensity: 651392","rt: 2678.218<br />intensity: 664256","rt: 2679.783<br />intensity: 672064","rt: 2681.348<br />intensity: 664448","rt: 2682.913<br />intensity: 642048","rt: 2684.478<br />intensity: 611776","rt: 2686.043<br />intensity: 577216","rt: 2687.608<br />intensity: 537408","rt: 2689.172<br />intensity: 489984","rt: 2690.737<br />intensity: 437248","rt: 2692.302<br />intensity: 385536","rt: 2693.867<br />intensity: 336256","rt: 2695.432<br />intensity: 287104","rt: 2696.997<br />intensity: 240512","rt: 2698.562<br />intensity: 201024","rt: 2700.127<br />intensity: 166656","rt: 2701.692<br />intensity: 134976","rt: 2703.257<br />intensity: 107664","rt: 2704.822<br />intensity:  86384","rt: 2706.387<br />intensity:  68824","rt: 2707.952<br />intensity:  53984","rt: 2709.517<br />intensity:  41960","rt: 2711.082<br />intensity:  33336","rt: 2712.647<br />intensity:  27224","rt: 2714.212<br />intensity:  23184","rt: 2715.777<br />intensity:  19688","rt: 2717.342<br />intensity:  16888","rt: 2718.907<br />intensity:  14686","rt: 2720.472<br />intensity:  12799","rt: 2722.037<br />intensity:  11220","rt: 2723.601<br />intensity:  10104","rt: 2725.166<br />intensity:   9472","rt: 2726.731<br />intensity:   9260","rt: 2728.296<br />intensity:   8895","rt: 2729.861<br />intensity:   8343","rt: 2731.426<br />intensity:   7897","rt: 2732.991<br />intensity:   7681","rt: 2734.556<br />intensity:   7657","rt: 2736.121<br />intensity:   7970","rt: 2737.686<br />intensity:   8183","rt: 2739.251<br />intensity:   8284","rt: 2740.816<br />intensity:   8433","rt: 2742.381<br />intensity:   8819","rt: 2743.946<br />intensity:   9303","rt: 2745.511<br />intensity:  10262","rt: 2747.076<br />intensity:  11667","rt: 2748.641<br />intensity:  13436"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2637.529,2637.529,2639.0940000000001,2640.6590000000001,2642.2240000000002,2643.7890000000002,2645.3539999999998,2646.9189999999999,2648.4839999999999,2650.049,2651.614,2653.1790000000001,2654.7440000000001,2656.308,2657.873,2659.4380000000001,2661.0030000000002,2662.5680000000002,2664.1329999999998,2665.6979999999999,2667.2629999999999,2668.828,2670.393,2671.9580000000001,2673.5230000000001,2675.0880000000002,2676.6529999999998,2678.2179999999998,2679.7829999999999,2681.348,2682.913,2684.4780000000001,2686.0430000000001,2687.6080000000002,2689.172,2690.7370000000001,2692.3020000000001,2693.8670000000002,2695.4319999999998,2696.9969999999998,2698.5619999999999,2700.127,2701.692,2703.2570000000001,2704.8220000000001,2706.3870000000002,2707.9520000000002,2709.5169999999998,2711.0819999999999,2712.6469999999999,2712.6469999999999,2637.529],"y":[0,3866,4761,7720,14550,27448,49200,82296,127032,178368,231808,285120,334464,369856,387136,393344,395904,395456,391936,396608,419008,465280,526336,586624,625472,642304,651392,664256,672064,664448,642048,611776,577216,537408,489984,437248,385536,336256,287104,240512,201024,166656,134976,107664,86384,68824,53984,41960,33336,27224,0,0],"text":"CP006","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,0.3765)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,0,0,0.1255)","hoveron":"fills","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":54.794520547945226},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2594.1796999999997,2755.9963000000002],"tickmode":"array","ticktext":["2600","2650","2700","2750"],"tickvals":[2600,2650,2700,2750],"categoryorder":"array","categoryarray":["2600","2650","2700","2750"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"retention time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-33603.200000000004,705667.19999999995],"tickmode":"array","ticktext":["0e+00","2e+05","4e+05","6e+05"],"tickvals":[0,200000,400000,600000],"categoryorder":"array","categoryarray":["0e+00","2e+05","4e+05","6e+05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716894984},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"intensity","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(51,51,51,1)","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716894984}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"1d4d78cc2848":{"x":{},"y":{},"type":"scatter"},"1d4d7e2586a7":{"x":{},"y":{},"text":{}}},"cur_data":"1d4d78cc2848","visdat":{"1d4d78cc2848":["function (y) ","x"],"1d4d7e2586a7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section></section><section class="section level2"><h2 id="part-3-composable-peak-highlighting">Part 3: Composable Peak Highlighting<a class="anchor" aria-label="anchor" href="#part-3-composable-peak-highlighting"></a>
</h2>
<section class="level2"><h3 id="ghighlightchrompeaks-adding-peak-layers">ghighlightChromPeaks(): Adding Peak Layers<a class="anchor" aria-label="anchor" href="#ghighlightchrompeaks-adding-peak-layers"></a>
</h3>
<p>For more control, <code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code> returns ggplot2 layers that can be added to any chromatogram plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start with gplot() which creates the chromatogram</span></span>
<span><span class="va">p_chrom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Chromatogram with Highlighted Peaks (Rectangle)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Retention Time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Intensity"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Add peak highlights as rectangles</span></span>
<span><span class="va">peak_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine base plot with peak annotations</span></span>
<span><span class="va">p_chrom</span> <span class="op">+</span> <span class="va">peak_layers</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_rect-1.png" alt="Chromatogram with detected peaks highlighted as semi-transparent rectangles." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="understanding-peak-highlighting-behavior">Understanding Peak Highlighting Behavior<a class="anchor" aria-label="anchor" href="#understanding-peak-highlighting-behavior"></a>
</h3>
<p>The <code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code> function searches <strong>all peaks across all samples</strong>. For cleaner visualization, filter to a single sample:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Without filtering: shows peaks from ALL samples</span></span>
<span><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>,</span>
<span>                       rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>                       mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>                       border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                       fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"All Samples (may show extra peaks)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With filtering: shows only peaks from sample 1</span></span>
<span><span class="va">xdata_filtered</span> <span class="op">&lt;-</span> <span class="fu">filterFile</span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata_filtered</span>,</span>
<span>                       rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>                       mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>                       border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                       fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Single Sample (sample 1 only)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_all</span> <span class="op">+</span> <span class="va">p_filtered</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_filtered-1.png" alt="Comparison showing peak highlighting with and without sample filtering." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="different-visualization-types">Different Visualization Types<a class="anchor" aria-label="anchor" href="#different-visualization-types"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xdata_filtered</span> <span class="op">&lt;-</span> <span class="fu">filterFile</span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Rectangle</span></span>
<span><span class="va">p_rect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Rectangles"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_rects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Point</span></span>
<span><span class="va">p_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Points"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"red"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Type: Polygon</span></span>
<span><span class="va">p_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Annotations: Polygons"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span><span class="va">peak_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_range</span>,</span>
<span>  mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"polygon"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display all three types</span></span>
<span><span class="op">(</span><span class="va">p_rect</span> <span class="op">+</span> <span class="va">peak_rects</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_point</span> <span class="op">+</span> <span class="va">peak_points</span><span class="op">)</span> <span class="op">/</span></span>
<span><span class="op">(</span><span class="va">p_poly</span> <span class="op">+</span> <span class="va">peak_polygons</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/highlight_types-1.png" alt="Three-panel comparison showing different peak annotation styles." width="768"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="peak-selection-criteria">Peak Selection Criteria<a class="anchor" aria-label="anchor" href="#peak-selection-criteria"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># whichPeaks: "any" - peaks that overlap the range</span></span>
<span><span class="va">p_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'any'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_any</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"any"</span>, border <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "within" - peaks fully within the range</span></span>
<span><span class="va">p_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_within</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"within"</span>, border <span class="op">=</span> <span class="st">"blue"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># whichPeaks: "apex_within" - peaks with apex in range</span></span>
<span><span class="va">p_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, peakType <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"whichPeaks = 'apex_within'"</span>, x <span class="op">=</span> <span class="st">"RT (s)"</span>, y <span class="op">=</span> <span class="st">"Intensity"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peaks_apex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span></span>
<span>  <span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>  whichPeaks <span class="op">=</span> <span class="st">"apex_within"</span>, border <span class="op">=</span> <span class="st">"green"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display comparison</span></span>
<span><span class="op">(</span><span class="va">p_any</span> <span class="op">+</span> <span class="va">peaks_any</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_within</span> <span class="op">+</span> <span class="va">peaks_within</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p_apex</span> <span class="op">+</span> <span class="va">peaks_apex</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/peak_selection-1.png" alt="Comparison of three peak selection methods." width="768"></p>
</figure>
</div>
</div>
</div>
</section></section><section class="section level2"><h2 id="combining-visualizations">Combining Visualizations<a class="anchor" aria-label="anchor" href="#combining-visualizations"></a>
</h2>
<p>Create comprehensive peak detection summaries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Peak distribution for one sample</span></span>
<span><span class="va">p_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Distribution - Sample 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Peak density across all samples</span></span>
<span><span class="va">p_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Peak Density Across Samples"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="va">p_dist</span> <span class="op">/</span> <span class="va">p_density</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/combined_view-1.png" alt="Combined peak detection summary." width="960"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<section class="level2"><h3 id="functions-covered-1">Functions Covered<a class="anchor" aria-label="anchor" href="#functions-covered-1"></a>
</h3>
<table class="table caption-top">
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
<th>Input</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/gplotChromPeaks.html">gplotChromPeaks()</a></code></td>
<td>Show peaks in RT/m/z space</td>
<td>XcmsExperiment</td>
</tr>
<tr class="even">
<td><code><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage()</a></code></td>
<td>Peak density heatmap</td>
<td>XcmsExperiment</td>
</tr>
<tr class="odd">
<td><code>gplot(XChromatogram)</code></td>
<td>Chromatogram with peaks</td>
<td>XChromatogram</td>
</tr>
<tr class="even">
<td><code><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks()</a></code></td>
<td>Add peak annotations</td>
<td>Layer for ggplot</td>
</tr>
</tbody>
</table></section><section class="level2"><h3 id="use-cases">Use Cases<a class="anchor" aria-label="anchor" href="#use-cases"></a>
</h3>
<ul>
<li>
<strong>Quality control</strong>: Verify peak detection quality</li>
<li>
<strong>Method development</strong>: Optimize CentWave parameters</li>
<li>
<strong>Sample comparison</strong>: Compare peak detection across samples</li>
<li>
<strong>Peak inspection</strong>: Examine individual peak shapes</li>
</ul></section><section class="level2"><h3 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<p>After visualizing detected peaks, proceed to:</p>
<p>→ <strong><a href="03-peak-correspondence.html">Step 3: Peak Correspondence</a></strong> - Group peaks across samples</p>
</section></section><section class="section level2"><h2 id="comparison-with-original-xcms">Comparison with Original XCMS<a class="anchor" aria-label="anchor" href="#comparison-with-original-xcms"></a>
</h2>
<div class="row">
<section class="level2 col-md-6"><h3 id="original-xcms">Original XCMS<a class="anchor" aria-label="anchor" href="#original-xcms"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/plotChromPeaks.html" class="external-link">plotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2600</span>, <span class="fl">2750</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">325</span>,<span class="fl">460</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/original_chrompeaks-1.png" alt="XCMS plotChromPeaks using base R graphics." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2 col-md-6"><h3 id="xcmsvis-ggplot2">xcmsVis ggplot2<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeaks.html">gplotChromPeaks</a></span><span class="op">(</span><span class="va">xdata</span>, file <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2600</span>, <span class="fl">2750</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">325</span>,<span class="fl">460</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/ggplot_chrompeaks_supp-1.png" alt="ggplot2 version with modern aesthetics." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<section class="level2"><h3 id="gplotchrompeakimage-vs-plotchrompeakimage">gplotChromPeakImage() vs plotChromPeakImage()<a class="anchor" aria-label="anchor" href="#gplotchrompeakimage-vs-plotchrompeakimage"></a>
</h3>
<div class="row">
<section class="level3 col-md-6"><h4 id="original-xcms-1">Original XCMS<a class="anchor" aria-label="anchor" href="#original-xcms-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/plotChromPeaks.html" class="external-link">plotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/original_peakimage-1.png" alt="XCMS plotChromPeakImage using base R graphics." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3 col-md-6"><h4 id="xcmsvis-ggplot2-1">xcmsVis ggplot2<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2-1"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplotChromPeakImage.html">gplotChromPeakImage</a></span><span class="op">(</span><span class="va">xdata</span>, binSize <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/xcmsvis_peakimage-1.png" alt="ggplot2 version with viridis color scale." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section><section class="level2"><h3 id="gplotxchromatogram-vs-plotchromatogram">gplot(XChromatogram) vs plot(Chromatogram)<a class="anchor" aria-label="anchor" href="#gplotxchromatogram-vs-plotchromatogram"></a>
</h3>
<div class="row">
<section class="level3 col-md-6"><h4 id="original-xcms-2">Original XCMS<a class="anchor" aria-label="anchor" href="#original-xcms-2"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/original_chromatogram-1.png" alt="XCMS plot for Chromatogram using base R graphics." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3 col-md-6"><h4 id="xcmsvis-ggplot2-2">xcmsVis ggplot2<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2-2"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/xcmsvis_chromatogram-1.png" alt="ggplot2 version with detected peaks." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section><section class="level2"><h3 id="ghighlightchrompeaks-vs-highlightchrompeaks">ghighlightChromPeaks() vs highlightChromPeaks()<a class="anchor" aria-label="anchor" href="#ghighlightchrompeaks-vs-highlightchrompeaks"></a>
</h3>
<div class="row">
<section class="level3 col-md-6"><h4 id="original-xcms-3">Original XCMS<a class="anchor" aria-label="anchor" href="#original-xcms-3"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xdata_filtered</span> <span class="op">&lt;-</span> <span class="fu">filterFile</span><span class="op">(</span><span class="va">xdata</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Convert to XCMSnExp for original XCMS function</span></span>
<span><span class="va">xdata_xcmsnexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">xdata_filtered</span>, <span class="st">"XCMSnExp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/highlightChromPeaks.html" class="external-link">highlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata_xcmsnexp</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                    type <span class="op">=</span> <span class="st">"rect"</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/original_highlight-1.png" alt="XCMS highlightChromPeaks using base R graphics." width="480"></p>
</figure>
</div>
</div>
</div>
</section><section class="level3 col-md-6"><h4 id="xcmsvis-ggplot2-3">xcmsVis ggplot2<a class="anchor" aria-label="anchor" href="#xcmsvis-ggplot2-3"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gplot.html">gplot</a></span><span class="op">(</span><span class="va">chr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/ghighlightChromPeaks.html">ghighlightChromPeaks</a></span><span class="op">(</span><span class="va">xdata_filtered</span>, rt <span class="op">=</span> <span class="va">rt_range</span>, mz <span class="op">=</span> <span class="va">mz_range</span>,</span>
<span>                       type <span class="op">=</span> <span class="st">"rect"</span>, border <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="02-peak-detection_files/figure-html/xcmsvis_highlight-1.png" alt="ggplot2 version as composable layers." width="480"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section></section><section class="section level2"><h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] xcmsVis_0.99.2      patchwork_1.3.2     MsExperiment_1.12.0</span></span>
<span><span class="co">#&gt; [4] ProtGenerics_1.42.0 faahKO_1.50.0       plotly_4.11.0      </span></span>
<span><span class="co">#&gt; [7] ggplot2_4.0.0       xcms_4.8.0          BiocParallel_1.44.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] DBI_1.2.3                   rlang_1.1.6                </span></span>
<span><span class="co">#&gt;   [3] magrittr_2.0.4              clue_0.3-66                </span></span>
<span><span class="co">#&gt;   [5] MassSpecWavelet_1.76.0      matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt;   [7] compiler_4.5.2              vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;   [9] reshape2_1.4.5              stringr_1.6.0              </span></span>
<span><span class="co">#&gt;  [11] pkgconfig_2.0.3             MetaboCoreUtils_1.18.0     </span></span>
<span><span class="co">#&gt;  [13] crayon_1.5.3                fastmap_1.2.0              </span></span>
<span><span class="co">#&gt;  [15] XVector_0.50.0              labeling_0.4.3             </span></span>
<span><span class="co">#&gt;  [17] rmarkdown_2.30              preprocessCore_1.72.0      </span></span>
<span><span class="co">#&gt;  [19] purrr_1.2.0                 xfun_0.54                  </span></span>
<span><span class="co">#&gt;  [21] MultiAssayExperiment_1.36.0 jsonlite_2.0.0             </span></span>
<span><span class="co">#&gt;  [23] progress_1.2.3              DelayedArray_0.36.0        </span></span>
<span><span class="co">#&gt;  [25] parallel_4.5.2              prettyunits_1.2.0          </span></span>
<span><span class="co">#&gt;  [27] cluster_2.1.8.1             R6_2.6.1                   </span></span>
<span><span class="co">#&gt;  [29] stringi_1.8.7               RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;  [31] limma_3.66.0                GenomicRanges_1.62.0       </span></span>
<span><span class="co">#&gt;  [33] Rcpp_1.1.0                  Seqinfo_1.0.0              </span></span>
<span><span class="co">#&gt;  [35] SummarizedExperiment_1.40.0 iterators_1.0.14           </span></span>
<span><span class="co">#&gt;  [37] knitr_1.50                  IRanges_2.44.0             </span></span>
<span><span class="co">#&gt;  [39] BiocBaseUtils_1.12.0        Matrix_1.7-4               </span></span>
<span><span class="co">#&gt;  [41] igraph_2.2.1                tidyselect_1.2.1           </span></span>
<span><span class="co">#&gt;  [43] abind_1.4-8                 yaml_2.3.10                </span></span>
<span><span class="co">#&gt;  [45] doParallel_1.0.17           codetools_0.2-20           </span></span>
<span><span class="co">#&gt;  [47] affy_1.88.0                 lattice_0.22-7             </span></span>
<span><span class="co">#&gt;  [49] tibble_3.3.0                plyr_1.8.9                 </span></span>
<span><span class="co">#&gt;  [51] Biobase_2.70.0              withr_3.0.2                </span></span>
<span><span class="co">#&gt;  [53] S7_0.2.0                    evaluate_1.0.5             </span></span>
<span><span class="co">#&gt;  [55] Spectra_1.20.0              pillar_1.11.1              </span></span>
<span><span class="co">#&gt;  [57] affyio_1.80.0               BiocManager_1.30.26        </span></span>
<span><span class="co">#&gt;  [59] MatrixGenerics_1.22.0       foreach_1.5.2              </span></span>
<span><span class="co">#&gt;  [61] stats4_4.5.2                MSnbase_2.36.0             </span></span>
<span><span class="co">#&gt;  [63] MALDIquant_1.22.3           ncdf4_1.24                 </span></span>
<span><span class="co">#&gt;  [65] generics_0.1.4              S4Vectors_0.48.0           </span></span>
<span><span class="co">#&gt;  [67] hms_1.1.4                   scales_1.4.0               </span></span>
<span><span class="co">#&gt;  [69] glue_1.8.0                  MsFeatures_1.18.0          </span></span>
<span><span class="co">#&gt;  [71] lazyeval_0.2.2              tools_4.5.2                </span></span>
<span><span class="co">#&gt;  [73] mzID_1.48.0                 data.table_1.17.8          </span></span>
<span><span class="co">#&gt;  [75] QFeatures_1.20.0            vsn_3.78.0                 </span></span>
<span><span class="co">#&gt;  [77] mzR_2.44.0                  fs_1.6.6                   </span></span>
<span><span class="co">#&gt;  [79] XML_3.99-0.20               grid_4.5.2                 </span></span>
<span><span class="co">#&gt;  [81] impute_1.84.0               tidyr_1.3.1                </span></span>
<span><span class="co">#&gt;  [83] crosstalk_1.2.2             MsCoreUtils_1.21.0         </span></span>
<span><span class="co">#&gt;  [85] PSMatch_1.14.0              cli_3.6.5                  </span></span>
<span><span class="co">#&gt;  [87] viridisLite_0.4.2           S4Arrays_1.10.0            </span></span>
<span><span class="co">#&gt;  [89] dplyr_1.1.4                 AnnotationFilter_1.34.0    </span></span>
<span><span class="co">#&gt;  [91] pcaMethods_2.2.0            gtable_0.3.6               </span></span>
<span><span class="co">#&gt;  [93] digest_0.6.38               BiocGenerics_0.56.0        </span></span>
<span><span class="co">#&gt;  [95] SparseArray_1.10.1          htmlwidgets_1.6.4          </span></span>
<span><span class="co">#&gt;  [97] farver_2.1.2                htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [99] lifecycle_1.0.4             httr_1.4.7                 </span></span>
<span><span class="co">#&gt; [101] statmod_1.5.1               MASS_7.3-65</span></span></code></pre></div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stanstrup Jan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
